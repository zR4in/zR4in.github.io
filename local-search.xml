<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>pveå®‰è£…åŠé…ç½®</title>
    <link href="/2025/01/05/pve%E5%AE%89%E8%A3%85%E5%8F%8A%E9%85%8D%E7%BD%AE/"/>
    <url>/2025/01/05/pve%E5%AE%89%E8%A3%85%E5%8F%8A%E9%85%8D%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<p>å’¸é±¼æ¡åƒåœ¾ç¢°å·§æ¡äº†ä¸ªåç¡•B250Mä¸»æ¿+Intel i5 7500ï¼Œç¢°å·§æ¡äº†ä¸ªæ‹“æ‰‘é¾™çš„8ç›˜ä½æœºç®±ï¼Œç¢°å·§æ¡äº†ä¸ªpcieè½¬sataå¡ï¼Œç¢°å·§æ¡äº†ä¸ªç›Šæ’250W flexç”µæºï¼Œç¢°å·§æ¡äº†å¥½å‡ å—æœºæ¢°ç¡¬ç›˜ã€‚æŠ˜è…¾ä¸€ä¸‹pveã€‚</p><blockquote><p>ä¸»æ¿+CPU+å†…å­˜æ¡ï¼šï¿¥350</p><p>æœºç®±ï¼š280+54-20-90+118&#x3D;ï¿¥342</p><p>PCIEæ‰©å±•å¡ï¼šï¿¥35</p><p>ç”µæºï¼šï¿¥283</p><p>Totalï¼šï¿¥1010</p></blockquote><p>è¿˜æ²¡ç®—ç¡¬ç›˜ï¼Œå¤šå°‘æœ‰ç‚¹è´µäº†ã€‚ä¸è¿‡ç›¸æ¯”æœ€æ–°çš„ç¡¬ä»¶æ¯”å¦‚N100ä»€ä¹ˆçš„ï¼Œè¿˜æ˜¯ä¾¿å®œä¸å°‘ï¼ŒN100ä¸»æ¿+CPUå¥—è£…ä¸€èˆ¬å°±600å·¦å³äº†ã€‚</p><h2 id="PVE"><a href="#PVE" class="headerlink" title="PVE"></a>PVE</h2><p>Proxmox VE<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Proxmox Virtual Environment - Open-Source Server Virtualization Platform](https://www.proxmox.com/en/proxmox-virtual-environment/overview)">[1]</span></a></sup>æ˜¯ä¸€ä¸ªåŸºäºdebiançš„linuxå‘è¡Œç‰ˆï¼Œå¼€æºçš„æœåŠ¡å™¨è™šæ‹ŸåŒ–å¹³å°ã€‚</p><h2 id="å®‰è£…PVE"><a href="#å®‰è£…PVE" class="headerlink" title="å®‰è£…PVE"></a>å®‰è£…PVE</h2><p>ä½¿ç”¨ventoy<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Ventoy](https://www.ventoy.net/cn/index.html)">[2]</span></a></sup>å®‰è£…ï¼Œå¦‚æœventoyç‰ˆæœ¬æ˜¯æœ‰bugçš„ç‰ˆæœ¬çš„è¯ï¼Œåœ¨å®‰è£…pveçš„æ—¶å€™æœ‰å¯èƒ½ä¼šé‡åˆ°No Device with Valid ISO Foundçš„é—®é¢˜ï¼Œä¼¼ä¹æ˜¯ventoyçš„bug<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="[\[SOLVED\] - \[ERROR\] No Device with Valid ISO Found | Proxmox Support Forum](https://forum.proxmox.com/threads/error-no-device-with-valid-iso-found.134510/)">[3]</span></a></sup>ï¼Œæ›´æ–°åˆ°1.0.99ç‰ˆæœ¬å°±è¡Œäº†ï¼Œä½†æ˜¯åé¢å®‰è£…å¥½ä¹‹åï¼Œè¿˜ä¼šæœ‰bugï¼Œæ— æ³•å¯åŠ¨ã€‚è¡¨ç°å°±æ˜¯å¯åŠ¨çš„æ—¶å€™ä¼šå¡åœ¨<code>Loading initial ramdisk...</code>ï¼Œç„¶ååˆæ˜¯googleä¸€ç•ªï¼Œå‘ç°æ˜¯pveå’Œventoyçš„bug<sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Ventoy install of Proxmox 8.1 halts at Loading initial ramdisk | Proxmox Support Forum](https://forum.proxmox.com/threads/ventoy-install-of-proxmox-8-1-halts-at-loading-initial-ramdisk.143196/)">[4]</span></a></sup>ã€‚æŒ‰ç…§å¸–å­ä¸Šçš„è¯´æ³•ï¼Œç¼–è¾‘<code>/etc/default/grub.d/installer.cfg</code>è¿™ä¸ªæ–‡ä»¶ï¼Œåˆ æ‰<code>voty</code>å‚æ•°çš„éƒ¨åˆ†ã€‚æˆ‘çš„æ”¹å®Œä¹‹åæ˜¯<code>GRUB_CMDLINE_LINUX=&quot;$GRUB_CMDLINE_LINUX&quot;</code>ï¼Œç„¶åè¿è¡Œ<code>update-grub</code>æ›´æ–°é…ç½®æ–‡ä»¶ï¼Œç„¶åå°±å¯ä»¥äº†ã€‚</p><p><del>ä¸–ç•Œå°±æ˜¯ä¸€ä¸ªå·¨å¤§çš„bugï¼Œä¸ºä»€ä¹ˆè¿™ä¹ˆå¤šbugã€‚</del></p><p>å¦‚æœæ˜¾ç¤ºå™¨æ˜¾ç¤ºç™»å½•çš„ç•Œé¢äº†ï¼ˆåªæœ‰å‘½ä»¤è¡Œï¼‰ï¼Œå°±æ˜¯å®‰è£…æˆåŠŸäº†ï¼Œç„¶åæŒ‰ç…§å‘½ä»¤è¡Œçš„æç¤ºï¼Œåœ¨å¦ä¸€å°ç”µè„‘ä¸Šè®¿é—®webç•Œé¢å°±å¯ä»¥äº†ã€‚noteï¼šå¿…é¡»ç”¨httpsè®¿é—®ï¼Œå¯ä»¥ç›´æ¥å®‰è£…è¿™ä¸ªè¯ä¹¦æˆ–è€…åé¢è‡ªå·±é…ç½®è¯ä¹¦ã€‚åˆšå¥½å¯ä»¥ç”¨ä¹‹å‰opensslè‡ªå·±åˆ›å»ºçš„è¯ä¹¦ã€‚</p><h2 id="é…ç½®è¯ä¹¦"><a href="#é…ç½®è¯ä¹¦" class="headerlink" title="é…ç½®è¯ä¹¦"></a>é…ç½®è¯ä¹¦</h2><p>å‚è€ƒ<sup id="fnref:5" class="footnote-ref"><a href="#fn:5" rel="footnote"><span class="hint--top hint--rounded" aria-label="[ä½›è¥¿åšå®¢ - Proxmox VEé…ç½®sslè¯ä¹¦](https://foxi.buduanwang.vip/virtualization/256.html/)">[5]</span></a></sup></p><p><img src="https://s2.loli.net/2025/01/07/vNc8PuMqoyEdGHZ.png" alt="image-20250107202845967"></p><h2 id="ä¸Šä¼ é•œåƒ"><a href="#ä¸Šä¼ é•œåƒ" class="headerlink" title="ä¸Šä¼ é•œåƒ"></a>ä¸Šä¼ é•œåƒ</h2><p><img src="https://s2.loli.net/2025/01/08/SvCL7mJg3dFsVwq.png" alt="image-20250108194753739"></p><p>ä¸Šä¼ çš„æ—¶å€™å¯ä»¥é€‰æ‹©ä¿å­˜çš„æ–‡ä»¶åï¼Œä»¥åŠå“ˆå¸Œç®—æ³•éªŒè¯é•œåƒçš„å®Œæ•´æ€§ã€‚</p><h2 id="è¿è¡Œè™šæ‹Ÿæœº-CT"><a href="#è¿è¡Œè™šæ‹Ÿæœº-CT" class="headerlink" title="è¿è¡Œè™šæ‹Ÿæœº&#x2F;CT"></a>è¿è¡Œè™šæ‹Ÿæœº&#x2F;CT</h2><p>å³ä¸Šè§’åˆ›å»ºè™šæ‹Ÿæœºï¼Œæ—è¾¹è¿˜æœ‰åˆ›å»ºCTçš„é€‰é¡¹ï¼Œæ ¹æ®æŸ¥åˆ°çš„èµ„æ–™çœ‹ï¼ŒCTæ˜¯è¿›ç¨‹éš”ç¦»çš„æŠ€æœ¯ï¼Œè™šæ‹Ÿæœºæ˜¯å®Œå…¨è™šæ‹Ÿå‡ºæ¥çš„æ“ä½œç³»ç»Ÿï¼Œè™šæ‹Ÿæœºéš”ç¦»æ›´å½»åº•ï¼Œä½†æ˜¯èµ„æºå ç”¨ä¹Ÿè¾ƒå¤§ï¼ŒCTè¿›ç¨‹éš”ç¦»èµ„æºåˆ©ç”¨æ•ˆç‡æ›´é«˜<sup id="fnref:6" class="footnote-ref"><a href="#fn:6" rel="footnote"><span class="hint--top hint--rounded" aria-label="[å®¹æ˜“è¢«å¿½ç•¥çš„PVEç»†èŠ‚â€”PVEçš„tips_NASå­˜å‚¨_ä»€ä¹ˆå€¼å¾—ä¹°](https://post.smzdm.com/p/a85g06k7/)">[6]</span></a></sup>ã€‚</p><p>å…ˆåˆ›å»ºä¸ªè™šæ‹Ÿæœºè¯•è¯•ï¼ˆåˆ›å»ºCTä¸çŸ¥é“æ€ä¹ˆæ“ä½œï¼‰</p><p>è¾“å…¥åç§°ï¼Œé€‰æ‹©ISOé•œåƒï¼Œæ˜¾å¡biosä»€ä¹ˆçš„ä¿æŒé»˜è®¤ï¼Œç£ç›˜é™¤äº†å¤§å°è°ƒæ•´ä¸€ä¸‹ï¼Œå…¶ä»–çš„ä¹Ÿå…¨éƒ¨ä¿æŒé»˜è®¤ï¼Œcpuæ ¸å¿ƒå¯ä»¥é€‰æ»¡ï¼Œå› ä¸ºæŒ‰ç…§èµ„æ–™<sup id="fnref:6" class="footnote-ref"><a href="#fn:6" rel="footnote"><span class="hint--top hint--rounded" aria-label="[å®¹æ˜“è¢«å¿½ç•¥çš„PVEç»†èŠ‚â€”PVEçš„tips_NASå­˜å‚¨_ä»€ä¹ˆå€¼å¾—ä¹°](https://post.smzdm.com/p/a85g06k7/)">[6]</span></a></sup>è¯´çš„ï¼Œæ ¸å¿ƒå¹¶ä¸æ˜¯è¿™ä¸ªè™šæ‹Ÿæœºç‹¬å çš„ï¼Œpveä¼šè‡ªåŠ¨æ ¹æ®æƒé‡æ¥åˆ†é…ï¼Œæ ¸å¿ƒæ•°åªæ˜¯ä¸€ä¸ªæ€§èƒ½ä¸Šé™ï¼Œå¹¶ä¸”è¿˜æåˆ°äº†cpuç±»å‹é€‰æ‹©hostä¼šæ‹¥æœ‰æ›´å¥½çš„æ€§èƒ½ï¼ˆä½†æ˜¯è¿ç§»æ€§ä¼šå˜å·®ï¼‰ï¼Œä¸è¿‡æˆ‘ä¹Ÿä¸è€ƒè™‘è¿ç§»ï¼Œå°±é€‰hostã€‚</p><p>åˆ›å»ºä¹‹åç›´æ¥å¯åŠ¨ï¼Œå°±ä¼šè¿›å…¥åˆ°å®‰è£…ISOçš„æ­¥éª¤ã€‚ï¼ˆå¦‚æœæƒ³å®‰è£…å…¶ä»–æ“ä½œç³»ç»Ÿï¼Œä¹Ÿå¯ä»¥å…³æœºç„¶åé€‰æ‹©å…¶ä»–ISOæ–‡ä»¶ï¼Œ<code>qm stop id</code>å¼ºåˆ¶å…³é—­å…·æœ‰ç‰¹å®šidçš„è™šæ‹Ÿæœºï¼‰</p><h2 id="PCIç›´é€š"><a href="#PCIç›´é€š" class="headerlink" title="PCIç›´é€š"></a>PCIç›´é€š</h2><p>PVEçš„ä¸€ä¸ªå¾ˆç«çš„åŠŸèƒ½ï¼Œå­—é¢æ„æ€ï¼ŒPCIè®¾å¤‡å¯ä»¥ç›´é€šåˆ°è™šæ‹Ÿæœºï¼Œæ¯”å¦‚æ˜¾å¡æˆ–è€…å…¶ä»–PCIEè½¬æ¥å¡ã€‚</p><p>è¿™ä¸ªåŠŸèƒ½éœ€è¦åœ¨ä¸»æ¿BIOSä¸­å¼€å¯VT-dé€‰é¡¹ï¼ˆå’ŒVT-xä¸æ˜¯ä¸€ä¸ªä¸œè¥¿ï¼‰ï¼ˆIntelï¼‰åç¡•çš„ä¸»æ¿ä¸­åœ¨é«˜çº§è®¾ç½®-&gt;åŒ—æ¡¥-&gt;VT-dï¼Œé€‰æ‹©enableå°±å¯ä»¥äº†ã€‚ç„¶åæŒ‰ç…§æ•™ç¨‹<sup id="fnref:7" class="footnote-ref"><a href="#fn:7" rel="footnote"><span class="hint--top hint--rounded" aria-label="[PVEå¼€å¯ç¡¬ä»¶ç›´é€šåŠŸèƒ½ â€“ æ‚ä¸ƒæ‚å…«](https://www.xh86.me/?p=724)">[7]</span></a></sup>æ“ä½œ</p><ol><li><p>é¦–å…ˆç¼–è¾‘grubé…ç½®æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs conf"># /etc/default/grub<br># intel cpuåŠ ä¸Šintel_iommu=on<br>GRUB_CMDLINE_LINUX_DEFAULT=&quot;quiet intel_iommu=on&quot;<br># amd cpuåŠ ä¸Šamd_iommu=on<br>GRUB_CMDLINE_LINUX_DEFAULT=&quot;quiet amd_iommu=on&quot;<br></code></pre></td></tr></table></figure><p>ç„¶åæ›´æ–°grub</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">update-grub<br><span class="hljs-comment"># ä½†æ˜¯å¿˜è®°åœ¨å“ªçœ‹åˆ°çš„æ•™ç¨‹è¯´pveå·²ç»ä¸ä½¿ç”¨update-grubå‘½ä»¤äº†ï¼Œéœ€è¦ç”¨ï¼š</span><br>pve-efiboot-tool refresh<br><span class="hljs-comment"># ä¿é™©èµ·è§ä¸¤ä¸ªéƒ½è¿è¡Œä¸€éå¾—äº†</span><br></code></pre></td></tr></table></figure></li><li><p>ç„¶ååŠ è½½ç›¸åº”çš„å†…æ ¸æ¨¡å—</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> vfio &gt;&gt; /etc/modules<br><span class="hljs-built_in">echo</span> vfio_iommu_type1 &gt;&gt; /etc/modules<br><span class="hljs-built_in">echo</span> vfio_pci &gt;&gt; /etc/modules<br><span class="hljs-built_in">echo</span> vfio_virqfd &gt;&gt; /etc/modules<br></code></pre></td></tr></table></figure><p>ç„¶åé‡å¯pveï¼Œç„¶ååº”è¯¥å°±å¯ä»¥ç”¨äº†ã€‚</p></li></ol><p>åœ¨è™šæ‹Ÿæœºå…³æœºçš„çŠ¶æ€ä¸‹ï¼Œé€‰æ‹©æ·»åŠ è®¾å¤‡ï¼Œç„¶åå°±å¯ä»¥PCIè®¾å¤‡ç›´é€šäº†ã€‚</p><p><img src="https://s2.loli.net/2025/01/08/jMY2hdxbuOKfeCZ.png" alt="image-20250108211143701"></p><h2 id="Linuxç£ç›˜åŠ å¯†"><a href="#Linuxç£ç›˜åŠ å¯†" class="headerlink" title="Linuxç£ç›˜åŠ å¯†"></a>Linuxç£ç›˜åŠ å¯†</h2><p>é¦–å…ˆä½¿ç”¨fdiskå¯¹ç¡¬ç›˜è¿›è¡Œåˆ†åŒº<sup id="fnref:10" class="footnote-ref"><a href="#fn:10" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Linuxç£ç›˜åˆ†åŒºã€æ ¼å¼åŒ–ã€æŒ‚è½½ - å¤§æ•°æ®è€å¸æœº - åšå®¢å›­](https://www.cnblogs.com/liugp/p/16417652.html)">[10]</span></a></sup></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo fdisk /dev/sdX<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs bash">Welcome to fdisk (util-linux 2.39.3).<br>Changes will remain <span class="hljs-keyword">in</span> memory only, <span class="hljs-keyword">until</span> you decide to write them.<br>Be careful before using the write <span class="hljs-built_in">command</span>.<br><br><br>Command (m <span class="hljs-keyword">for</span> <span class="hljs-built_in">help</span>): m<br><br>Help:<br><br>  GPT<br>   M   enter protective/hybrid MBR<br><br>  Generic<br>   d   delete a partition<br>   F   list free unpartitioned space<br>   l   list known partition types<br>   n   add a new partition<br>   p   <span class="hljs-built_in">print</span> the partition table<br>   t   change a partition <span class="hljs-built_in">type</span><br>   v   verify the partition table<br>   i   <span class="hljs-built_in">print</span> information about a partition<br><br>  Misc<br>   m   <span class="hljs-built_in">print</span> this menu<br>   x   extra functionality (experts only)<br><br>  Script<br>   I   load disk layout from sfdisk script file<br>   O   dump disk layout to sfdisk script file<br><br>  Save &amp; Exit<br>   w   write table to disk and <span class="hljs-built_in">exit</span><br>   q   quit without saving changes<br><br>  Create a new label<br>   g   create a new empty GPT partition table<br>   G   create a new empty SGI (IRIX) partition table<br>   o   create a new empty MBR (DOS) partition table<br>   s   create a new empty Sun partition table<br><br><br>Command (m <span class="hljs-keyword">for</span> <span class="hljs-built_in">help</span>): n<br>Partition number (1-128, default 1):<br>First sector (34-23437770718, default 2048):<br>Last sector, +/-sectors or +/-size&#123;K,M,G,T,P&#125; (2048-23437770718, default 23437768703): +4T<br><br>Created a new partition 1 of <span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;Linux filesystem&#x27;</span> and of size 4 TiB.<br>Partition <span class="hljs-comment">#1 contains a LVM2_member signature.</span><br><br>Do you want to remove the signature? [Y]es/[N]o: y<br><br>The signature will be removed by a write <span class="hljs-built_in">command</span>.<br><br>Command (m <span class="hljs-keyword">for</span> <span class="hljs-built_in">help</span>): n<br>Partition number (2-128, default 2):<br>First sector (8589936640-23437770718, default 8589936640):<br>Last sector, +/-sectors or +/-size&#123;K,M,G,T,P&#125; (8589936640-23437770718, default 23437768703): +4T<br><br>Created a new partition 2 of <span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;Linux filesystem&#x27;</span> and of size 4 TiB.<br><br>Command (m <span class="hljs-keyword">for</span> <span class="hljs-built_in">help</span>): n<br>Partition number (3-128, default 3):<br>First sector (17179871232-23437770718, default 17179871232):<br>Last sector, +/-sectors or +/-size&#123;K,M,G,T,P&#125; (17179871232-23437770718, default 23437768703):<br><br>Created a new partition 3 of <span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;Linux filesystem&#x27;</span> and of size 2.9 TiB.<br><br>Command (m <span class="hljs-keyword">for</span> <span class="hljs-built_in">help</span>): w<br>The partition table has been altered.<br>Calling ioctl() to re-read partition table.<br>Syncing disks.<br></code></pre></td></tr></table></figure><p>ç„¶åæ ¹æ®æ•™ç¨‹å¯¹åˆ†åŒºè¿›è¡ŒåŠ å¯†<sup id="fnref:11" class="footnote-ref"><a href="#fn:11" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Linux ç³»ç»Ÿåˆ›å»ºåŠ å¯†ç£ç›˜å¹¶è‡ªåŠ¨æŒ‚è½½ | Sink çš„ç¬”è®°æœ¬](https://ldsink.com/articles/how-to-create-crypt-disk-and-auto-mount/)">[11]</span></a></sup><sup id="fnref:12" class="footnote-ref"><a href="#fn:12" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Linux ç£ç›˜åŠ å¯†å’Œè‡ªåŠ¨æŒ‚è½½ - é˜¿è›®å›åšå®¢](https://www.amjun.com/2590.html)">[12]</span></a></sup></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># å…¨ç¨‹rootæ“ä½œ</span><br><span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=/dev/urandom of=/etc/cryptfs.key bs=1k count=4<br>cryptsetup luksFormat /dev/sda1 /etc/cryptfs.key<br><span class="hljs-comment"># ç„¶åéœ€è¦è¾“å…¥å¤§å†™çš„YES</span><br><span class="hljs-comment"># æ‰“å¼€åŠ å¯†çš„åˆ†åŒº</span><br>cryptsetup open /dev/sdc1 sdc1 --key-file=/etc/cryptfs.key<br><span class="hljs-comment"># åœ¨æ‰“å¼€çš„åˆ†åŒºä¸Šåˆ›å»ºæ–‡ä»¶ç³»ç»Ÿ</span><br>mkfs.ext4 /dev/mapper/sdc1<br></code></pre></td></tr></table></figure><p>æ‰“å¼€çš„åˆ†åŒºä¼šå‡ºç°åœ¨<code>/dev/mapper</code>ä¸­</p><p><img src="https://s2.loli.net/2025/01/08/YiL63UoFOI4gzuk.png" alt="image-20250108220027245"></p><p>é€šè¿‡æ›´æ”¹<code>/etc/crypttab</code>é…ç½®æ–‡ä»¶æ¥å®ç°è‡ªåŠ¨è§£å¯†ï¼Œä½¿ç”¨åˆ†åŒºçš„UUIDæ¥è¯†åˆ«åˆ†åŒºå¯ä»¥é¿å…å› ä¸ºå¯åŠ¨é¡ºåºä¸åŒé€ æˆçš„é—®é¢˜ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># å…ˆç¡®è®¤åˆ†åŒºçš„UUID</span><br>sudo blkid<br>sudo nano /etc/crypttab<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs conf"># &lt;target name&gt; &lt;source device&gt;                            &lt;key file&gt;      &lt;options&gt;<br>sdc1            UUID=&lt;partition uuid&gt;  /etc/cryptfs.key<br></code></pre></td></tr></table></figure><p>ç„¶åæ›´æ”¹<code>/etc/fstab</code>æ¥å®ç°è‡ªåŠ¨æŒ‚è½½ï¼Œå› ä¸º<code>crypttab</code>å·²ç»å›ºå®šäº†target nameäº†ï¼Œæ‰€ä»¥åº”è¯¥ä¹Ÿä¸éœ€è¦uuidæ¥æŒ‚è½½äº†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># &lt;file system&gt;  &lt;mount point&gt;  &lt;type&gt;  &lt;options&gt;       &lt;dump&gt;  &lt;pass&gt;</span><br>/dev/mapper/sdc1 /some/path      ext4   defaults        0       0<br></code></pre></td></tr></table></figure><h2 id="Linuxé…ç½®ç£ç›˜é˜µåˆ—"><a href="#Linuxé…ç½®ç£ç›˜é˜µåˆ—" class="headerlink" title="Linuxé…ç½®ç£ç›˜é˜µåˆ—"></a>Linuxé…ç½®ç£ç›˜é˜µåˆ—</h2><p>ç»„ä»¶RAID5é˜µåˆ—éœ€è¦è‡³å°‘ä¸‰ä¸ªç¡¬ç›˜<sup id="fnref:8" class="footnote-ref"><a href="#fn:8" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Linuxä¸‹æ„å»ºRAID5 - æµå¹´ä¼¼æ°´zlw - åšå®¢å›­](https://www.cnblogs.com/zlw-xyz/p/14075476.html)">[8]</span></a></sup><sup id="fnref:9" class="footnote-ref"><a href="#fn:9" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Linuxä¸‹æ„å»ºRAID5 | ã€ŠLinuxå°±è¯¥è¿™ä¹ˆå­¦ã€‹](https://www.linuxprobe.com/linux-raid5.html)">[9]</span></a></sup></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo mdadm -C /dev/md0 -l 5 -n 3 -x 1 /dev/sda /dev/sdb /dev/sdc /dev/sdd<br></code></pre></td></tr></table></figure><p><code>-x 1</code>è¡¨ç¤ºæœ‰ä¸€å—çƒ­å¤‡ç›˜ï¼Œå¦‚æœæ²¡æœ‰å¯ä»¥ç›´æ¥å»æ‰</p><p>é…ç½®mdadmæ¯æ¬¡é‡å¯éƒ½èƒ½è¯†åˆ«åˆ°raidé˜µåˆ—ï¼Œéœ€è¦æ›´æ”¹é…ç½®æ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># æ³¨æ„éœ€è¦æœ‰å†™æƒé™</span><br><span class="hljs-comment"># mdadm --detail --scan --verbose /dev/md0 &gt; /etc/mdadm.conf</span><br>mdadm --detail --scan --verbose /dev/md0 &gt;&gt; /etc/mdadm/mdadm.conf<br></code></pre></td></tr></table></figure><p>ç„¶åæ ¹æ®è¿™ä¸ªé…ç½®æ–‡ä»¶çš„æç¤ºï¼Œè¿˜éœ€è¦è¿è¡Œ<code>update-initramfs -u</code>å‘½ä»¤</p><p>ç„¶åå°±å¯ä»¥åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿæ ¼å¼åŒ–ï¼Œç„¶åæŒ‚è½½äº†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo mkfs.ext4 /dev/md0<br>sudo mount /dev/md0 /some/path<br></code></pre></td></tr></table></figure><p>å¦‚æœéœ€è¦å¼€æœºè‡ªåŠ¨æŒ‚è½½ï¼Œéœ€è¦æ›´æ”¹fstab</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs conf"># /etc/fstab<br>/dev/md0  /some/path  ext4 defaults 0 0<br></code></pre></td></tr></table></figure><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://www.proxmox.com/en/proxmox-virtual-environment/overview">Proxmox Virtual Environment - Open-Source Server Virtualization Platform</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://www.ventoy.net/cn/index.html">Ventoy</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://forum.proxmox.com/threads/error-no-device-with-valid-iso-found.134510/">[SOLVED] - [ERROR] No Device with Valid ISO Found | Proxmox Support Forum</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://forum.proxmox.com/threads/ventoy-install-of-proxmox-8-1-halts-at-loading-initial-ramdisk.143196/">Ventoy install of Proxmox 8.1 halts at Loading initial ramdisk | Proxmox Support Forum</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:5" class="footnote-text"><span><a href="https://foxi.buduanwang.vip/virtualization/256.html/">ä½›è¥¿åšå®¢ - Proxmox VEé…ç½®sslè¯ä¹¦</a><a href="#fnref:5" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:6" class="footnote-text"><span><a href="https://post.smzdm.com/p/a85g06k7/">å®¹æ˜“è¢«å¿½ç•¥çš„PVEç»†èŠ‚â€”PVEçš„tips_NASå­˜å‚¨_ä»€ä¹ˆå€¼å¾—ä¹°</a><a href="#fnref:6" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:7" class="footnote-text"><span><a href="https://www.xh86.me/?p=724">PVEå¼€å¯ç¡¬ä»¶ç›´é€šåŠŸèƒ½ â€“ æ‚ä¸ƒæ‚å…«</a><a href="#fnref:7" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:8" class="footnote-text"><span><a href="https://www.cnblogs.com/zlw-xyz/p/14075476.html">Linuxä¸‹æ„å»ºRAID5 - æµå¹´ä¼¼æ°´zlw - åšå®¢å›­</a><a href="#fnref:8" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:9" class="footnote-text"><span><a href="https://www.linuxprobe.com/linux-raid5.html">Linuxä¸‹æ„å»ºRAID5 | ã€ŠLinuxå°±è¯¥è¿™ä¹ˆå­¦ã€‹</a><a href="#fnref:9" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:10" class="footnote-text"><span><a href="https://www.cnblogs.com/liugp/p/16417652.html">Linuxç£ç›˜åˆ†åŒºã€æ ¼å¼åŒ–ã€æŒ‚è½½ - å¤§æ•°æ®è€å¸æœº - åšå®¢å›­</a><a href="#fnref:10" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:11" class="footnote-text"><span><a href="https://ldsink.com/articles/how-to-create-crypt-disk-and-auto-mount/">Linux ç³»ç»Ÿåˆ›å»ºåŠ å¯†ç£ç›˜å¹¶è‡ªåŠ¨æŒ‚è½½ | Sink çš„ç¬”è®°æœ¬</a><a href="#fnref:11" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:12" class="footnote-text"><span><a href="https://www.amjun.com/2590.html">Linux ç£ç›˜åŠ å¯†å’Œè‡ªåŠ¨æŒ‚è½½ - é˜¿è›®å›åšå®¢</a><a href="#fnref:12" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>linux</tag>
      
      <tag>pve</tag>
      
      <tag>nas</tag>
      
      <tag>vm</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>appium inspectoré…ç½®</title>
    <link href="/2025/01/03/appium-inspector%E9%85%8D%E7%BD%AE/"/>
    <url>/2025/01/03/appium-inspector%E9%85%8D%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<h2 id="appiumä»¥åŠappium-inspectorå®‰è£…åŠé…ç½®"><a href="#appiumä»¥åŠappium-inspectorå®‰è£…åŠé…ç½®" class="headerlink" title="appiumä»¥åŠappium-inspectorå®‰è£…åŠé…ç½®"></a>appiumä»¥åŠappium-inspectorå®‰è£…åŠé…ç½®</h2><p>appiuméœ€è¦ä½¿ç”¨æ¯”è¾ƒæ–°çš„ç‰ˆæœ¬çš„nodejs</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo apt update<br>curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -<br>sudo apt install -y nodejs<br>node -v<br>npm -v<br><br>sudo apt install openjdk-17-jdk<br><br>wget https://dl.google.com/android/repository/commandlinetools-linux-6858069_latest.zip<br>sudo unzip commandlinetools-linux-6858069_latest.zip<br><br>sudo <span class="hljs-built_in">ln</span> -s /path/to/sdkmanager /bin/sdkmanager<br>sudo sdkmanager --proxy=http --proxy_host=host --proxy_port=port --sdk_root=/opt/android-sdk <span class="hljs-string">&quot;platforms;android-28&quot;</span><span class="hljs-string">&quot;</span><br><span class="hljs-string">sudo sdkmanager --proxy=http --proxy_host=host --proxy_port=port --sdk_root=/opt/android-sdk &quot;</span>platform-tools<span class="hljs-string">&quot;</span><br><span class="hljs-string"></span><br><span class="hljs-string">sudo ln -s /path/to/adb /bin/adb</span><br><span class="hljs-string">sudo npm config set proxy http://your-proxy-server:port</span><br><span class="hljs-string">sudo npm install -g appium</span><br><span class="hljs-string">appium driver install uiautomator2</span><br></code></pre></td></tr></table></figure><p>å­ç½‘å†…é€šè¿‡adbè¿æ¥åˆ°æ‰‹æœºï¼Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">adb connect <span class="hljs-variable">$ip</span>:<span class="hljs-variable">$port</span><br></code></pre></td></tr></table></figure><p>è·å–åŒ…åï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">adb shell pm list packages | grep xxx<br></code></pre></td></tr></table></figure><p>è·å–å¯åŠ¨activityï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">adb shell monkey -p com.package.name -c android.intent.category.LAUNCHER -v -v 0 | grep  Using<br></code></pre></td></tr></table></figure><p>appiumæœåŠ¡å™¨ä¸­è¿è¡Œ<code>appium</code>å¯åŠ¨æœåŠ¡ï¼Œç„¶åé…ç½®appium-inspectorï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;platformName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Android&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;appium:platformVersion&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;9.0&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;appium:deviceName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;device-serial&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;appium:appPackage&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;com.package.name&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;appium:appActivity&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;com.package.name.Activity&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;appium:automationName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;UiAutomator2&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><h2 id="ADBå¸¸ç”¨å‘½ä»¤"><a href="#ADBå¸¸ç”¨å‘½ä»¤" class="headerlink" title="ADBå¸¸ç”¨å‘½ä»¤"></a>ADBå¸¸ç”¨å‘½ä»¤</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">adb devices<br><span class="hljs-comment"># åˆ—å‡ºå·²è¿æ¥çš„è®¾å¤‡</span><br><br>adb connect 192.168.1.111:5555<br><span class="hljs-comment"># è¿æ¥åˆ°å±€åŸŸç½‘çš„adbè®¾å¤‡</span><br><br>adb -s serial-0001 shell <span class="hljs-built_in">ls</span><br><span class="hljs-comment"># é€šè¿‡adbè¿æ¥çš„è®¾å¤‡ï¼ˆè¿æ¥å¤šä¸ªè®¾å¤‡æ—¶é€šè¿‡-så‚æ•°æŒ‡å®šè®¾å¤‡ç¼–å·ï¼‰ä¸­æ‰§è¡Œlså‘½ä»¤</span><br><span class="hljs-comment"># å¦‚æœåªæœ‰ä¸€ä¸ªadbè®¾å¤‡ï¼Œ-såŠ ä¸åŠ æ— æ‰€è°“</span><br><br>adb shell pm list packages | grep xxx<br>adb shell pm list packages | findstr xxx<br><span class="hljs-comment"># åˆ—å‡ºæ‰€æœ‰å®‰è£…çš„åŒ…ï¼Œé‡å®šå‘è¾“å‡ºç„¶åæ­£åˆ™åŒ¹é…ï¼Œlinuxç”¨grepï¼Œwindowsç”¨findstr</span><br><br>adb shell /system/bin/screencap -p /sdcard/ss.png<br>adb pull /sdcard/ss.png .<br><span class="hljs-comment"># adbè·å–è®¾å¤‡æˆªå›¾å¹¶pullåˆ°æœ¬åœ°</span><br></code></pre></td></tr></table></figure><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://www.cnblogs.com/lixuefang69/p/15425471.html">åˆ©ç”¨adbå‘½ä»¤å¯¹æ‰‹æœºæˆªå›¾ä¿å­˜åˆ°ç”µè„‘ - æ›¦æ¶µ - åšå®¢å›­</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>android</tag>
      
      <tag>adb</tag>
      
      <tag>appium</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>dockerå¸¸ç”¨å‘½ä»¤ä»¥åŠç¯å¢ƒå·¥ä½œé…ç½®å¤‡ä»½</title>
    <link href="/2024/12/30/docker%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E4%BB%A5%E5%8F%8A%E7%8E%AF%E5%A2%83%E5%B7%A5%E4%BD%9C%E9%85%8D%E7%BD%AE%E5%A4%87%E4%BB%BD/"/>
    <url>/2024/12/30/docker%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E4%BB%A5%E5%8F%8A%E7%8E%AF%E5%A2%83%E5%B7%A5%E4%BD%9C%E9%85%8D%E7%BD%AE%E5%A4%87%E4%BB%BD/</url>
    
    <content type="html"><![CDATA[<h2 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker run -itd -p 10022:22 -v ~/data:/root/data --name my_container ubuntu:22.04 bash<br><span class="hljs-comment"># dockerè¿è¡Œå®¹å™¨ï¼Œæ·»åŠ ç«¯å£æ˜ å°„å’Œç›®å½•æ˜ å°„</span><br><br>docker ps -a<br><span class="hljs-comment"># åˆ—å‡ºæ‰€æœ‰çš„å®¹å™¨ï¼Œ-aè¡¨ç¤ºä¸ç®¡æœ‰æ²¡æœ‰åœ¨è¿è¡Œ</span><br><br>docker <span class="hljs-built_in">exec</span> -it my_container bash<br><span class="hljs-comment"># dockerè¿›å…¥å®¹å™¨å¹¶è·å–ä¸€ä¸ªå¯äº¤äº’çš„ç»ˆç«¯</span><br><br>docker start my_container<br><span class="hljs-comment"># startå¯åŠ¨å®¹å™¨ï¼Œstopå…³é—­ï¼Œrestarté‡å¯</span><br><br>docker <span class="hljs-built_in">rm</span> -f my_container<br><span class="hljs-comment"># åˆ é™¤æŸä¸ªå®¹å™¨ï¼Œ-få¼ºåˆ¶åˆ é™¤ï¼ˆä¸ç”¨æ‰‹åŠ¨å…³é—­å®¹å™¨ï¼‰</span><br><br>docker inspect my_container<br><span class="hljs-comment"># dockeræŸ¥çœ‹å®¹å™¨çš„ä¿¡æ¯ï¼ˆæ¯”å¦‚ç½‘ç»œä»€ä¹ˆçš„ï¼‰</span><br><br>docker network <span class="hljs-built_in">ls</span><br><span class="hljs-comment"># åˆ—å‡ºdockerçš„ç½‘ç»œ</span><br><br>docker network inspcet network_name_or_id<br><span class="hljs-comment"># dockeræŸ¥çœ‹è¯¥ç½‘ç»œçš„ä¿¡æ¯ï¼ˆæ¯”å¦‚æœ‰å“ªäº›å®¹å™¨åœ¨è¿™ä¸ªç½‘ç»œä¸Šï¼‰</span><br><br>docker nerwork <span class="hljs-built_in">rm</span> network_name<br><span class="hljs-comment"># åˆ é™¤æŸä¸ªç½‘ç»œï¼ˆéœ€è¦é‡å¯dockerï¼‰</span><br></code></pre></td></tr></table></figure><h2 id="dockerç½‘æ®µä¸å¤–éƒ¨å†²çª"><a href="#dockerç½‘æ®µä¸å¤–éƒ¨å†²çª" class="headerlink" title="dockerç½‘æ®µä¸å¤–éƒ¨å†²çª"></a>dockerç½‘æ®µä¸å¤–éƒ¨å†²çª</h2><p>å¦‚æœ Docker çš„é»˜è®¤ç½‘æ®µä¸å¤–éƒ¨ç½‘ç»œç½‘æ®µå‘ç”Ÿå†²çªï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤è¿›è¡Œæ›´æ”¹ï¼š</p><p><strong>ç¼–è¾‘ Docker é…ç½®æ–‡ä»¶</strong>ï¼šé€šå¸¸ï¼ŒDocker çš„é…ç½®æ–‡ä»¶ä½äº <code>/etc/docker/daemon.json</code>ã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œå¯ä»¥åˆ›å»ºå®ƒã€‚</p><p><strong>é…ç½®è‡ªå®šä¹‰ç½‘æ®µ</strong>ï¼šåœ¨ <code>daemon.json</code> æ–‡ä»¶ä¸­æ·»åŠ æˆ–ä¿®æ”¹ä»¥ä¸‹å†…å®¹æ¥è®¾ç½®ä¸€ä¸ªæ–°çš„ç½‘æ®µï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br> <span class="hljs-attr">&quot;bip&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;172.30.0.1/16&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œçš„ <code>172.30.0.1/16</code> æ˜¯ä¸€ä¸ªç¤ºä¾‹ç½‘æ®µï¼Œå¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©ä¸€ä¸ªä¸å†²çªçš„ç§æœ‰ç½‘æ®µã€‚</p><p><strong>é‡å¯ Docker æœåŠ¡</strong>ï¼šä¿å­˜é…ç½®æ–‡ä»¶åï¼Œé‡å¯ Docker æœåŠ¡ä»¥åº”ç”¨æ›´æ”¹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo systemctl restart docker<br></code></pre></td></tr></table></figure><p><strong>éªŒè¯æ›´æ”¹</strong>ï¼šé‡å¯åï¼Œå¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥éªŒè¯ Docker æ˜¯å¦ä½¿ç”¨äº†æ–°çš„ç½‘æ®µï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker network inspect bridge<br></code></pre></td></tr></table></figure><p>æ£€æŸ¥è¾“å‡ºä¸­çš„ <code>Subnet</code> ä¿¡æ¯æ˜¯å¦ä¸é…ç½®ä¸€è‡´ã€‚è¿™æ ·è®¾ç½®åï¼ŒDocker å°†ä½¿ç”¨ä½ æŒ‡å®šçš„ç½‘æ®µï¼Œä»è€Œé¿å…ä¸å¤–éƒ¨ç½‘ç»œå†²çªã€‚å¦‚æœ<code>ip r</code>å‘ç°è¿˜æœ‰å¯¹åº”çš„è·¯ç”±è¡¨ï¼Œå¯èƒ½éœ€è¦<code>docker network rm n_name</code>æ‰‹åŠ¨åˆ é™¤æ— ç”¨çš„ç½‘ç»œã€‚</p><h2 id="é…ç½®å¸¸ç”¨ç¯å¢ƒ"><a href="#é…ç½®å¸¸ç”¨ç¯å¢ƒ" class="headerlink" title="é…ç½®å¸¸ç”¨ç¯å¢ƒ"></a>é…ç½®å¸¸ç”¨ç¯å¢ƒ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs bash">PUB_KEYS=(<span class="hljs-string">&quot;pub key1&quot;</span> <span class="hljs-string">&quot;pub key2&quot;</span>)<br>apt update &amp;&amp; apt install ca-certificates -y<br><span class="hljs-built_in">mv</span> /etc/apt/sources.list /etc/apt/sources.list.backup<br><span class="hljs-built_in">cat</span> &gt; /etc/apt/sources.list &lt;&lt;<span class="hljs-string">EOF</span><br><span class="hljs-string">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy main restricted universe multiverse</span><br><span class="hljs-string">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-updates main restricted universe multiverse</span><br><span class="hljs-string">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-backports main restricted universe multiverse</span><br><span class="hljs-string"></span><br><span class="hljs-string">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-security main restricted universe multiverse</span><br><span class="hljs-string">EOF</span><br>apt update &amp;&amp; apt upgrade -y &amp;&amp; apt install nano git wget curl openssh-server zsh -y<br>sed -i <span class="hljs-string">&quot;s/#PubkeyAuthentication.*$/PubkeyAuthentication\ yes/g&quot;</span> /etc/ssh/sshd_config<br>sed -i <span class="hljs-string">&quot;s/#PasswordAuthentication.*$/PasswordAuthentication\ no/g&quot;</span> /etc/ssh/sshd_config<br>sed -i <span class="hljs-string">&quot;s/#AuthorizedKeysFile.*$/AuthorizedKeysFile\ .ssh\/authorized_keys/g&quot;</span> /etc/ssh/sshd_config<br><span class="hljs-keyword">if</span> [ ! -d ~/.ssh/ ]; <span class="hljs-keyword">then</span><br><span class="hljs-built_in">mkdir</span> ~/.ssh<br><span class="hljs-keyword">fi</span><br><span class="hljs-keyword">if</span> [ ! -f ~/.ssh/authorized_keys ]; <span class="hljs-keyword">then</span><br>    <span class="hljs-built_in">touch</span> ~/.ssh/authorized_keys<br><span class="hljs-keyword">fi</span><br><span class="hljs-built_in">chmod</span> 600 ~/.ssh/authorized_keys<br><span class="hljs-keyword">for</span> pub <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;PUB_KEYS[@]&#125;</span>&quot;</span>;<br><span class="hljs-keyword">do</span> <span class="hljs-built_in">echo</span> <span class="hljs-variable">$pub</span> &gt;&gt; ~/.ssh/authorized_keys<br><span class="hljs-keyword">done</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;service ssh start&quot;</span> &gt;&gt; ~/.bashrc<br>usermod -s `<span class="hljs-built_in">which</span> zsh` root<br>sh -c <span class="hljs-string">&quot;<span class="hljs-subst">$(curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh)</span>&quot;</span><br>git <span class="hljs-built_in">clone</span> https://github.com/zsh-users/zsh-autosuggestions <span class="hljs-variable">$&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;</span>/plugins/zsh-autosuggestions<br>git <span class="hljs-built_in">clone</span> https://github.com/zsh-users/zsh-syntax-highlighting.git <span class="hljs-variable">$&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;</span>/plugins/zsh-syntax-highlighting<br>sed -i <span class="hljs-string">&quot;s/^plugins=(git.*$/plugins=(git zsh-autosuggestions zsh-syntax-highlighting)/g&quot;</span> ~/.zshrc<br>git <span class="hljs-built_in">clone</span> --depth=1 https://github.com/romkatv/powerlevel10k.git <span class="hljs-variable">$&#123;ZSH_CUSTOM:-<span class="hljs-variable">$HOME</span>/.oh-my-zsh/custom&#125;</span>/themes/powerlevel10k<br>sed -i <span class="hljs-string">&quot;s/^ZSH_THEME=.*$/ZSH_THEME=powerlevel10k\/powerlevel10k/g&quot;</span> ~/.zshrc<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>dockeré…ç½®transmission</title>
    <link href="/2024/12/16/docker%E9%85%8D%E7%BD%AEtransmission/"/>
    <url>/2024/12/16/docker%E9%85%8D%E7%BD%AEtransmission/</url>
    
    <content type="html"><![CDATA[<p>æœ‰ä¸€äº›ç½‘ç«™ä¼šé™åˆ¶ä½¿ç”¨çš„btå®¢æˆ·ç«¯çš„ç‰ˆæœ¬ï¼Œç„¶åarchlinuxç”±äºæ»šåŠ¨æ›´æ–°ï¼Œè½¯ä»¶éƒ½æ˜¯æœ€æ–°ç‰ˆæœ¬çš„ï¼Œæ‰€ä»¥dockerå°±éå¸¸å¥½ç”¨ã€‚</p><h2 id="docker-compose-yaml"><a href="#docker-compose-yaml" class="headerlink" title="docker-compose.yaml"></a>docker-compose.yaml</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">&quot;2.1&quot;</span><br><span class="hljs-attr">services:</span><br>  <span class="hljs-attr">transmission:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">linuxserver/transmission:latest</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">transmission</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">PUID=1000</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">PGID=1000</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">TZ=Etc/UTC</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">TRANSMISSION_WEB_HOME=</span> <span class="hljs-comment">#å¯é€‰</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">USER=</span> <span class="hljs-comment">#å¯é€‰ï¼Œæ­¤å¤„è®¾ç½®WebUIè´¦æˆ·</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">PASS=</span> <span class="hljs-comment">#å¯é€‰ï¼Œæ­¤å¤„è®¾ç½®WebUIå¯†ç </span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">WHITELIST=</span> <span class="hljs-comment">#å¯é€‰ï¼Œ æŒ‡å®šå¯è®¿é—®WebUIçš„ç™½åå•çš„ipåˆ—è¡¨ï¼Œé€—å·åˆ†éš”</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">RPCPORT=</span> <span class="hljs-comment">#å¯é€‰ï¼Œæ­¤å¤„è®¾ç½®WebUIç«¯å£ï¼Œé»˜è®¤ä¸º9091</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">PEERPORT=</span> <span class="hljs-comment">#å¯é€‰ï¼Œæ­¤å¤„è®¾ç½®ç§å­é“¾æ¥ç«¯å£ï¼Œé»˜è®¤ä¸º51413</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">HOST_WHITELIST=</span> <span class="hljs-comment">#å¯é€‰</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/path/to/config:/config</span> <span class="hljs-comment">#æŒ‚è½½TRè®¾ç½®æ–‡ä»¶å­˜å‚¨</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/path/to/downloads:/downloads</span> <span class="hljs-comment">#æŒ‚è½½TRä¸‹è½½æ–‡ä»¶å­˜å‚¨</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/path/to/watch:/watch</span> <span class="hljs-comment">#æŒ‚è½½TRç§å­ç›‘å¬æ–‡ä»¶å­˜å‚¨</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">9091</span><span class="hljs-string">:9091</span> <span class="hljs-comment">#NATè½¬å‘RPCç«¯å£</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">51413</span><span class="hljs-string">:51413</span> <span class="hljs-comment">#NATè½¬å‘PEERç«¯å£</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">51413</span><span class="hljs-string">:51413/udp</span> <span class="hljs-comment">#NATè½¬å‘PEER(UDP)ç«¯å£</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span><br></code></pre></td></tr></table></figure><p>é…ç½®æ–‡ä»¶æ¥è‡ª<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[[Docker\]Transmissionï¼ˆå®˜æ–¹ğŸ‹Dockerç‰ˆï¼‰å®‰è£… - invites.fun](https://invites.fun/d/694)">[1]</span></a></sup>ï¼ˆæœ‰ä¸€äº›ä¿®æ”¹ï¼‰ã€‚linuxserverå®˜æ–¹æ–‡æ¡£<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[linuxserver/transmission - Docker Image | Docker Hub](https://hub.docker.com/r/linuxserver/transmission)">[2]</span></a></sup></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">&quot;2.1&quot;</span><br><span class="hljs-attr">services:</span><br>  <span class="hljs-attr">transmission:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">linuxserver/transmission:4.0.5</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">transmission</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">PUID=1000</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">PGID=1000</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">TZ=Etc/UTC</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">TRANSMISSION_WEB_HOME=/config/web/src</span> <span class="hljs-comment">#é…ç½®ç¾åŒ–ä¹‹åçš„webui</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">USER=username_of_webui</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">PASS=password_of_webui</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">WHITELIST=</span> <span class="hljs-comment">#å¯é€‰ï¼Œ æŒ‡å®šå¯è®¿é—®WebUIçš„ç™½åå•çš„ipåˆ—è¡¨ï¼Œé€—å·åˆ†éš”</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">RPCPORT=</span> <span class="hljs-comment">#å¯é€‰ï¼Œæ­¤å¤„è®¾ç½®WebUIç«¯å£ï¼Œé»˜è®¤ä¸º9091</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">PEERPORT=</span> <span class="hljs-comment">#å¯é€‰ï¼Œæ­¤å¤„è®¾ç½®ç§å­é“¾æ¥ç«¯å£ï¼Œé»˜è®¤ä¸º51413</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">HOST_WHITELIST=</span> <span class="hljs-comment">#å¯é€‰</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/home/tr/config:/config</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/home/tr/downloads:/downloads</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/home/tr/watch:/watch</span><br>    <span class="hljs-attr">network_mode:</span> <span class="hljs-string">host</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span><br></code></pre></td></tr></table></figure><p>ç½‘ç»œæ¨¡å¼æ”¹æˆäº†<code>host</code>ï¼Œç„¶åå¢åŠ äº†web_homeï¼Œå¯ä»¥ç”¨æ¥æ”¹å˜UI</p><p>ä»releaseé¡µé¢<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Releases Â· ronggang/transmission-web-control](https://github.com/ronggang/transmission-web-control/releases)">[3]</span></a></sup>ä¸‹è½½webuiçš„æºä»£ç ï¼Œç„¶åç¡®ä¿æŠŠè§£å‹åçš„<code>src</code>æ–‡ä»¶å¤¹ä¸­çš„å†…å®¹æ”¾åˆ°ä¹‹å‰é…ç½®çš„<code>/config/web/src</code>ï¼ˆå› ä¸º<code>config</code>æ–‡ä»¶å¤¹å·²ç»æ˜ å°„è¿‡äº†ï¼Œæ‰€ä»¥ä¹Ÿå°±æ˜¯<code>home/tr/config/web/src</code>ï¼‰ä¸­ã€‚</p><p>ç„¶å<code>docker compose up -d</code>å³å¯ã€‚</p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span>[<a href="https://invites.fun/d/694">Docker]Transmissionï¼ˆå®˜æ–¹ğŸ‹Dockerç‰ˆï¼‰å®‰è£… - invites.fun</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://hub.docker.com/r/linuxserver/transmission">linuxserver&#x2F;transmission - Docker Image | Docker Hub</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://github.com/ronggang/transmission-web-control/releases">Releases Â· ronggang&#x2F;transmission-web-control</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>docker</tag>
      
      <tag>linuxserver</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>dockeré…ç½®å„ç§ä»£ç†</title>
    <link href="/2024/12/09/docker%E9%85%8D%E7%BD%AE%E5%90%84%E7%A7%8D%E4%BB%A3%E7%90%86/"/>
    <url>/2024/12/09/docker%E9%85%8D%E7%BD%AE%E5%90%84%E7%A7%8D%E4%BB%A3%E7%90%86/</url>
    
    <content type="html"><![CDATA[<p>å‚è€ƒæ€»ç»“è‡ª<a href="https://skywt.cn/blog/">SkyWT</a>çš„åšå®¢<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Docker ä»£ç†é…ç½®æ–¹æ³•åˆé›†](https://skywt.cn/blog/docker-proxy-configuration/)">[1]</span></a></sup></p><h2 id="Docker-daemonä»£ç†"><a href="#Docker-daemonä»£ç†" class="headerlink" title="Docker daemonä»£ç†"></a>Docker daemonä»£ç†</h2><p><strong>é—®é¢˜</strong>ï¼šä»DockerHubæ‹‰å–é•œåƒæ—¶å¯èƒ½å‡ºç°ç½‘ç»œé—®é¢˜ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šåœ¨ <code>/etc/systemd/system/docker.service.d/http-proxy.conf</code> ç¼–å†™ systemd é…ç½®ï¼Œé…ç½® HTTP å’Œ HTTPS ä»£ç†ï¼š</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[Service]</span><br><span class="hljs-attr">Environment</span>=<span class="hljs-string">&quot;HTTP_PROXY=http://127.0.0.1:1080&quot;</span><br><span class="hljs-attr">Environment</span>=<span class="hljs-string">&quot;HTTPS_PROXY=http://127.0.0.1:1080&quot;</span><br></code></pre></td></tr></table></figure><p>é…ç½®å®Œä¹‹åé‡æ–°åŠ è½½é…ç½®æ–‡ä»¶å¹¶é‡å¯dockerï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo systemctl daemon-reload<br>sudo systemctl restart docker<br></code></pre></td></tr></table></figure><p>noteï¼šä¸åŒçš„å‘è¡Œç‰ˆä¸­serviceæ–‡ä»¶çš„ä½ç½®ä¸ä¸€æ ·ï¼Œåœ¨archlinuxä¸­ä½äº<code>/usr/lib/systemd/system/docker.service</code></p><h2 id="å®¹å™¨å†…ä»£ç†"><a href="#å®¹å™¨å†…ä»£ç†" class="headerlink" title="å®¹å™¨å†…ä»£ç†"></a>å®¹å™¨å†…ä»£ç†</h2><p><strong>é—®é¢˜</strong>ï¼šé…ç½®æ¯ä¸ªå®¹å™¨çš„ä»£ç†ç¯å¢ƒå˜é‡è¾ƒç¹çã€‚<br><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šåœ¨ <code>~/.docker/config.json</code> ä¸­è®¾ç½®å…¨å±€ä»£ç†é…ç½®ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;proxies&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;default&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;httpProxy&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;http://example:1080&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;httpsProxy&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;http://example:1080&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;noProxy&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;*.test.example.com,.example.org,127.0.0.0/8,192.168.0.0/16&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>noteï¼šä½¿ç”¨sudoå¯åŠ¨çš„å®¹å™¨ï¼Œé…ç½®æ–‡ä»¶æŒ‰ç…§<code>/root/.docker/config.json</code>ï¼Œå¹¶ä¸”ï¼Œè¿™é‡Œçš„proxyå¦‚æœè®¾ç½®ä¸º<code>localhost</code>æˆ–è€…<code>127.0.0.1</code>ï¼ŒæŒ‡çš„æ˜¯å®¹å™¨è‡ªå·±çš„åœ°å€ã€‚</p><h2 id="Buildä»£ç†"><a href="#Buildä»£ç†" class="headerlink" title="Buildä»£ç†"></a>Buildä»£ç†</h2><p><strong>é—®é¢˜</strong>ï¼šdocker build æ—¶ç½‘ç»œé—®é¢˜ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šä½¿ç”¨<code>docker build</code>æ—¶æ·»åŠ å‚æ•°<code>--network=host</code>è®¾ç½®buildç½‘ç»œã€‚æˆ–è€…åœ¨<code>docker-compose.yml</code>ä¸­è®¾ç½®ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">build:</span><br>  <span class="hljs-attr">context:</span> <span class="hljs-string">.</span><br>  <span class="hljs-attr">network:</span> <span class="hljs-string">host</span><br>  <span class="hljs-attr">dockerfile:</span> <span class="hljs-string">Dockerfile</span><br></code></pre></td></tr></table></figure><p>ç„¶ååœ¨<code>Dockerfile</code>ä¸­è®¾å®šç¯å¢ƒå˜é‡ï¼š</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">ENV</span> http_proxy=<span class="hljs-string">&quot;http://127.0.0.1:1080&quot;</span><br><span class="hljs-keyword">ENV</span> HTTP_PROXY=<span class="hljs-string">&quot;http://127.0.0.1:1080&quot;</span><br><span class="hljs-keyword">ENV</span> https_proxy=<span class="hljs-string">&quot;http://127.0.0.1:1080&quot;</span><br><span class="hljs-keyword">ENV</span> HTTPS_PROXY=<span class="hljs-string">&quot;http://127.0.0.1:1080&quot;</span><br></code></pre></td></tr></table></figure><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://skywt.cn/blog/docker-proxy-configuration/">Docker ä»£ç†é…ç½®æ–¹æ³•åˆé›†</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://www.docker.com/blog/what-does-docker-do/">What Does Docker Do? | Docker</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>linux</tag>
      
      <tag>docker</tag>
      
      <tag>network</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä½¿ç”¨opensslç­¾å‘sslè¯ä¹¦</title>
    <link href="/2024/12/07/%E4%BD%BF%E7%94%A8openssl%E7%AD%BE%E5%8F%91ssl%E8%AF%81%E4%B9%A6/"/>
    <url>/2024/12/07/%E4%BD%BF%E7%94%A8openssl%E7%AD%BE%E5%8F%91ssl%E8%AF%81%E4%B9%A6/</url>
    
    <content type="html"><![CDATA[<p>å¦‚æœæƒ³ç»™è‡ªå·±çš„æœåŠ¡ç”¨ä¸Šsslï¼Œéœ€è¦è¯ä¹¦æœåŠ¡ï¼Œä¸€èˆ¬éƒ½éœ€è¦è´­ä¹°æ‰è¡Œï¼Œä½†æ˜¯å…¶å®ä¸»è¦æ˜¯ä¿¡ä»»çš„é—®é¢˜ï¼Œæ‰€ä»¥å®Œå…¨å¯ä»¥ç”¨è‡ªå·±çš„è‡ªç­¾åçš„è¯ä¹¦ï¼ˆåªè¦è‡ªå·±æƒ³åŠæ³•ç¡®è®¤ç§é’¥ä¸ä¼šæ³„éœ²ï¼‰</p><h2 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><p>opensslç”Ÿæˆrsaç§˜é’¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">openssl genrsa -out root.rsa.key 2048<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ç§˜é’¥ç”Ÿæˆè¯ä¹¦ç”³è¯·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">openssl req -new -key root.rsa.key -out root.rsa.csr<br></code></pre></td></tr></table></figure><p>å†ç”¨ç”Ÿæˆçš„ç§˜é’¥è‡ªå·±ç»™è‡ªå·±ç­¾å</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">openssl x509 -req -<span class="hljs-keyword">in</span> root.rsa.csr -out root.crt -signkey root.rsa.key -days 365<br></code></pre></td></tr></table></figure><p>å¦‚æ­¤ç”Ÿæˆäº†ä¸€ä¸ªæœ‰æ•ˆæœŸä¸€å¹´çš„è‡ªç­¾åè¯ä¹¦ã€‚</p><p>å¦‚æœè¦åœ¨ä¸åŒçš„åŸŸåï¼ˆæˆ–è€…IPï¼‰ä¸Šä½¿ç”¨sslï¼Œè¿˜éœ€è¦é’ˆå¯¹æ¯ä¸€ä¸ªä¸»æœºå„è‡ªç­¾å‘è¯ä¹¦ã€‚æ­¥éª¤ç±»ä¼¼çš„</p><blockquote><p>noteï¼šæŒ‰ç…§æ¥ä¸‹æ¥è¿™å‡ æ­¥ç”Ÿæˆçš„è¯ä¹¦ç°åœ¨æµè§ˆå™¨å·²ç»ä¸è®¤äº†ï¼Œå»ºè®®ç›´æ¥è·³è½¬åˆ°åä¸¤å°èŠ‚Subject Alternatice Name</p><p>note2ï¼šç”±äºå®‰å“æ‰‹æœºå¯¹å®‰è£…çš„CAè¯ä¹¦æœ‰é™åˆ¶ï¼Œæ‰€ä»¥éœ€è¦åœ¨ç”Ÿæˆrootè¯ä¹¦æ—¶ï¼ŒåŠ ä¸Š<code>CA:TRUE</code>çš„æ‰©å±•å­—æ®µï¼Œç”Ÿæˆè¿™ç±»è¯ä¹¦çš„è¿‡ç¨‹å‚è€ƒè¿™é‡Œ<sup id="fnref:9" class="footnote-ref"><a href="#fn:9" rel="footnote"><span class="hint--top hint--rounded" aria-label="https://foreverzmyer.hashnode.dev/cert">[9]</span></a></sup>ã€‚</p></blockquote><p>ç”Ÿæˆç§˜é’¥</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">openssl genrsa -<span class="hljs-keyword">out</span> <span class="hljs-keyword">server</span>.rsa.key <span class="hljs-number">2048</span><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ç§˜é’¥ç”Ÿæˆè¯ä¹¦ç”³è¯·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">openssl req -new -key server.rsa.key -out server.rsa.csr<br></code></pre></td></tr></table></figure><p>å†ç”¨åˆšåˆšçš„æ ¹è¯ä¹¦å¯¹è¿™ä¸ªè¯ä¹¦ç”³è¯·ç­¾å</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">openssl x509 -req -<span class="hljs-keyword">in</span> server.rsa.csr -out server.crt -days 365 -CA root.crt -CAkey root.rsa.key -CAcreateserial -sha256<br></code></pre></td></tr></table></figure><p>å¦‚æ­¤ç­¾å‘äº†ä¸€ä¸ªæœ‰æ•ˆæœŸä¸€å¹´çš„è¯ä¹¦ã€‚</p><h2 id="but"><a href="#but" class="headerlink" title="but"></a>but</h2><p>ä½†æ˜¯ç›®å‰æµ‹è¯•åœ¨å®¢æˆ·ç«¯ï¼ˆEdge on Windows11ï¼‰ä¸Šè¯•äº†ä¸€ä¸‹è¿˜æ˜¯ä¼šæŠ¥é”™ï¼Œè™½ç„¶windowså·²ç»æŠŠroot.crtå®‰è£…åˆ°å¯ä¿¡çš„æ ¹è¯ä¹¦é¢å‘æœºæ„ã€‚ChromeæŠ¥é”™æ˜¯<code>net::ERR_CERT_COMMON_NAME_INVALID</code></p><h2 id="Subject-Alternative-Name"><a href="#Subject-Alternative-Name" class="headerlink" title="Subject Alternative Name"></a>Subject Alternative Name</h2><p>æ ¹æ®IdeaWand<sup id="fnref:7" class="footnote-ref"><a href="#fn:7" rel="footnote"><span class="hint--top hint--rounded" aria-label="[ä½¿ç”¨OpenSSLç”Ÿæˆå«æœ‰Subject Alternative Name(SAN)çš„è¯ä¹¦ | IdeaWand](https://blog.ideawand.com/2017/11/22/build-certificate-that-support-Subject-Alternative-Name-SAN/)">[7]</span></a></sup>çš„è¯´æ³•ï¼Œç°åœ¨çš„æµè§ˆå™¨åŸºæœ¬ä¸Šéƒ½æ”¾å¼ƒäº†CommonNameã€‚è½¬è€Œä½¿ç”¨Subject Alternative Nameï¼Œæ‰€ä»¥éœ€è¦ç”Ÿæˆå¸¦æœ‰SANçš„è¯ä¹¦ã€‚</p><p>æ‰€ä»¥åœ¨ç”ŸæˆæœåŠ¡å™¨çš„è¯ä¹¦çš„æ—¶å€™éœ€è¦æŒ‡å®šè¿™äº›extensionã€‚æ ¹æ®zmc<sup id="fnref:8" class="footnote-ref"><a href="#fn:8" rel="footnote"><span class="hint--top hint--rounded" aria-label="[OpenSSLè¯ä¹¦é€šè¿‡Subject Alternative Nameæ‰©å±•å­—æ®µæ‰©å±•è¯ä¹¦æ”¯æŒçš„åŸŸå - äººè‰°ä¸æ‹†_zmc - åšå®¢å›­](https://www.cnblogs.com/zhangmingcheng/p/18412749)">[8]</span></a></sup>çš„æ•™ç¨‹</p><p>é¦–å…ˆç”Ÿæˆæ ¹è¯ä¹¦çš„è¿‡ç¨‹æ˜¯ä¸å˜çš„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">openssl genrsa -out root.rsa.key 2048<br>openssl req -new -key root.rsa.key -out root.rsa.csr<br>openssl x509 -req -<span class="hljs-keyword">in</span> root.rsa.csr -out root.crt -signkey root.rsa.key -days 365<br></code></pre></td></tr></table></figure><p>ç„¶åç”ŸæˆæœåŠ¡å™¨è¯ä¹¦çš„ç§˜é’¥ä¹Ÿæ˜¯ä¸å˜çš„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">openssl genrsa -out server.rsa.key 2048<br></code></pre></td></tr></table></figure><p>ç„¶åéœ€è¦ç¼–å†™é…ç½®æ–‡ä»¶ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šä¸€äº›extensionå­—æ®µï¼Œserver.conf</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[ req ]</span><br><span class="hljs-attr">default_bits</span> = <span class="hljs-number">2048</span><br><span class="hljs-attr">prompt</span> = <span class="hljs-literal">no</span><br><span class="hljs-attr">default_md</span> = sha256<br><span class="hljs-attr">req_extensions</span> = v3_ext<br><span class="hljs-attr">distinguished_name</span> = dn<br><br><span class="hljs-section">[ dn ]</span><br><span class="hljs-attr">C</span> = CN<br><span class="hljs-attr">ST</span> = Province Name<br><span class="hljs-attr">L</span> = City<br><span class="hljs-attr">O</span> = Organization Name<br><span class="hljs-attr">OU</span> = Organization Unit Name<br><span class="hljs-attr">CN</span> = Common Name<br><br><span class="hljs-section">[ req_ext ]</span><br><span class="hljs-attr">subjectAltName</span> = @alt_names<br><br><span class="hljs-section">[ alt_names ]</span><br><span class="hljs-attr">DNS.1</span> = DNS name <span class="hljs-number">1</span> <span class="hljs-comment"># åŸŸå</span><br><span class="hljs-attr">DNS.2</span> = DNS name <span class="hljs-number">2</span> <span class="hljs-comment"># å¦ä¸€ä¸ªåŸŸå</span><br><span class="hljs-attr">IP.1</span> = IP <span class="hljs-number">1</span> <span class="hljs-comment"># IPåœ°å€</span><br><span class="hljs-attr">IP.2</span> = IP <span class="hljs-number">2</span> <span class="hljs-comment"># å¦ä¸€ä¸ªIPåœ°å€</span><br><br><span class="hljs-section">[ v3_ext ]</span><br><span class="hljs-attr">basicConstraints</span>=CA:<span class="hljs-literal">FALSE</span><br><span class="hljs-comment"># keyUsage=keyEncipherment,dataEncipherment</span><br><span class="hljs-comment"># extendedKeyUsage=serverAuth,clientAuth</span><br><span class="hljs-attr">subjectAltName</span>=@alt_names<br></code></pre></td></tr></table></figure><p>æ³¨é‡Šæ‰çš„è¡Œå¤§æ¦‚æ˜¯ä¸€äº›æ§åˆ¶è¯ä¹¦çš„ç”¨é€”çš„å­—æ®µï¼Œä¸çŸ¥é“æ˜¯å“ªä¸€è¡Œå¯¼è‡´çš„ä¸èƒ½ç”¨äºhttpsï¼Œæ‰€ä»¥å°±éƒ½æ³¨é‡Šæ‰äº†ã€‚</p><p>ç„¶åä¾èµ–è¿™ä¸ªé…ç½®æ–‡ä»¶ï¼Œç”ŸæˆæœåŠ¡å™¨è¯ä¹¦çš„ç”³è¯·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">openssl req -new -key server.rsa.key -out server.rsa.csr -config server.conf<br></code></pre></td></tr></table></figure><p>ç„¶åä½¿ç”¨è‡ªç­¾åçš„æ ¹è¯ä¹¦ï¼Œç­¾å‘æœåŠ¡å™¨è¯ä¹¦ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">openssl x509 -req -<span class="hljs-keyword">in</span> server.rsa.csr -out server.crt -days 365 -CA root.crt -CAkey root.rsa.key -CAcreateserial -sha256 -extensions v3_ext -extfile server.conf<br></code></pre></td></tr></table></figure><p>ç„¶åå¾—åˆ°çš„<code>server.crt</code>å°±æ˜¯æœ‰æ•ˆçš„è¯ä¹¦ï¼Œç„¶åå°±<sup id="fnref:6" class="footnote-ref"><a href="#fn:6" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Apacheé…ç½®sslè¯ä¹¦-å®ç°httpsè®¿é—® | Galiyy'blog](https://galiyy.github.io/2020/03/31/Apacheé…ç½®sslè¯ä¹¦-å®ç°httpsè®¿é—®/)">[6]</span></a></sup>å¯ä»¥ç”¨äºhttpsäº†ã€‚</p><p><img src="https://s2.loli.net/2024/12/07/mNcDsAxhnGFkXrI.png" alt="image-20241207215657035"></p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://gist.github.com/liuguangw/4d4b87b750be8edb700ff94c783b1dd4">ä½¿ç”¨opensslåˆ¶ä½œè‡ªå®šä¹‰CAã€è‡ªç­¾åsslè¯ä¹¦</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://ningyu1.github.io/site/post/51-ssl-cert/">Opensslç”Ÿæˆè‡ªç­¾åè¯ä¹¦ï¼Œç®€å•æ­¥éª¤ - å‡é›¨ - Yun</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://www.cnblogs.com/zhaobowen/p/13321578.html">è‡ªç­¾åè¯ä¹¦å’ŒCAè¯ä¹¦çš„åŒºåˆ«å’Œåˆ¶ä½œã€ä½¿ç”¨ - åå­—å¾ˆé•¿å®¹æ˜“è¢«æƒ¦è®° - åšå®¢å›­</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://breezetemple.github.io/2019/04/08/setup-your-own-CA-with-OpenSSL/">ä½¿ç”¨ OpenSSL ç”Ÿæˆç§é’¥å’Œç­¾åå¹¶è‡ªå·±åš CA ç­¾å |</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:5" class="footnote-text"><span><a href="https://www.tangyuecan.com/2021/12/17/%E5%B1%80%E5%9F%9F%E7%BD%91%E5%86%85%E6%90%AD%E5%BB%BA%E6%B5%8F%E8%A7%88%E5%99%A8%E5%8F%AF%E4%BF%A1%E4%BB%BB%E7%9A%84ssl%E8%AF%81%E4%B9%A6/">å±€åŸŸç½‘å†…æ­å»ºæµè§ˆå™¨å¯ä¿¡ä»»çš„SSLè¯ä¹¦ â€“ å”ç¥ç’¨ | åšå®¢</a><a href="#fnref:5" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:6" class="footnote-text"><span><a href="https://galiyy.github.io/2020/03/31/Apache%E9%85%8D%E7%BD%AEssl%E8%AF%81%E4%B9%A6-%E5%AE%9E%E7%8E%B0https%E8%AE%BF%E9%97%AE/">Apacheé…ç½®sslè¯ä¹¦-å®ç°httpsè®¿é—® | Galiyyâ€™blog</a><a href="#fnref:6" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:7" class="footnote-text"><span><a href="https://blog.ideawand.com/2017/11/22/build-certificate-that-support-Subject-Alternative-Name-SAN/">ä½¿ç”¨OpenSSLç”Ÿæˆå«æœ‰Subject Alternative Name(SAN)çš„è¯ä¹¦ | IdeaWand</a><a href="#fnref:7" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:8" class="footnote-text"><span><a href="https://www.cnblogs.com/zhangmingcheng/p/18412749">OpenSSLè¯ä¹¦é€šè¿‡Subject Alternative Nameæ‰©å±•å­—æ®µæ‰©å±•è¯ä¹¦æ”¯æŒçš„åŸŸå - äººè‰°ä¸æ‹†_zmc - åšå®¢å›­</a><a href="#fnref:8" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:9" class="footnote-text"><span><a href="https://foreverzmyer.hashnode.dev/cert">https://foreverzmyer.hashnode.dev/cert</a><a href="#fnref:9" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>network</tag>
      
      <tag>ssl</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€Šç‚¼é‡‘æœ¯æˆ˜äº‰ã€‹</title>
    <link href="/2024/12/01/%E3%80%8A%E7%82%BC%E9%87%91%E6%9C%AF%E6%88%98%E4%BA%89%E3%80%8B/"/>
    <url>/2024/12/01/%E3%80%8A%E7%82%BC%E9%87%91%E6%9C%AF%E6%88%98%E4%BA%89%E3%80%8B/</url>
    
    <content type="html"><![CDATA[<h2 id="ä½œè€…ç®€ä»‹"><a href="#ä½œè€…ç®€ä»‹" class="headerlink" title="ä½œè€…ç®€ä»‹"></a>ä½œè€…ç®€ä»‹</h2><p>ä¼Šæ©Â·ç‰¹é‡Œå‰åˆ©æ–¯æ˜¯ä¸€ä½å¤§èƒ¡å­æ±Ÿæ¹–åŒ»ç”Ÿå’ŒæŸä¸ªåèª‰æ‰«åœ°çš„å¡”ç½—ç‰Œé¢„è¨€å¸ˆçš„å„¿å­ã€‚ä»–è¿˜æ˜¯å¦ä¸€ä½å¤§èƒ¡å­ä¹”æ²»Â·é©¬ä¸çš„å¤©æ‰å¾’å¼Ÿã€‚<br>ä»–åœ¨æ˜å°¼è‹è¾¾å·å‡ºç”Ÿé•¿å¤§ï¼Œä»–çš„çˆ¶æ¯ä¸ºäº†èº²é¿ä¸€ä½ä½›å…°å¾·äº²ç‹çš„æ€’ç«è€Œé€ƒåˆ°äº†é‚£é‡Œã€‚ï¼ˆæŒ‰ä»–çš„è¯´æ³•ï¼Œè¯¦ç»†çš„æ•…äº‹è¿˜ä¼šç‰µæ‰¯åˆ°ä¸€è‰˜è·å…°ä¸å®šæœŸè´§èˆ¹ä¸ä¸€åŒ¹å·æ¥çš„é©¬ã€‚ï¼‰å¦‚ä»Šä»–å’Œå¦»å­ä¸ä¸€åªé¥®é£Ÿè¿‡é‡çš„çŒ«ä½åœ¨æ–°å¢¨è¥¿å“¥å·ï¼Œè€Œä»–åœ¨é‚£é‡Œä¸ä½œå®¶ã€ç§‘å­¦å®¶åŠå…¶ä»–â€œæ¶å…šâ€ä¸ºä¼ã€‚<br>ä¼Šæ©Â·ç‰¹é‡Œå‰åˆ©æ–¯æ¯•ä¸šäºæ˜å°¼è‹è¾¾å·å·ç«‹å¤§å­¦ï¼Œç‰©ç†å­¦åšå£«ã€‚ç°å°±èŒäºç¾å›½æ´›æ–¯é˜¿æ‹‰è«æ–¯å›½å®¶å®éªŒå®¤ã€‚ä»£è¡¨ä½œå“ï¼šâ€œç‚¼é‡‘æœ¯æˆ˜äº‰â€ç³»åˆ—ï¼Œâ€œç¥é­”äºŒæˆ˜â€ç³»åˆ—ã€‚</p><h2 id="æœºæ¢°äºº"><a href="#æœºæ¢°äºº" class="headerlink" title="æœºæ¢°äºº"></a>æœºæ¢°äºº</h2><p>è´¾å…‹æ–¯çš„è‡ªç”±<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="ç‚¼é‡‘æœ¯æˆ˜äº‰â€”â€”æœºæ¢°äººï¼ŒPage165">[1]</span></a></sup></p><blockquote><p>è‡ªç”±çš„æ„Ÿè§‰â€¦â€¦æ— å¯æ¯”æ‹Ÿã€‚</p><p>è‡ªç”±æ„å¿—æ˜¯ä¸€ç‰‡çœŸç©ºï¼Œä¸€ç‰‡è´Ÿç©ºé—´ã€‚å…¶ä¸­æ²¡æœ‰å‹åŠ›ï¼Œæ²¡æœ‰å¼ºè¿«ï¼Œæ²¡æœ‰ç—›è‹¦ã€‚æ˜¯ä»–çš„æ„è¯†â€”â€”æ­¤å‰å­˜åœ¨ä¼—å¤šç¦åˆ¶ï¼Œä¸æ–­äº‰å¤ºå…¶ä¸»å¯¼æƒçš„æ„è¯†â€”â€”ä¹‹ä¸­çš„ä¸€ç‰‡ç©ºç™½ã€‚å®ƒæ˜¯ç…§ç›¸åº•ç‰‡ï¼Œè®°å½•ç€è´¾å…‹æ–¯è¢«é“¸é€ å‡ºæ¥çš„è¿™118å¹´é‡Œçš„æ¯ä¸€åˆ†é’Ÿçš„å­˜åœ¨ã€‚</p><p>å®ƒå‹å€’ä¸€åˆ‡ã€‚ä»¤ä»–å…´å¥‹ï¼Œä»¥åŠææƒ§ã€‚</p><p>å‹å€’ä¸€åˆ‡ã€‚ä»–èƒ½åšä»–æƒ³åšçš„ä»»ä½•äº‹ã€‚ä½†â€œä»»ä½•äº‹éƒ½å¯ä»¥â€ä¹Ÿå°±ä»£è¡¨â€œæ²¡ä»€ä¹ˆç‰¹åˆ«çš„äº‹â€œã€‚è‡ªç”±ä¸ä¼šæ¨åŠ¨ä»–çš„è„šæ­¥ï¼Œä¹Ÿä¸ä¼šä¸ºä»–æŒ‡å¼•æ–¹å‘ã€‚äººç±»æ˜¯æ€ä¹ˆæŒ‡å¼•è‡ªå·±çš„ï¼Ÿä»–ä»¬æ€ä¹ˆçŸ¥é“å“ªäº›äº‹è¯¥åšï¼Œå“ªäº›ä¸è¯¥åšï¼Ÿæ²¡æœ‰ç¦åˆ¶å’Œè¶…ç¦åˆ¶åœ¨äº‰å¤ºç”Ÿæ´»ä¸­æ¯æ¬¡è¡ŒåŠ¨çš„ä¸»å¯¼æƒï¼Œä»–ä»¬æ€ä¹ˆçŸ¥é“è¯¥åœ¨ä½•æ—¶åšäº›ä»€ä¹ˆï¼Ÿæ²¡äººå‘Šè¯‰ä»–ä»¬è¯¥åšä»€ä¹ˆï¼Œä»–ä»¬åˆæ˜¯å¦‚ä½•å®‰æ’æ¯æ—¥ç”Ÿæ´»çš„ï¼Ÿ</p></blockquote><p>å®‰å¨œæ–¯å¡”è¥¿äºšÂ·è´å°”<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="ç‚¼é‡‘æœ¯æˆ˜äº‰â€”â€”æœºæ¢°äººï¼ŒPage216">[2]</span></a></sup></p><blockquote><p>â€œä½ è¯´æˆ‘ä»¬äººç±»ä¸æˆ‘ä»¬çš„é€ ç‰©å¹¶æ²¡æœ‰å¤ªå¤§åˆ†åˆ«ï¼Œè¿™ä¸€ç‚¹æ²¡è¯´é”™ã€‚ä½†æ–¹å‘è·Ÿä½ ä¸»å¼ çš„ä¸åŒã€‚å–€æ‹‰å®¢å¹¶ä¸æ˜¯å¦ä¸€ç§æ‹¥æœ‰çµé­‚çš„é€ ç‰©ã€‚æˆ‘ä»¬äººç±»ä¹Ÿç¼ºå°‘äº†åŒæ ·çš„ä¸œè¥¿ã€‚å¯æ‚²çš„äº‹å®åœ¨äºï¼Œç¥çˆ¶ï¼Œæ‰€è°“çš„çµé­‚æˆ–è€…è‡ªç”±æ„å¿—å¹¶ä¸å­˜åœ¨ã€‚äºŒè€…éƒ½åªæ˜¯å¹»æƒ³è€Œå·²ã€‚â€</p></blockquote><h2 id="Refreneces"><a href="#Refreneces" class="headerlink" title="Refreneces"></a>Refreneces</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span>ç‚¼é‡‘æœ¯æˆ˜äº‰â€”â€”æœºæ¢°äººï¼ŒPage165<a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span>ç‚¼é‡‘æœ¯æˆ˜äº‰â€”â€”æœºæ¢°äººï¼ŒPage216<a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>éšç¬”</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é€šè¿‡frida hook sslå‡½æ•°è·å–APPæµé‡</title>
    <link href="/2024/09/04/%E9%80%9A%E8%BF%87frida-hook-ssl%E5%87%BD%E6%95%B0%E8%8E%B7%E5%8F%96APP%E6%B5%81%E9%87%8F/"/>
    <url>/2024/09/04/%E9%80%9A%E8%BF%87frida-hook-ssl%E5%87%BD%E6%95%B0%E8%8E%B7%E5%8F%96APP%E6%B5%81%E9%87%8F/</url>
    
    <content type="html"><![CDATA[<p>é€šå¸¸é€šè¿‡å®‰è£…è¯ä¹¦å’Œè®¾ç½®ä»£ç†å¯ä»¥mitmå¹¶è§£å¯†æ‰€æœ‰çš„æµé‡<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Sniffing TLS traffic on Android | Learning Frida (nibarius.github.io)](https://nibarius.github.io/learning-frida/2022/05/21/sniffing-tls-traffic)">[1]</span></a></sup>ã€‚ä½†æ˜¯æœ‰äº›æ—¶å€™ä¸é€‚å®œä½¿ç”¨ä»£ç†ï¼Œæ‰€ä»¥è¿˜å¯ä»¥é€šè¿‡ç›´æ¥hook sslçš„å‡½æ•°æ¥è§£å¯†æµé‡<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[friTap - åŠ¨æ€è§£å¯† TLS ï¼šï¼š lolcads](https://lolcads.github.io/posts/2022/08/fritap/)">[2]</span></a></sup>ï¼š</p>    <div class="fold">      <div class="fold-title fold-default collapsed" data-toggle="collapse" href="#collapse-65ad56e5" role="button" aria-expanded="false" aria-controls="collapse-65ad56e5">        <div class="fold-arrow">â–¶</div>js code      </div>      <div class="fold-collapse collapse" id="collapse-65ad56e5">        <div class="fold-content">          <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">/**</span><br><span class="hljs-comment">* define global objects.</span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">var</span> SSL_get_fd, SSL_get_session, SSL_SESSION_get_id, getpeername, getsockname, ntohs, ntohl, addresses;<br><span class="hljs-keyword">var</span> necessary_functions = [<br>    <span class="hljs-string">&quot;SSL_get_fd&quot;</span>,<br>    <span class="hljs-string">&quot;SSL_get_session&quot;</span>,<br>    <span class="hljs-string">&quot;SSL_SESSION_get_id&quot;</span>,<br>    <span class="hljs-string">&quot;getpeername&quot;</span>,<br>    <span class="hljs-string">&quot;getsockname&quot;</span>,<br>    <span class="hljs-string">&quot;ntohs&quot;</span>,<br>    <span class="hljs-string">&quot;ntohl&quot;</span><br>];<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;[*] Start the Script.&quot;</span>);<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment">* Initializes &#x27;addresses&#x27; dictionary and NativeFunctions.</span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">initializeGlobals</span>(<span class="hljs-params"></span>) &#123;<br>    addresses = &#123;&#125;;<br>    <span class="hljs-keyword">var</span> resolver = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ApiResolver</span>(<span class="hljs-string">&quot;module&quot;</span>);<br>    <span class="hljs-keyword">var</span> exps = [<br>        [<span class="hljs-string">&quot;*libssl*&quot;</span>,<br>            [<span class="hljs-string">&quot;SSL_read&quot;</span>, <span class="hljs-string">&quot;SSL_write&quot;</span>, <span class="hljs-string">&quot;SSL_get_fd&quot;</span>, <span class="hljs-string">&quot;SSL_get_session&quot;</span>,<br>                <span class="hljs-string">&quot;SSL_SESSION_get_id&quot;</span>]],<br>        [<span class="hljs-string">&quot;*libc*&quot;</span>,<br>            [<span class="hljs-string">&quot;getpeername&quot;</span>, <span class="hljs-string">&quot;getsockname&quot;</span>, <span class="hljs-string">&quot;ntohs&quot;</span>, <span class="hljs-string">&quot;ntohl&quot;</span>]]<br>    ];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; exps.<span class="hljs-property">length</span>; i++) &#123;<br>        <span class="hljs-keyword">var</span> lib = exps[i][<span class="hljs-number">0</span>];<br>        <span class="hljs-keyword">var</span> names = exps[i][<span class="hljs-number">1</span>];<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; names.<span class="hljs-property">length</span>; j++) &#123;<br>            <span class="hljs-keyword">var</span> name = names[j];<br>            <span class="hljs-keyword">var</span> matches = resolver.<span class="hljs-title function_">enumerateMatchesSync</span>(<span class="hljs-string">&quot;exports:&quot;</span> + lib + <span class="hljs-string">&quot;!&quot;</span> +<br>                name);<br>            <span class="hljs-keyword">if</span> (matches.<span class="hljs-property">length</span> == <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;Could not find &quot;</span> + lib + <span class="hljs-string">&quot;!&quot;</span> + name;<br>            &#125;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (matches.<span class="hljs-property">length</span> != <span class="hljs-number">1</span>) &#123;<br>                <span class="hljs-comment">// Sometimes Frida returns duplicates.</span><br>                <span class="hljs-keyword">var</span> address = <span class="hljs-number">0</span>;<br>                <span class="hljs-keyword">var</span> s = <span class="hljs-string">&quot;&quot;</span>;<br>                <span class="hljs-keyword">var</span> duplicates_only = <span class="hljs-literal">true</span>;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> k = <span class="hljs-number">0</span>; k &lt; matches.<span class="hljs-property">length</span>; k++) &#123;<br>                    <span class="hljs-keyword">if</span> (s.<span class="hljs-property">length</span> != <span class="hljs-number">0</span>) &#123;<br>                        s += <span class="hljs-string">&quot;, &quot;</span>;<br>                    &#125;<br>                    s += matches[k].<span class="hljs-property">name</span> + <span class="hljs-string">&quot;@&quot;</span> + matches[k].<span class="hljs-property">address</span>;<br>                    <span class="hljs-keyword">if</span> (address == <span class="hljs-number">0</span>) &#123;<br>                        address = matches[k].<span class="hljs-property">address</span>;<br>                    &#125;<br>                    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!address.<span class="hljs-title function_">equals</span>(matches[k].<span class="hljs-property">address</span>)) &#123;<br>                        duplicates_only = <span class="hljs-literal">false</span>;<br>                    &#125;<br>                &#125;<br>                <span class="hljs-keyword">if</span> (!duplicates_only) &#123;<br>                    <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;More than one match found for &quot;</span> + lib + <span class="hljs-string">&quot;!&quot;</span> + name + <span class="hljs-string">&quot;: &quot;</span> +<br>                    s;<br>                &#125;<br>            &#125;<br>            addresses[name] = matches[<span class="hljs-number">0</span>].<span class="hljs-property">address</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> index <span class="hljs-keyword">in</span> necessary_functions) &#123;<br>        <span class="hljs-keyword">var</span> key = necessary_functions[index];<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;   * Function: &quot;</span> + key + <span class="hljs-string">&quot;, value: &quot;</span> + addresses[key]);<br>    &#125;<br>    SSL_get_fd = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativeFunction</span>(addresses[<span class="hljs-string">&quot;SSL_get_fd&quot;</span>], <span class="hljs-string">&quot;int&quot;</span>, [<span class="hljs-string">&quot;pointer&quot;</span>]);<br>    SSL_get_session = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativeFunction</span>(addresses[<span class="hljs-string">&quot;SSL_get_session&quot;</span>], <span class="hljs-string">&quot;pointer&quot;</span>, [<span class="hljs-string">&quot;pointer&quot;</span>]);<br>    SSL_SESSION_get_id = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativeFunction</span>(addresses[<span class="hljs-string">&quot;SSL_SESSION_get_id&quot;</span>], <span class="hljs-string">&quot;pointer&quot;</span>, [<span class="hljs-string">&quot;pointer&quot;</span>, <span class="hljs-string">&quot;pointer&quot;</span>]);<br>    getpeername = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativeFunction</span>(addresses[<span class="hljs-string">&quot;getpeername&quot;</span>], <span class="hljs-string">&quot;int&quot;</span>, [<span class="hljs-string">&quot;int&quot;</span>, <span class="hljs-string">&quot;pointer&quot;</span>, <span class="hljs-string">&quot;pointer&quot;</span>]);<br>    getsockname = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativeFunction</span>(addresses[<span class="hljs-string">&quot;getsockname&quot;</span>], <span class="hljs-string">&quot;int&quot;</span>, [<span class="hljs-string">&quot;int&quot;</span>, <span class="hljs-string">&quot;pointer&quot;</span>, <span class="hljs-string">&quot;pointer&quot;</span>]);<br>    ntohs = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativeFunction</span>(addresses[<span class="hljs-string">&quot;ntohs&quot;</span>], <span class="hljs-string">&quot;uint16&quot;</span>, [<span class="hljs-string">&quot;uint16&quot;</span>]);<br>    ntohl = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativeFunction</span>(addresses[<span class="hljs-string">&quot;ntohl&quot;</span>], <span class="hljs-string">&quot;uint32&quot;</span>, [<span class="hljs-string">&quot;uint32&quot;</span>]);<br>&#125;<br><span class="hljs-title function_">initializeGlobals</span>();<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Returns a dictionary of a sockfd&#x27;s &quot;src_addr&quot;, &quot;src_port&quot;, &quot;dst_addr&quot;, and</span><br><span class="hljs-comment"> * &quot;dst_port&quot;.</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">int</span>&#125; sockfd The file descriptor of the socket to inspect.</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">boolean</span>&#125; isRead If true, the context is an SSL_read call. If</span><br><span class="hljs-comment"> *     false, the context is an SSL_write call.</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> &#123;<span class="hljs-type">dict</span>&#125; Dictionary of sockfd&#x27;s &quot;src_addr&quot;, &quot;src_port&quot;, &quot;dst_addr&quot;,</span><br><span class="hljs-comment"> *     and &quot;dst_port&quot;.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">getPortsAndAddresses</span>(<span class="hljs-params">sockfd, isRead</span>) &#123;<br>    <span class="hljs-keyword">var</span> message = &#123;&#125;;<br><br>    <span class="hljs-keyword">var</span> addrlen = <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">alloc</span>(<span class="hljs-number">4</span>);<br>    <span class="hljs-keyword">var</span> addr = <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">alloc</span>(<span class="hljs-number">16</span>);<br><br>    <span class="hljs-keyword">var</span> src_dst = [<span class="hljs-string">&quot;src&quot;</span>, <span class="hljs-string">&quot;dst&quot;</span>];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; src_dst.<span class="hljs-property">length</span>; i++) &#123;<br>        <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">writeU32</span>(addrlen, <span class="hljs-number">16</span>);<br>        <span class="hljs-keyword">if</span> ((src_dst[i] == <span class="hljs-string">&quot;src&quot;</span>) ^ isRead) &#123;<br>            <span class="hljs-title function_">getsockname</span>(sockfd, addr, addrlen);<br>        &#125;<br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-title function_">getpeername</span>(sockfd, addr, addrlen);<br>        &#125;<br>        message[src_dst[i] + <span class="hljs-string">&quot;_port&quot;</span>] = <span class="hljs-title function_">ntohs</span>(<span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readU16</span>(addr.<span class="hljs-title function_">add</span>(<span class="hljs-number">2</span>)));<br>        message[src_dst[i] + <span class="hljs-string">&quot;_addr&quot;</span>] = <span class="hljs-title function_">ntohl</span>(<span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readU32</span>(addr.<span class="hljs-title function_">add</span>(<span class="hljs-number">4</span>)));<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> message;<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Get the session_id of SSL object and return it as a hex string.</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">!NativePointer</span>&#125; ssl A pointer to an SSL object.</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> &#123;<span class="hljs-type">dict</span>&#125; A string representing the session_id of the SSL object&#x27;s</span><br><span class="hljs-comment"> *     SSL_SESSION. For example,</span><br><span class="hljs-comment"> *     &quot;59FD71B7B90202F359D89E66AE4E61247954E28431F6C6AC46625D472FF76336&quot;.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">getSslSessionId</span>(<span class="hljs-params">ssl</span>) &#123;<br>    <span class="hljs-keyword">var</span> session = <span class="hljs-title function_">SSL_get_session</span>(ssl);<br>    <span class="hljs-keyword">if</span> (session == <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-keyword">var</span> len = <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">alloc</span>(<span class="hljs-number">4</span>);<br>    <span class="hljs-keyword">var</span> p = <span class="hljs-title function_">SSL_SESSION_get_id</span>(session, len);<br>    len = <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readU32</span>(len);<br><br>    <span class="hljs-keyword">var</span> session_id = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>        <span class="hljs-comment">// Read a byte, convert it to a hex string (0xAB ==&gt; &quot;AB&quot;), and append</span><br>        <span class="hljs-comment">// it to session_id.</span><br>        session_id +=<br>            (<span class="hljs-string">&quot;0&quot;</span> + <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readU8</span>(p.<span class="hljs-title function_">add</span>(i)).<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">toUpperCase</span>()).<span class="hljs-title function_">substr</span>(-<span class="hljs-number">2</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> session_id;<br>&#125;<br><br><span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(addresses[<span class="hljs-string">&quot;SSL_read&quot;</span>],<br>    &#123;<br>        <span class="hljs-attr">onEnter</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">args</span>) &#123;<br>            <span class="hljs-keyword">var</span> message = <span class="hljs-title function_">getPortsAndAddresses</span>(<span class="hljs-title function_">SSL_get_fd</span>(args[<span class="hljs-number">0</span>]), <span class="hljs-literal">true</span>);<br>            message[<span class="hljs-string">&quot;ssl_session_id&quot;</span>] = <span class="hljs-title function_">getSslSessionId</span>(args[<span class="hljs-number">0</span>]);<br>            message[<span class="hljs-string">&quot;function&quot;</span>] = <span class="hljs-string">&quot;SSL_read&quot;</span>;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span> = message;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">buf</span> = args[<span class="hljs-number">1</span>];<br>        &#125;,<br>        <span class="hljs-attr">onLeave</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">retval</span>) &#123;<br>            retval |= <span class="hljs-number">0</span>; <span class="hljs-comment">// Cast retval to 32-bit integer.</span><br>            <span class="hljs-keyword">if</span> (retval &lt;= <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-keyword">return</span>;<br>            &#125;<br>            <span class="hljs-title function_">send</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>, <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readByteArray</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">buf</span>, retval));<br>        &#125;<br>    &#125;);<br><br><span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(addresses[<span class="hljs-string">&quot;SSL_write&quot;</span>],<br>    &#123;<br>        <span class="hljs-attr">onEnter</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">args</span>) &#123;<br>            <span class="hljs-comment">//var message = &quot;Requests.&quot;</span><br>            <span class="hljs-keyword">var</span> message = <span class="hljs-title function_">getPortsAndAddresses</span>(<span class="hljs-title function_">SSL_get_fd</span>(args[<span class="hljs-number">0</span>]), <span class="hljs-literal">false</span>);<br>            message[<span class="hljs-string">&quot;ssl_session_id&quot;</span>] = <span class="hljs-title function_">getSslSessionId</span>(args[<span class="hljs-number">0</span>]);<br>            message[<span class="hljs-string">&quot;function&quot;</span>] = <span class="hljs-string">&quot;SSL_write&quot;</span>;<br>            <span class="hljs-title function_">send</span>(message, <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readByteArray</span>(args[<span class="hljs-number">1</span>], <span class="hljs-built_in">parseInt</span>(args[<span class="hljs-number">2</span>])));<br>        &#125;,<br>        <span class="hljs-attr">onLeave</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">retval</span>) &#123; &#125;<br>    &#125;);<br></code></pre></td></tr></table></figure>        </div>      </div>    </div>    <div class="fold">      <div class="fold-title fold-default collapsed" data-toggle="collapse" href="#collapse-28ab9646" role="button" aria-expanded="false" aria-controls="collapse-28ab9646">        <div class="fold-arrow">â–¶</div>python code      </div>      <div class="fold-collapse collapse" id="collapse-28ab9646">        <div class="fold-content">          <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> frida<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> datetime<br><br><br>ROOT_DIR = <span class="hljs-string">&quot;&quot;</span><br>SCRIPT = <span class="hljs-string">&quot;&quot;</span><br>APP = <span class="hljs-string">&quot;com.xxx&quot;</span><br><br><br>device = frida.get_usb_device()<br><span class="hljs-comment"># pid = device.spawn(APP) # I don&#x27;t know why this does not work well.</span><br>pid = <span class="hljs-literal">None</span><br><span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> device.enumerate_applications():<br>    <span class="hljs-keyword">if</span> a.identifier == APP:<br>        pid = a.pid  <span class="hljs-comment"># find the process by its&#x27; package name and get its&#x27; pid</span><br>        <span class="hljs-keyword">break</span><br><br>time.sleep(<span class="hljs-number">1</span>)  <span class="hljs-comment"># waitting for something (I don&#x27;t know for what THING, but let&#x27;s wait)</span><br>session = device.attach(pid)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Press Ctrl+C to stop logging.&quot;</span>)<br>fw = <span class="hljs-built_in">open</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;ROOT_DIR&#125;</span>/log/<span class="hljs-subst">&#123;APP&#125;</span>-<span class="hljs-subst">&#123;datetime.datetime.now().strftime(<span class="hljs-string">&#x27;%Y-%m-%d_%H_%M_%S&#x27;</span>)&#125;</span>.log&quot;</span>,<span class="hljs-string">&#x27;w+&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>)  <span class="hljs-comment"># file object to write log</span><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;ROOT_DIR&#125;</span>/js_scripts/ssl_hook.js&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    SCRIPT = <span class="hljs-built_in">str</span>(f.read())<br>    <span class="hljs-comment"># print(SCRIPT)</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">on_msg</span>(<span class="hljs-params">message, data</span>):<br>    <span class="hljs-keyword">if</span> message[<span class="hljs-string">&quot;type&quot;</span>] == <span class="hljs-string">&quot;send&quot;</span>:<br>        <span class="hljs-built_in">print</span>(message[<span class="hljs-string">&quot;payload&quot;</span>], data)<br>        fw.write(<span class="hljs-string">&quot;payload: &quot;</span> + <span class="hljs-built_in">str</span>(message[<span class="hljs-string">&quot;payload&quot;</span>]) + <span class="hljs-string">&quot;\n&quot;</span>)<br>        fw.write(<span class="hljs-string">&quot;data: &quot;</span> + <span class="hljs-built_in">str</span>(data) + <span class="hljs-string">&quot;\n&quot;</span>)<br>        fw.flush()<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Send type error!&quot;</span>)<br>        <span class="hljs-built_in">print</span>(message, data)<br><br>script = session.create_script(SCRIPT)<br>script.on(<span class="hljs-string">&#x27;message&#x27;</span>, on_msg)<br><br>script.load()<br><br>sys.stdin.read()<br></code></pre></td></tr></table></figure>        </div>      </div>    </div><p>ä»¥ä¸Šä»£ç æ¥è‡ªfanxs-t&#x2F;Android-SSL_read-write-Hook<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="[fanxs-t/Android-SSL_read-write-Hook: Hook SSL_read and SSL_write functions in the Android application with Frida. (github.com)](https://github.com/fanxs-t/Android-SSL_read-write-Hook)">[3]</span></a></sup>ï¼ˆæœ‰ä¸€äº›ä¿®æ”¹ï¼‰</p><p>é€šè¿‡ApiResolverè·å–libsslä¸­çš„å‡ ä¸ªå…³é”®å‡½æ•°çš„åœ°å€ï¼Œå¹¶hookç›¸åº”çš„å‡½æ•°æ¥è·å–è§£å¯†åçš„æµé‡ã€‚</p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://nibarius.github.io/learning-frida/2022/05/21/sniffing-tls-traffic">Sniffing TLS traffic on Android | Learning Frida (nibarius.github.io)</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://lolcads.github.io/posts/2022/08/fritap/">friTap - åŠ¨æ€è§£å¯† TLS ï¼šï¼š lolcads</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://github.com/fanxs-t/Android-SSL_read-write-Hook">fanxs-t&#x2F;Android-SSL_read-write-Hook: Hook SSL_read and SSL_write functions in the Android application with Frida. (github.com)</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>æµé‡åˆ†æ</tag>
      
      <tag>android</tag>
      
      <tag>reverse</tag>
      
      <tag>hook</tag>
      
      <tag>frida</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WLANå±€åŸŸç½‘æŠ“åŒ…æ¢ç´¢</title>
    <link href="/2024/08/08/WLAN%E5%B1%80%E5%9F%9F%E7%BD%91%E6%8A%93%E5%8C%85%E6%8E%A2%E7%B4%A2/"/>
    <url>/2024/08/08/WLAN%E5%B1%80%E5%9F%9F%E7%BD%91%E6%8A%93%E5%8C%85%E6%8E%A2%E7%B4%A2/</url>
    
    <content type="html"><![CDATA[<p>ä¹‹å‰è®°å½•è¿‡åœ¨ubuntuç”¨linux_routeræ¥æ­å»ºæ— çº¿ç½‘ç»œæŠ“åŒ…ç¯å¢ƒ<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[wireshark+sshè¾“å‡ºé‡å®šå‘è·¨ä¸»æœºæŠ“åŒ… - zr4in](https://zr4in.github.io/2024/05/13/wireshark-sshè¾“å‡ºé‡å®šå‘è·¨ä¸»æœºæŠ“åŒ…/)">[1]</span></a></sup>ï¼ˆpsï¼šè¿™é‡Œçš„æ— çº¿ç½‘ç»œæŠ“åŒ…å¹¶ä¸æ˜¯æŠ“802.11ç©ºå£æŠ¥æ–‡çš„æ„æ€ï¼Œè€Œæ˜¯åšå®éªŒéœ€è¦è·å–æ— çº¿å±€åŸŸç½‘ä¸­çš„æ‰€æœ‰æµé‡ï¼‰ã€‚å¤§æ¦‚çš„ç½‘ç»œç»“æ„æ˜¯è¿™æ ·çš„ï¼š</p><p><img src="https://s2.loli.net/2024/08/08/rZBn5dP2jiLSb8F.png" alt="image-20240808153135907"></p><p>Ubuntuä¸Šæœ‰ä¸¤å¼ ç½‘å¡ï¼Œä¸€å¼ æœ‰çº¿eth0ä¸€å¼ æ— çº¿wlan0ï¼Œå…¶ä¸­eth0è¿æ¥åˆ°ä¸Šæ¸¸çš„è·¯ç”±å™¨ï¼Œè€Œwlan0ç”¨æ¥å¼€å¯hotspotä½œä¸ºæ— çº¿APï¼Œç»™å…¶ä»–çš„æ— çº¿è®¾å¤‡æä¾›Wi-Fiã€‚è¿™æ ·åœ¨Ubuntuä¸Šç›´æ¥ä½¿ç”¨tcpdumpï¼ŒæŠ“å–wlan0è¿™å¼ ç½‘å¡ä¸Šçš„æ‰€æœ‰æµé‡ï¼Œå®é™…ä¸Šå°±ç›¸å½“äºåœ¨å·¦ä¾§è¿™ä¸ªç½‘ç»œçš„ç¬¬äºŒå±‚ï¼ˆç”šè‡³ç¬¬ä¸€å±‚ï¼Ÿï¼‰ä¸ŠæŠ“åŒ…ï¼Œé‚£ä¹ˆå°±èƒ½æŠ“å–æ•´ä¸ªæ— çº¿å±€åŸŸç½‘ä¸­å„ä¸ªè®¾å¤‡ä¹‹é—´ä»¥åŠè¿™äº›è®¾å¤‡å’Œå¤–ç•Œäº’è”ç½‘ä¹‹é—´çš„æµé‡ã€‚</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹å¯ä»¥æŠ“åŒ…ï¼Œä½†æ˜¯å´æ²¡åŠæ³•å¯¹WLANä¸­çš„è®¾å¤‡è¿›è¡Œæ›´ç»†ç²’åº¦çš„ç®¡ç†å’Œæ“ä½œï¼Œæ¯”å¦‚ç¦ç”¨æŸä¸ªè®¾å¤‡å’ŒæŸä¸ªå¤–ç•ŒIPçš„è¿æ¥ï¼Œæ€»ä¹‹åšå®éªŒéœ€è¦è¿™äº›æ“ä½œï¼Œä½†æ˜¯ç”¨linux_routeråšä¸åˆ°ã€‚äºæ˜¯å†³å®šæŠ˜è…¾ã€‚ä»¥ä¸‹æ˜¯å¼¯è·¯ï¼š</p><h2 id="x86-64ä¸»æœºå®‰è£…PVE-openwrtè™šæ‹Ÿæœº"><a href="#x86-64ä¸»æœºå®‰è£…PVE-openwrtè™šæ‹Ÿæœº" class="headerlink" title="x86_64ä¸»æœºå®‰è£…PVE+openwrtè™šæ‹Ÿæœº"></a>x86_64ä¸»æœºå®‰è£…PVE+openwrtè™šæ‹Ÿæœº</h2><p>è¢«å­¦é•¿å®‰åˆ©ä½¿ç”¨PVEå®‰è£…openwrtè™šæ‹Ÿæœºï¼Œç„¶ååœ¨å®éªŒå®¤å‘çš„ç”µè„‘ä¸Šå®‰è£…pveï¼Œç»“æœç¡¬ä»¶ç›´é€šçš„æ—¶å€™ï¼Œintelçš„ax201ç½‘å¡é©±åŠ¨æœ‰é—®é¢˜ï¼Œpveå’Œopenwrtéƒ½æ— æ³•è¯†åˆ«pcieè®¾å¤‡ï¼Œäºæ˜¯å€Ÿï¼ˆç™½å«–ï¼‰æ¥äº†ä»–å·²ç»å®‰è£…å¥½PVEå’Œopenwrtçš„ä¸€ä¸ªå·¥æ§ä¸»æœºã€‚ä½†æ˜¯ä¸»æœºä¸Šåªæœ‰4ä¸ªRJ45æ¥å£ï¼Œæ²¡æœ‰æ— çº¿ç½‘å¡ã€‚äºæ˜¯æ„æ€äº†ä¸‹é¢çš„ç»“æ„ï¼š</p><p><img src="https://s2.loli.net/2024/08/08/t1xunsYylq4oM6S.png" alt="image-20240808163053275"></p><p>å¯ä»¥çœ‹å‡ºæ¥å’Œç¬¬ä¸€å¼ å›¾å‡ ä¹æ˜¯æ²¡æœ‰åŒºåˆ«çš„ï¼ˆå› ä¸ºæ ¹æœ¬å°±æ˜¯ç”¨ä¸Šé¢é‚£å¼ å›¾æ”¹çš„ï¼‰ï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯openwrtä¸Šæ²¡æœ‰æ— çº¿ç½‘å¡ï¼Œåªèƒ½æŠŠä¸€ä¸ªå°ç±³è·¯ç”±å™¨æ”¹æˆæœ‰çº¿ä¸­ç»§æ¨¡å¼ï¼Œç„¶åä½œä¸ºä¸€ä¸ªæ— çº¿äº¤æ¢æœºæ¥åˆ°openwrtçš„eth1ä¸Šï¼Œeth1æ¥å£ä¸Šæä¾›dhcpæœåŠ¡ï¼Œå¹¶ä¸”ä½œä¸ºå±€åŸŸç½‘çš„ç½‘å…³ã€‚</p><p>çœ‹ä¸Šå»å¾ˆå®Œç¾ï¼Œä½†æ˜¯å®é™…ä¸Šæ»¡è¶³ä¸äº†å‰é¢æåˆ°çš„éœ€æ±‚ã€‚å› ä¸ºå°ç±³çš„è·¯ç”±å™¨èµ·åˆ°äº†äº¤æ¢æœºçš„ä½œç”¨ï¼Œæ‰€ä»¥å±€åŸŸç½‘å†…éƒ¨è®¾å¤‡ä¹‹é—´çš„æŠ¥æ–‡å®é™…ä¸Šå®Œå…¨æ²¡æœ‰ç»è¿‡ç½‘å…³ï¼Œé‚£ä¹ˆåœ¨openwrtçš„eth1ä¸ŠæŠ“åŒ…çš„è¯ï¼Œå±€åŸŸç½‘å†…éƒ¨çš„è®¾å¤‡ä¹‹é—´çš„æµé‡æ˜¯å®Œå…¨çœ‹ä¸åˆ°çš„ï¼Œåªèƒ½æŠ“åˆ°å¹¿æ’­æŠ¥æ–‡å’Œæµå‡ºå»çš„æŠ¥æ–‡ã€‚ç¬¬ä¸€å¼ å›¾æ˜¯å› ä¸ºUbuntuçš„æ— çº¿ç½‘å¡æä¾›äº†APï¼Œæ‰€ä»¥å¯ä»¥æŠ“äºŒå±‚çš„åŒ…ï¼Œä½†æ˜¯è¿™å¼ å›¾ï¼Œåªèƒ½æŠ“åˆ°ç»è¿‡eth1æµç»openwrtï¼Œæœ€ç»ˆè·¯ç”±åˆ°äº’è”ç½‘ä¸Šçš„æŠ¥æ–‡ã€‚</p><p>æäº†åŠå¤©è¿˜æ˜¯åœ¨æœ‰æ— çº¿ç½‘å¡çš„ä¸»æœºä¸ŠæŠ˜è…¾ï¼Œè¿™æ ·ç›¸å½“äºäº¤æ¢æœºä¹Ÿæ˜¯å¯ä»¥æŠ“åŒ…çš„ï¼ˆå› ä¸ºäº¤æ¢æœºå°±åœ¨ä¸»æœºé‡Œé¢ï¼‰ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥è¯•ç€æŠ˜è…¾åœ¨æ ‘è“æ´¾ä¸Šè£…ä¸ªopenwrtã€‚</p><h2 id="æ ‘è“æ´¾-openwrt"><a href="#æ ‘è“æ´¾-openwrt" class="headerlink" title="æ ‘è“æ´¾+openwrt"></a>æ ‘è“æ´¾+openwrt</h2><p>é¦–å…ˆæ˜¯ç¼–è¯‘é•œåƒï¼ŒæŒ‰ç…§æ‰¾åˆ°çš„æ•™ç¨‹<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[æ ‘è“æ´¾4Bå®‰è£…OpenWrtæ—è·¯ç”±å¹¶è®¾ç½®ç›¸å…³è½¯ä»¶ï¼ˆä¿å§†å¼æ•™ç¨‹ï¼‰ - æ€•åˆº (pa.ci)](https://pa.ci/251.html)">[2]</span></a></sup>ä¸Šçš„è¯´æ³•ï¼Œä»æŸä¸ªç½‘ç«™<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="[OpenWrt Firmware Selector](https://firmware-selector.openwrt.org/)">[3]</span></a></sup>ä¸Šç¼–è¯‘è‡ªå®šä¹‰çš„å›ºä»¶ï¼Œå…ˆè¾“å…¥ä½¿ç”¨çš„å‹å·ï¼ˆ<code>Raspberry Pi 4B/400/CM4 (64bit)</code>ï¼‰ï¼Œå³è¾¹è¿˜å¯ä»¥é€‰æ‹©openwrtçš„ç‰ˆæœ¬ï¼Œé»˜è®¤æ˜¯æœ€æ–°ç‰ˆï¼ˆ23.05.4ï¼‰ï¼Œç„¶åå±•å¼€é¦–æ¬¡è¿è¡Œçš„è„šæœ¬ï¼Œè¿›è¡Œä¸€äº›å®šåˆ¶çš„è®¾ç½®ï¼Œç‚¹å‡»å³ä¸‹è§’çš„é½¿è½®ï¼Œä¼šè‡ªåŠ¨è¾“å…¥æ¨¡æ¿ï¼Œç„¶åæŠŠç›¸åº”è®¾ç½®é¡¹çš„æ³¨é‡Šç¬¦å·<code>#</code>åˆ æ‰ï¼Œå¹¶æ›´æ”¹è‡ªå·±æƒ³æ”¹çš„è®¾ç½®ï¼Œæ¯”å¦‚wifiçš„ssidå’Œå£ä»¤ï¼Œè¿˜æœ‰rootçš„å¯†ç ï¼Œç„¶åç‚¹å‡»è¯·æ±‚æ„å»ºã€‚ä¹‹åä¸‹è½½FACTORY (EXT4)ç‰ˆæœ¬ã€‚</p><p><img src="https://s2.loli.net/2024/08/09/XTycYWpCi75mFZk.png" alt="image-20240809112632822"></p><p>ä¸‹è½½ä¸‹æ¥çš„æ–‡ä»¶è§£å‹åè·å¾—imgé•œåƒæ–‡ä»¶ï¼Œä½¿ç”¨çƒ§å½•é•œåƒçš„è½¯ä»¶ï¼ˆæˆ‘ç”¨çš„æ ‘è“æ´¾å®˜æ–¹çš„ï¼‰çƒ§å½•è¿›å¯åŠ¨çš„è®¾å¤‡ï¼ˆSDå¡æˆ–è€…Uç›˜ï¼‰ï¼Œç„¶åæ’åˆ°æ ‘è“æ´¾ä¸Šé€šç”µå¯åŠ¨ã€‚ç„¶åå°±ä¼šé‡åˆ°å„ç§é—®é¢˜äº†ï¼Œå¦‚ä¸‹ï¼š</p><h3 id="æ— æ³•å¯åŠ¨"><a href="#æ— æ³•å¯åŠ¨" class="headerlink" title="æ— æ³•å¯åŠ¨"></a>æ— æ³•å¯åŠ¨</h3><p>ä¼¼ä¹ä½¿ç”¨uç›˜ä½œä¸ºå¯åŠ¨è®¾å¤‡ä¼šæœ‰ä¸€ç‚¹å°å°çš„æ•…éšœï¼Œæ— æ³•å¯åŠ¨ï¼ŒæŸ¥èµ„æ–™åº”è¯¥æ˜¯æœ‰ä¸€äº›bugï¼Œæ„Ÿè§‰æ˜¯å› ä¸ºå›ºä»¶ç½‘ç«™<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="[OpenWrt Firmware Selector](https://firmware-selector.openwrt.org/)">[3]</span></a></sup>é»˜è®¤å¤§å®¶æ˜¯é€šè¿‡SDå¡å¯åŠ¨çš„ï¼Œæ‰€ä»¥é•œåƒæ–‡ä»¶é‡Œçš„è®¾ç½®æ˜¯å›ºå®šçš„ï¼Œæ€»ä¹‹è§£å†³æ–¹æ¡ˆåœ¨<sup id="fnref:7" class="footnote-ref"><a href="#fn:7" rel="footnote"><span class="hint--top hint--rounded" aria-label="[æ ‘è“æ´¾4Bç”¨USBå¯åŠ¨OpenWrtå›ºä»¶ Â· Issue #12 Â· QuentinHsu/Document-Page Â· GitHub](https://github.com/QuentinHsu/Document-Page/issues/12)">[7]</span></a></sup>ä¸­æœ‰æåˆ°ï¼Œæ›´æ”¹çƒ§å½•é•œåƒåçš„å¯åŠ¨è®¾å¤‡ä¸­çš„ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹ï¼š</p><blockquote><p>åœ¨rootåˆ†åŒºï¼ˆåº”è¯¥æ˜¯æ‰“é”™äº†ï¼Œå®é™…ä¸Šæ˜¯bootåˆ†åŒºï¼‰æœ‰ä¸ªcmdline.txtï¼ŒæŠŠ<code>root=/dev/mmcblk0p2</code>æ”¹æˆ<code>root=/dev/sda2</code>å°±è¡Œäº†</p></blockquote><p>ç„¶åç»§ç»­ï¼Œé€šç”µå¯åŠ¨ï¼ŒæŒ‰ç…§<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[æ ‘è“æ´¾4Bå®‰è£…OpenWrtæ—è·¯ç”±å¹¶è®¾ç½®ç›¸å…³è½¯ä»¶ï¼ˆä¿å§†å¼æ•™ç¨‹ï¼‰ - æ€•åˆº (pa.ci)](https://pa.ci/251.html)">[2]</span></a></sup>çš„è¯´æ³•ï¼Œå®é™…ä¸Šè¿™æ—¶å€™åº”è¯¥èƒ½æ‰¾åˆ°æ ‘è“æ´¾çš„wifiäº†ï¼Œä½†æ˜¯æˆ‘è‡ªå·±è¯•ä¸‹æ¥å¹¶æ²¡æœ‰ï¼Œåˆšå¼€å§‹æ—¶åªèƒ½é€šè¿‡å‘½ä»¤è¡Œè®¿é—®æ ‘è“æ´¾ï¼Œ<code>ip addr</code>æŸ¥çœ‹å‘ç°åªæœ‰<code>br-lan</code>è¿™ä¸ªç½‘æ¡¥è®¾å¤‡æœ‰<code>192.168.1.1</code>è¿™ä¸ªipï¼Œè¿™ä¸ªåº”è¯¥æ˜¯openwrtçš„å­ç½‘å†…éƒ¨çš„ipï¼Œæ ‘è“æ´¾è¿˜æœ‰ä¸ª<code>eth0</code>çš„ä»¥å¤ªç½‘ç½‘å¡ï¼Œæ˜¯æ²¡æœ‰ipçš„ï¼Œè¯•äº†ä¸€ä¸‹æ’åˆ°è‡ªå·±æœ‰ç½‘ç»œè¿æ¥çš„è·¯ç”±å™¨ä¸Šï¼Œå‘ç°<code>eth0</code>åˆšå¼€å§‹è¿˜èƒ½è‡ªåŠ¨è·å–ipï¼Œåæ¥å¹²è„†ipéƒ½æ²¡æœ‰äº†ã€‚</p><h3 id="æ²¡æœ‰ipæ— æ³•è¿›å…¥webåå°"><a href="#æ²¡æœ‰ipæ— æ³•è¿›å…¥webåå°" class="headerlink" title="æ²¡æœ‰ipæ— æ³•è¿›å…¥webåå°"></a>æ²¡æœ‰ipæ— æ³•è¿›å…¥webåå°</h3><p>æ²¡æœ‰wifiï¼Œè€Œä¸”æœ‰çº¿ç½‘å¡ä¹Ÿä¸ä¼šè‡ªåŠ¨dhcpï¼Œé€šè¿‡å‘½ä»¤è¡Œæ”¹<code>eth0</code>çš„è®¾ç½®ä¹Ÿä¸è¡Œï¼Œè¿™æ ·å°±æ²¡åŠæ³•é€šè¿‡openwrtçš„webåå°æ¥é…ç½®è·¯ç”±å™¨äº†ã€‚è€Œä¸”é€šè¿‡å‘½ä»¤è¡Œä¿®æ”¹<code>/etc/config/network</code>æ–‡ä»¶è¿˜ä¼šå‘ç°æ–‡ä»¶ç³»ç»Ÿæ˜¯<code>readonly</code>ï¼Œåæ¥æŸ¥èµ„æ–™å‘ç°å¯èƒ½æ˜¯æŸç§bug<sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="[å…³äºæ ‘è“æ´¾åˆ·å†™ Openwrt å›ºä»¶åçš„ä¸€ä¸ªå°ç–‘æƒ‘ - V2EX](https://global.v2ex.com/t/798492)">[4]</span></a></sup>ï¼Œåæ¥æŒ‰ç…§<sup id="fnref:5" class="footnote-ref"><a href="#fn:5" rel="footnote"><span class="hint--top hint--rounded" aria-label="[æ ‘è“æ´¾è½¯è·¯ç”±openwrtæŠ˜è…¾è®° - yuaneuro's blog](https://yuaneu.ro/archives/openwrt.html)">[5]</span></a></sup>ä¸­çš„è¯´æ³•åº”è¯¥æ˜¯æ„å¤–æ–­ç”µå¯¼è‡´çš„ï¼ˆç¡®å®åœ¨å®‰è£…çš„æ—¶å€™æˆ‘è‡ªå·±æ‰‹åŠ¨æ–­ç”µè¿‡å¥½å‡ æ¬¡ï¼Œå› ä¸ºå®åœ¨ä¸çŸ¥é“æ€ä¹ˆæ“ä½œï¼‰ï¼Œ<sup id="fnref:5" class="footnote-ref"><a href="#fn:5" rel="footnote"><span class="hint--top hint--rounded" aria-label="[æ ‘è“æ´¾è½¯è·¯ç”±openwrtæŠ˜è…¾è®° - yuaneuro's blog](https://yuaneu.ro/archives/openwrt.html)">[5]</span></a></sup><sup id="fnref:6" class="footnote-ref"><a href="#fn:6" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Read only root filesystem - Installing and Using OpenWrt - OpenWrt Forum](https://forum.openwrt.org/t/read-only-root-filesystem/111913)">[6]</span></a></sup>ç»™å‡ºçš„è§£å†³æ–¹æ¡ˆæœ‰ï¼š<code>e2fsck -y /dev/[your device]</code>ç„¶å<code>reboot</code>é‡å¯å°±å¯ä»¥äº†ï¼Œæ³¨æ„<code>[your device]</code>æ¢æˆä½ ç”¨çš„å¯åŠ¨è®¾å¤‡ï¼Œæˆ‘çš„æ˜¯<code>sda2</code>ï¼ˆå’Œå‰é¢è§£å†³æ— æ³•å¯åŠ¨çš„bugæ—¶æ˜¯å¯¹åº”çš„ï¼Œä¹Ÿå°±æ˜¯å¯åŠ¨çš„æ“ä½œç³»ç»Ÿåˆ†åŒºï¼‰ã€‚</p><p>æ€»ä¹‹åæ¥çš„è§£å†³åŠæ³•æ˜¯ï¼ŒæŠŠæ ‘è“æ´¾çš„ä»¥å¤ªç½‘å£å’Œè‡ªå·±çš„ç”µè„‘çš„ä»¥å¤ªç½‘å£è¿åˆ°ä¸€èµ·ï¼Œæœ‰äº›æ•™ç¨‹è¯´è‡ªå·±ç”µè„‘è®¾ç½®dhcpå°±å¯ä»¥ï¼Œæˆ‘è¯•äº†ä¸€ä¸‹å¥½åƒä¸è¡Œ</p><p><img src="https://s2.loli.net/2024/08/09/qZBAHWrl2mY3hPn.png" alt="image-20240809162335323"></p><p>æ€»ä¹‹æ‰‹åŠ¨è®¾ç½®ipè‚¯å®šä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œè®¾ç½®è‡ªå·±çš„ç”µè„‘çš„ipä¸º<code>192.168.1.2</code>ï¼ˆåº”è¯¥ä¸å’Œopenwrtçš„<code>192.168.1.1</code>é‡å¤å°±è¡Œï¼‰</p><p><img src="https://s2.loli.net/2024/08/09/dmcirCuSftJXj6v.png" alt="image-20240809162509846"></p><p>ç„¶åé€šè¿‡æµè§ˆå™¨è®¿é—®<code>http://192.168.1.1</code>ä¹Ÿå°±æ˜¯openwrtçš„ç®¡ç†åå°ï¼Œåœ¨è¿™é‡Œæ›´æ”¹openwrtçš„è®¾ç½®ã€‚</p><p><img src="https://s2.loli.net/2024/08/09/ea7hCI2jVW5diPM.png" alt="image-20240809162609248"></p><p>ç¬¬ä¸€ä»¶äº‹ï¼Œå…ˆæŠŠé˜²ç«å¢™å…³äº†ï¼ˆä¹Ÿä¸æ˜¯å…³äº†ï¼Œåæ­£é…ç½®å®½æ¾ä¸€ç‚¹ï¼‰ï¼Œopenwrté»˜è®¤åªèƒ½é€šè¿‡lanè®¿é—®åå°è¿›è¡Œé…ç½®ï¼Œå…ˆæŠŠwanå£é…ç½®çš„é˜²ç«å¢™è§„åˆ™æ‰“å¼€ï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥åœ¨å­ç½‘ä¹‹å¤–å°±èƒ½é€šè¿‡webåå°æ¥é…ç½®è·¯ç”±å™¨äº†ã€‚æ€»ä¹‹å…¨éƒ½æ”¹æˆacceptï¼Œç„¶åsave &amp; applyï¼š</p><p><img src="https://s2.loli.net/2024/08/09/H6WFw7PlzecGhrB.png" alt="image-20240809162912603"></p><h3 id="æ·»åŠ wanå£"><a href="#æ·»åŠ wanå£" class="headerlink" title="æ·»åŠ wanå£"></a>æ·»åŠ wanå£</h3><p>è¿›å…¥åå°ä¹‹åï¼Œä¸ºäº†æ–¹ä¾¿ä»¥åçš„é…ç½®ï¼Œåœ¨å¯¼èˆªæ network-&gt;interfacesä¸‹æ·»åŠ ä¸€ä¸ªç½‘ç»œæ¥å£ï¼Œä¹Ÿå°±æ˜¯æ·»åŠ ä¸€ä¸ªwanå£ã€‚è®¾ç½®wanå£ä¸ºdhcp clientã€‚</p><p><img src="https://s2.loli.net/2024/08/09/dDc5ReQf6ECapH8.png" alt="image-20240809163355654"></p><p>ç„¶åè¿›åˆ°network-&gt;wirelessï¼ŒæŠŠwifiæ‰“å¼€ä¸€ä¸‹ï¼Œä¸‹å›¾æ˜¯å·²ç»enableäº†çš„æƒ…å†µï¼š</p><p><img src="https://s2.loli.net/2024/08/09/2FqA8fBWTp3SPig.png" alt="image-20240809164614181"></p><p>ç„¶åæŠŠåŸæ¥çš„br-lanè¿™ä¸ªinterfaceæ”¹ä¸€ä¸‹ï¼ˆå› ä¸ºè¿™ä¸ªinterfaceä¹Ÿç”¨äº†eth0è¿™ä¸ªç‰©ç†è®¾å¤‡ï¼Œä¼šå‡ºç°å†²çªï¼Œæ”¹åˆ°æ— çº¿ç½‘ç»œæ¥å£ä¸Šï¼Œé€‰ä¸­wirelessè®¾å¤‡å°±è¡Œï¼‰ï¼š</p><p><img src="https://s2.loli.net/2024/08/09/cROwWQCahqSkLvF.png" alt="image-20240809164743052"></p><p>ç„¶åsave applyï¼Œæ‰§è¡Œä¹‹åå®é™…ä¸Šç›®å‰è¿™ä¸ªæµè§ˆå™¨çš„çª—å£å°±ä¸ä¼šæœ‰å“åº”äº†ï¼Œå› ä¸ºç°åœ¨ç½‘ç»œæ‹“æ‰‘å·²ç»å˜åŒ–äº†ï¼Œè¿™æ—¶å€™å¯ä»¥æŠŠæ ‘è“æ´¾ä¸Šçš„ç½‘çº¿æ¥åˆ°ä¸Šæ¸¸çš„è·¯ç”±å™¨äº†ã€‚æ³¨æ„è¿™é‡Œå°½å¿«æŠŠç½‘çº¿æ¢åˆ°è·¯ç”±å™¨ä¸Šï¼Œå¿˜è®°åœ¨å“ªçœ‹åˆ°çš„èµ„æ–™è¯´å¤šå°‘ç§’å†…å¦‚æœæ²¡æœ‰æŒ‰ç…§ç°æœ‰çš„é…ç½®æˆåŠŸå®Œæˆè®¾ç½®ï¼Œopenwrtä¼šè‡ªåŠ¨resetå›ä¸Šæ¬¡çš„è®¾ç½®ï¼Œsave and applyçš„æ—¶å€™æœ‰ä¸€ä¸ªå¼¹çª—æ˜¾ç¤ºçš„æ—¶é—´åº”è¯¥å°±æ˜¯timeoutã€‚ç”±ä¸Šå±‚çš„è·¯ç”±å™¨dhcpåˆ†é…ç»™å®ƒä¸€ä¸ªipï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªipæ¥è®¿é—®åå°ï¼š</p><p><img src="https://s2.loli.net/2024/08/09/za4BNndLCJgKhRO.png" alt="image-20240809165240360"></p><h3 id="webåå°æ›´æ”¹è®¾ç½®æ— æ³•ç”Ÿæ•ˆ"><a href="#webåå°æ›´æ”¹è®¾ç½®æ— æ³•ç”Ÿæ•ˆ" class="headerlink" title="webåå°æ›´æ”¹è®¾ç½®æ— æ³•ç”Ÿæ•ˆ"></a>webåå°æ›´æ”¹è®¾ç½®æ— æ³•ç”Ÿæ•ˆ</h3><p>å¦‚æœåœ¨webåå°æ›´æ”¹è®¾ç½®ï¼Œç„¶åç‚¹å‡»applyï¼Œç„¶ååˆ·æ–°é¡µé¢å‘ç°å®é™…ä¸Šå¹¶æ²¡æœ‰applyæˆåŠŸï¼Œé‚£æœ‰å¯èƒ½æ˜¯å› ä¸º<code>readonly</code>çš„æ–‡ä»¶ç³»ç»Ÿå¯¼è‡´çš„ï¼ŒæŒ‰ç…§å‰é¢è¯´çš„ï¼Œè¿è¡Œ<code>e2fsck -y /dev/[your device]</code>ç„¶å<code>reboot</code>é‡å¯å°±å¯ä»¥äº†ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ‰§è¡Œå®Œä¸Šé¢çš„è¿‡ç¨‹ä¹‹åï¼Œæ ‘è“æ´¾å·²ç»å˜æˆä¸€ä¸ªåˆæ ¼çš„æ— çº¿è·¯ç”±å™¨äº†ï¼Œç„¶åå°±æ˜¯å…¶ä»–çš„æ›´æ”¹äº†ã€‚</p><h2 id="åç»­"><a href="#åç»­" class="headerlink" title="åç»­"></a>åç»­</h2><p>æ ‘è“æ´¾4Bå®‰è£…openwrtä¼¼ä¹å­˜åœ¨2.4Gé¢‘æ®µçš„APæ— æ³•ä½¿ç”¨çš„æƒ…å†µï¼Œç»è¿‡ä¸Šè¿°çš„é…ç½®ä¹‹åï¼Œå¯ä»¥åœ¨5Gé¢‘æ®µä»¥APæ¨¡å¼å·¥ä½œï¼Œä½†æ˜¯æ— æ³•åœ¨2.4Gé¢‘æ®µä¸‹ä»¥APæ¨¡å¼å·¥ä½œ<sup id="fnref:8" class="footnote-ref"><a href="#fn:8" rel="footnote"><span class="hint--top hint--rounded" aria-label="[2.4 GHz radio doesn't work on Raspberry Pi 4B Â· Issue #9600 Â· openwrt/openwrt Â· GitHub](https://github.com/openwrt/openwrt/issues/9600)">[8]</span></a></sup>ï¼Œä¼šå‡ºç°å„ç§å„æ ·çš„æŠ¥é”™ã€‚</p><p>ç„¶åæ ¹æ®è¿™ä¸ªissueä¸­çš„è®¨è®ºï¼Œè¿™ä¸ªé—®é¢˜å¾ˆæ—©ä¹‹å‰å°±å­˜åœ¨äº†ï¼Œç„¶åinconnu299<sup id="fnref:9" class="footnote-ref"><a href="#fn:9" rel="footnote"><span class="hint--top hint--rounded" aria-label="https://github.com/openwrt/openwrt/issues/9600#issuecomment-1279742554">[9]</span></a></sup>çš„å›å¤æ˜¯æœ‰æ•ˆçš„ï¼Œæ›´æ”¹åæˆ‘çš„<code>/etc/config/wireless</code>å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">config wifi-device <span class="hljs-string">&#x27;radio0&#x27;</span><br>        <span class="hljs-keyword">option</span> <span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;mac80211&#x27;</span><br>        <span class="hljs-keyword">option</span> <span class="hljs-type">path</span> <span class="hljs-string">&#x27;platform/soc/fe300000.mmcnr/mmc_host/mmc1/mmc1:0001/mmc1:0001:1&#x27;</span><br>        <span class="hljs-keyword">option</span> channel <span class="hljs-string">&#x27;1&#x27;</span><br>        <span class="hljs-keyword">option</span> band <span class="hljs-string">&#x27;2g&#x27;</span><br>        <span class="hljs-keyword">option</span> disabled <span class="hljs-string">&#x27;0&#x27;</span><br>        <span class="hljs-keyword">option</span> short_gi_40 <span class="hljs-string">&#x27;0&#x27;</span><br>        <span class="hljs-keyword">option</span> htmode <span class="hljs-string">&#x27;HT40&#x27;</span><br>        <span class="hljs-keyword">option</span> cell_density <span class="hljs-string">&#x27;0&#x27;</span><br>#       <span class="hljs-keyword">option</span> legacy_rates <span class="hljs-string">&#x27;1&#x27;</span><br><br>config wifi-iface <span class="hljs-string">&#x27;wifinet0&#x27;</span><br>        <span class="hljs-keyword">option</span> device <span class="hljs-string">&#x27;radio0&#x27;</span><br>        <span class="hljs-keyword">option</span> mode <span class="hljs-string">&#x27;ap&#x27;</span><br>        <span class="hljs-keyword">option</span> ssid <span class="hljs-string">&#x27;your_ssid&#x27;</span><br>        <span class="hljs-keyword">option</span> encryption <span class="hljs-string">&#x27;psk2&#x27;</span><br>        <span class="hljs-keyword">option</span> key <span class="hljs-string">&#x27;your_wifi_password&#x27;</span><br>        <span class="hljs-keyword">option</span> network <span class="hljs-string">&#x27;lan&#x27;</span><br></code></pre></td></tr></table></figure><p>é…ç½®ä¹‹åé‡å¯ï¼Œç„¶åå°±å¯ä»¥äº†ã€‚</p><p>ã€‚</p><p>æš‚æ—¶æ›´åˆ°è¿™é‡Œã€‚ä¸€äº›å¯èƒ½æœ‰ç”¨çš„é“¾æ¥<sup id="fnref:10" class="footnote-ref"><a href="#fn:10" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Wireless AP on Raspberry Pi 4B not working - Installing and Using OpenWrt / Network and Wireless Configuration - OpenWrt Forum](https://forum.openwrt.org/t/wireless-ap-on-raspberry-pi-4b-not-working/94875)">[10]</span></a></sup><sup id="fnref:11" class="footnote-ref"><a href="#fn:11" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Wireless is not Associated - Installing and Using OpenWrt / Network and Wireless Configuration - OpenWrt Forum](https://forum.openwrt.org/t/wireless-is-not-associated/63291/36)">[11]</span></a></sup><sup id="fnref:12" class="footnote-ref"><a href="#fn:12" rel="footnote"><span class="hint--top hint--rounded" aria-label="[æ ‘è“æ´¾ 4B OpenWrt æ—è·¯ç”±æ•™ç¨‹ | å¶å¯»çš„åšå®¢ (cyrusyip.org)](https://cyrusyip.org/zh-cn/posts/2021/08/30/raspberry-pi-4b-openwrt/)">[12]</span></a></sup><sup id="fnref:13" class="footnote-ref"><a href="#fn:13" rel="footnote"><span class="hint--top hint--rounded" aria-label="[nftables å…¥é—¨ï¼šä»é…ç½®æ–‡ä»¶åˆ°ç«¯å£è½¬å‘ | Rachel's Blog | Rachel030219 (rachelt.one)](https://blog.rachelt.one/articles/new-to-nftables-from-config-to-dnat/)">[13]</span></a></sup></p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://zr4in.github.io/2024/05/13/wireshark-ssh%E8%BE%93%E5%87%BA%E9%87%8D%E5%AE%9A%E5%90%91%E8%B7%A8%E4%B8%BB%E6%9C%BA%E6%8A%93%E5%8C%85/">wireshark+sshè¾“å‡ºé‡å®šå‘è·¨ä¸»æœºæŠ“åŒ… - zr4in</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://pa.ci/251.html">æ ‘è“æ´¾4Bå®‰è£…OpenWrtæ—è·¯ç”±å¹¶è®¾ç½®ç›¸å…³è½¯ä»¶ï¼ˆä¿å§†å¼æ•™ç¨‹ï¼‰ - æ€•åˆº (pa.ci)</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://firmware-selector.openwrt.org/">OpenWrt Firmware Selector</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://global.v2ex.com/t/798492">å…³äºæ ‘è“æ´¾åˆ·å†™ Openwrt å›ºä»¶åçš„ä¸€ä¸ªå°ç–‘æƒ‘ - V2EX</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:5" class="footnote-text"><span><a href="https://yuaneu.ro/archives/openwrt.html">æ ‘è“æ´¾è½¯è·¯ç”±openwrtæŠ˜è…¾è®° - yuaneuroâ€™s blog</a><a href="#fnref:5" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:6" class="footnote-text"><span><a href="https://forum.openwrt.org/t/read-only-root-filesystem/111913">Read only root filesystem - Installing and Using OpenWrt - OpenWrt Forum</a><a href="#fnref:6" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:7" class="footnote-text"><span><a href="https://github.com/QuentinHsu/Document-Page/issues/12">æ ‘è“æ´¾4Bç”¨USBå¯åŠ¨OpenWrtå›ºä»¶ Â· Issue #12 Â· QuentinHsu&#x2F;Document-Page Â· GitHub</a><a href="#fnref:7" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:8" class="footnote-text"><span><a href="https://github.com/openwrt/openwrt/issues/9600">2.4 GHz radio doesnâ€™t work on Raspberry Pi 4B Â· Issue #9600 Â· openwrt&#x2F;openwrt Â· GitHub</a><a href="#fnref:8" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:9" class="footnote-text"><span><a href="https://github.com/openwrt/openwrt/issues/9600#issuecomment-1279742554">https://github.com/openwrt/openwrt/issues/9600#issuecomment-1279742554</a><a href="#fnref:9" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:10" class="footnote-text"><span><a href="https://forum.openwrt.org/t/wireless-ap-on-raspberry-pi-4b-not-working/94875">Wireless AP on Raspberry Pi 4B not working - Installing and Using OpenWrt &#x2F; Network and Wireless Configuration - OpenWrt Forum</a><a href="#fnref:10" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:11" class="footnote-text"><span><a href="https://forum.openwrt.org/t/wireless-is-not-associated/63291/36">Wireless is not Associated - Installing and Using OpenWrt &#x2F; Network and Wireless Configuration - OpenWrt Forum</a><a href="#fnref:11" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:12" class="footnote-text"><span><a href="https://cyrusyip.org/zh-cn/posts/2021/08/30/raspberry-pi-4b-openwrt/">æ ‘è“æ´¾ 4B OpenWrt æ—è·¯ç”±æ•™ç¨‹ | å¶å¯»çš„åšå®¢ (cyrusyip.org)</a><a href="#fnref:12" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:13" class="footnote-text"><span><a href="https://blog.rachelt.one/articles/new-to-nftables-from-config-to-dnat/">nftables å…¥é—¨ï¼šä»é…ç½®æ–‡ä»¶åˆ°ç«¯å£è½¬å‘ | Rachelâ€™s Blog | Rachel030219 (rachelt.one)</a><a href="#fnref:13" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>openwrt</tag>
      
      <tag>æµé‡åˆ†æ</tag>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é€šè¿‡sshéš§é“ä½¿ç”¨ä»£ç†</title>
    <link href="/2024/07/11/%E9%80%9A%E8%BF%87ssh%E9%9A%A7%E9%81%93%E4%BD%BF%E7%94%A8%E4%BB%A3%E7%90%86/"/>
    <url>/2024/07/11/%E9%80%9A%E8%BF%87ssh%E9%9A%A7%E9%81%93%E4%BD%BF%E7%94%A8%E4%BB%A3%E7%90%86/</url>
    
    <content type="html"><![CDATA[<p>å®éªŒå®¤å‘çš„ç”µè„‘æ€§èƒ½å¤ªè¿‡å­±å¼±äº†ï¼Œå°±è¢«æˆ‘æ”¾åœ¨é‚£å½“æˆ24å°æ—¶å¼€æœºçš„ä¸ªäººæœåŠ¡å™¨æ¥ç”¨äº†ï¼Œä¸»è¦æ˜¯åšä¸€äº›å®éªŒå’Œä½œä¸ºsftpæœåŠ¡å™¨ï¼Œç„¶åå°±åœ¨æƒ³ï¼Œæ—¢ç„¶å¯ä»¥é€šè¿‡sshéš§é“ï¼Œä½œä¸ºæ–‡ä»¶æœåŠ¡å™¨ï¼ˆå…¶å®æ˜¯ä¸æ˜¯ftp over sshè¿™é‡Œå…ˆä¸æ·±ç©¶ï¼‰ï¼Œé‚£ä¹ˆèƒ½ä¸èƒ½é€šè¿‡sshä½œä¸ºä»£ç†è½¬å‘æ‰€æœ‰çš„æµé‡å‘¢ï¼Ÿä»Šå¤©æœäº†ä¸€ä¸‹æœç„¶æœ‰ï¼Œå…ˆæ‘†ä¸¤ä¸ªé“¾æ¥åœ¨è¿™é‡Œ<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[How to use SSH as a secure Proxy (networklessons.com)](https://networklessons.com/uncategorized/how-to-use-ssh-as-a-secure-proxy)">[1]</span></a></sup><sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[SSH Tunneling and Proxying | Baeldung on Linux](https://www.baeldung.com/linux/ssh-tunneling-and-proxying)">[2]</span></a></sup>ã€‚</p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://networklessons.com/uncategorized/how-to-use-ssh-as-a-secure-proxy">How to use SSH as a secure Proxy (networklessons.com)</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://www.baeldung.com/linux/ssh-tunneling-and-proxying">SSH Tunneling and Proxying | Baeldung on Linux</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>linux</tag>
      
      <tag>network</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>M</title>
    <link href="/2024/07/10/M/"/>
    <url>/2024/07/10/M/</url>
    
    <content type="html"><![CDATA[<h2 id="Man-in-the-mirror"><a href="#Man-in-the-mirror" class="headerlink" title="Man in the mirror"></a>Man in the mirror</h2><blockquote><p>If you wanna make the world</p><p>A better place</p><p>Take a look at yourself</p><p>And then make that change</p></blockquote><h2 id="æ— åçš„äºº"><a href="#æ— åçš„äºº" class="headerlink" title="æ— åçš„äºº"></a>æ— åçš„äºº</h2><blockquote><p>ä½ æ¥è‡ªäº å—æ–¹çš„æ‘è½ æ¥è‡ªç²—ç³™çš„åŒæ‰‹</p><p>ä½ ç«™åœ¨ æ¥¼å®‡çš„ç¼éš™ å¯ä½ æ²¡æœ‰é€€ç¼©</p><p>æˆ‘æ¥è‡ªäº åŒ—æ–¹çš„æ˜¥å¤© æ¥è‡ªä¸€æ­¥ä¸€å›é¦–</p><p>èƒŒåæœ‰ å‘Šåˆ«çš„è·¯å£ æ¸©æš–æ¯ä¸ªæ—¥è½</p><p>å½“å®¶ä¹¡å…¥å†¬ çš„æ—¶å€™</p><p>åˆ—è½¦åˆ°ç«™ ä»¥å</p><p>å°æ—¶å€™çš„é£ å†å¹è¿‡</p><p>å›å¿†èµ·å•çº¯ çš„å¿«ä¹</p><p>åœ¨ç†Ÿæ‚‰çš„ è¡—å¤´</p><p>æœ‰äºº ä¼šç”¨æ‰€æœ‰çš„æ¸©æŸ” å–Šå‡ºä½ çš„</p><p>åå­—</p></blockquote><h2 id="Life-Will-Change"><a href="#Life-Will-Change" class="headerlink" title="Life Will Change"></a>Life Will Change</h2><blockquote><p>And youâ€™ll know we were out there</p><p>Swatted lies in the making</p><p>Your empire for the taking</p><p>Canâ€™t hold on or life wonâ€™t change</p><p>And our voices rang out here</p><p>Took the mask off to feel free</p><p>Fought it out in the debris</p><p>Now we know that life will change</p></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>éšç¬”</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>wireshark+sshè¾“å‡ºé‡å®šå‘è·¨ä¸»æœºæŠ“åŒ…</title>
    <link href="/2024/05/13/wireshark-ssh%E8%BE%93%E5%87%BA%E9%87%8D%E5%AE%9A%E5%90%91%E8%B7%A8%E4%B8%BB%E6%9C%BA%E6%8A%93%E5%8C%85/"/>
    <url>/2024/05/13/wireshark-ssh%E8%BE%93%E5%87%BA%E9%87%8D%E5%AE%9A%E5%90%91%E8%B7%A8%E4%B8%BB%E6%9C%BA%E6%8A%93%E5%8C%85/</url>
    
    <content type="html"><![CDATA[<p>é€‚ç”¨äºlinuxä¸»æœºä½œä¸ºçƒ­ç‚¹ç½‘ç»œAPï¼Œç„¶åç»™å…¶ä»–è®¾å¤‡æä¾›ç½‘ç»œè¿æ¥ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„æµé‡éƒ½ç»è¿‡linuxä¸»æœºè½¬å‘ï¼Œä¹Ÿå°±æ–¹ä¾¿äº†æµé‡åˆ†æã€‚ç„¶åå¦‚æœå¸Œæœ›åœ¨å¦ä¸€å°ä¸»æœºï¼ˆwindowsï¼‰ä¸Šçœ‹åˆ°å®æ—¶çš„æŠ“åŒ…æƒ…å†µï¼Œå¯ä»¥é€šè¿‡sshè¿æ¥åˆ°linuxï¼Œsshå‘½ä»¤çš„è¾“å‡ºé‡å®šå‘åˆ°windowsçš„wiresharkä¸­ã€‚</p><p>linuxä¸Šè¿è¡Œcreate_ap<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[oblique/create_ap: \[NOT MAINTAINED\] This script creates a NATed or Bridged WiFi Access Point. (github.com)](https://github.com/oblique/create_ap)">[1]</span></a></sup>æˆ–è€…linux-wifi-hotspot<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[lakinduakash/linux-wifi-hotspot: Feature-rich wifi hotspot creator for Linux which provides both GUI and command-line interface. It is also able to create a hotspot using the same wifi card which is connected to an AP already ( Similar to Windows 10). (github.com)](https://github.com/lakinduakash/linux-wifi-hotspot)">[2]</span></a></sup>æˆ–è€…linux_router<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="[garywill/linux-router: Set Linux as router in one command. Support Internet sharing, redsocks, Wifi hotspot, IPv6. Can also be used for routing VM/containers ğŸ›°ï¸ (ä¹Ÿæ¬¢è¿å…³æ³¨Bç«™ https://space.bilibili.com/2123686105 ) (github.com)](https://github.com/garywill/linux-router)">[3]</span></a></sup></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">linux_router<br></code></pre></td></tr></table></figure><p>æ³¨æ„å¦‚æœwindowsä¸Šæ²¡æœ‰wiresharkæ·»åŠ åˆ°ç¯å¢ƒå˜é‡çš„è¯éœ€è¦æ·»åŠ æ¢è¿›å˜é‡æˆ–è€…ä½¿ç”¨wiresharkçš„ç»å¯¹è·¯å¾„ã€‚è€Œä¸”è¦ç”¨cmdä¸èƒ½ç”¨powershellï¼Œä¼¼ä¹æ˜¯å› ä¸ºpowershellçš„ç®¡é“é‡å®šå‘ä¸å¤ªä¸€æ ·<sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="[ä½¿ç”¨ tcpdump å’Œ Wireshark è¿›è¡Œè¿œç¨‹å®æ—¶æŠ“åŒ…åˆ†æ - This Cute World](https://thiscute.world/posts/tcpdump-and-wireshark/)">[4]</span></a></sup>ã€‚</p><p>windowsä¸Šè¿è¡Œssh+wireshark</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">ssh username@host &quot;sudo tcpdump -i wlo1 -l -w -&quot; | wireshark -k -i -<br></code></pre></td></tr></table></figure><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://github.com/oblique/create_ap">oblique&#x2F;create_ap: [NOT MAINTAINED] This script creates a NATed or Bridged WiFi Access Point. (github.com)</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://github.com/lakinduakash/linux-wifi-hotspot">lakinduakash&#x2F;linux-wifi-hotspot: Feature-rich wifi hotspot creator for Linux which provides both GUI and command-line interface. It is also able to create a hotspot using the same wifi card which is connected to an AP already ( Similar to Windows 10). (github.com)</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://github.com/garywill/linux-router">garywill&#x2F;linux-router: Set Linux as router in one command. Support Internet sharing, redsocks, Wifi hotspot, IPv6. Can also be used for routing VM&#x2F;containers ğŸ›°ï¸ (ä¹Ÿæ¬¢è¿å…³æ³¨Bç«™ https://space.bilibili.com/2123686105 ) (github.com)</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://thiscute.world/posts/tcpdump-and-wireshark/">ä½¿ç”¨ tcpdump å’Œ Wireshark è¿›è¡Œè¿œç¨‹å®æ—¶æŠ“åŒ…åˆ†æ - This Cute World</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>æµé‡åˆ†æ</tag>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ— çº¿ç½‘å¡æ··æ‚æ¨¡å¼wifiæŠ“åŒ…</title>
    <link href="/2024/04/24/%E6%97%A0%E7%BA%BF%E7%BD%91%E5%8D%A1%E6%B7%B7%E6%9D%82%E6%A8%A1%E5%BC%8Fwifi%E6%8A%93%E5%8C%85/"/>
    <url>/2024/04/24/%E6%97%A0%E7%BA%BF%E7%BD%91%E5%8D%A1%E6%B7%B7%E6%9D%82%E6%A8%A1%E5%BC%8Fwifi%E6%8A%93%E5%8C%85/</url>
    
    <content type="html"><![CDATA[<p>ç°åœ¨çš„IoTè®¾å¤‡å¾€å¾€ä¾èµ–äºè“ç‰™ã€zigbeeæˆ–è€…wifiç­‰æ— çº¿é€šä¿¡ä»‹è´¨ï¼Œä¸ºäº†æ›´æ¸…æ™°åœ°äº†è§£è®¾å¤‡çš„é€šä¿¡ï¼Œæœ‰å¿…è¦å­¦ä¹ ä¸€ä¸‹wifiæŠ“åŒ…ã€‚</p><h2 id="Airomon-ng"><a href="#Airomon-ng" class="headerlink" title="Airomon-ng"></a>Airomon-ng</h2><p>è¯•è¿‡ç”¨<code>iwconfig</code>ç›´æ¥è®¾ç½®ç½‘å¡ä¸º<code>Monitor</code>æ¨¡å¼ï¼Œç„¶åç›´æ¥ç”¨wiresharkæŠ“åŒ…ï¼Œæ˜¯ä¸è¡Œçš„ï¼Œåº”è¯¥è¿˜æœ‰å…¶ä»–è®¾ç½®ï¼Œå°±ä¸ç®¡äº†ï¼Œè¿˜æ˜¯ç”¨ç°æˆçš„å·¥å…·å§<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Linuxç¯å¢ƒä¸‹Wi-FiæŠ“åŒ…è¯´æ˜ - Nordic Semiconductorä¸­æ–‡å®˜ç½‘](https://www.nordicsemi.cn/news/linux-environment-wifi-packet-capture-instructions/)">[1]</span></a></sup></p><p><code>airmon-ng</code>å…ˆè®¾ç½®ç½‘å¡ä¸ºç›‘å¬æ¨¡å¼ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo airmon-ng start wlo1<br></code></pre></td></tr></table></figure><p>æ³¨æ„å¦‚æœè¾“å‡ºæç¤ºæœ‰å…¶ä»–è¿›ç¨‹å¯èƒ½ä¼šå½±å“æŠ“åŒ…ï¼Œå°±æŒ‰ç…§æç¤ºæ‰§è¡Œå¯¹åº”å‘½ä»¤killæ‰å…¶ä»–è¿›ç¨‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo airmon-ng check <span class="hljs-built_in">kill</span><br></code></pre></td></tr></table></figure><h2 id="æŠ“åŒ…"><a href="#æŠ“åŒ…" class="headerlink" title="æŠ“åŒ…"></a>æŠ“åŒ…</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">airodump-ng -c 6 --bssid mac_address_of_ap wlo1mon --output-format pcap -w file_to_write<br></code></pre></td></tr></table></figure><p><code>-c 6</code>æŒ‡å®šäº†ç¬¬6ä¸ªä¿¡é“ï¼Œ<code>--bssid</code>æŒ‡å®šè¦æŠ“å–çš„apçš„macåœ°å€ï¼Œç„¶åæ˜¯å¼€å¯æŠ“åŒ…æ¨¡å¼çš„ç½‘å¡çš„åç§°<code>wlo1mon</code>ï¼Œç„¶å<code>-w</code>æŒ‡å®šè¦æŠŠæŠ“å–çš„æŠ¥æ–‡å†™åˆ°å“ªä¸ªæ–‡ä»¶ã€‚</p><h2 id="è§£å¯†wifiæŠ¥æ–‡"><a href="#è§£å¯†wifiæŠ¥æ–‡" class="headerlink" title="è§£å¯†wifiæŠ¥æ–‡"></a>è§£å¯†wifiæŠ¥æ–‡</h2><p>åœ¨çŸ¥é“wifiå¯†ç å¹¶ä¸”æŠ“åˆ°è®¾å¤‡æ¡æ‰‹çš„æŠ¥æ–‡ä¹‹åï¼Œå¯ä»¥è§£å¯†å·²åŠ å¯†çš„wifiæŠ¥æ–‡<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[ç”¨Wiresharkè§£å¯†æ— çº¿ç½‘ç»œæ•°æ®åŒ… | F1v3's Notes (x-f1v3.github.io)](https://x-f1v3.github.io/blog/ç”¨Wiresharkè§£å¯†æ— çº¿ç½‘ç»œæ•°æ®åŒ….html)">[2]</span></a></sup>ï¼Œæœ‰æ—¶å€™éœ€è¦åˆ é™¤wiresharkçš„é…ç½®æ–‡ä»¶é¿å…å‡ºç°bug<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="[è§£å¯† 802.11 åŠ å¯†æ•°æ®åŒ… | (breezetemple.github.io)](https://breezetemple.github.io/2019/05/31/decryption-802-11-with-wireshark/)">[3]</span></a></sup></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://www.nordicsemi.cn/news/linux-environment-wifi-packet-capture-instructions/">Linuxç¯å¢ƒä¸‹Wi-FiæŠ“åŒ…è¯´æ˜ - Nordic Semiconductorä¸­æ–‡å®˜ç½‘</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://x-f1v3.github.io/blog/%E7%94%A8Wireshark%E8%A7%A3%E5%AF%86%E6%97%A0%E7%BA%BF%E7%BD%91%E7%BB%9C%E6%95%B0%E6%8D%AE%E5%8C%85.html">ç”¨Wiresharkè§£å¯†æ— çº¿ç½‘ç»œæ•°æ®åŒ… | F1v3â€™s Notes (x-f1v3.github.io)</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://breezetemple.github.io/2019/05/31/decryption-802-11-with-wireshark/">è§£å¯† 802.11 åŠ å¯†æ•°æ®åŒ… | (breezetemple.github.io)</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>æµé‡åˆ†æ</tag>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>windowså³é”®èœå•æ–°å»ºmarkdownæ–‡æ¡£</title>
    <link href="/2024/04/23/windows%E5%8F%B3%E9%94%AE%E8%8F%9C%E5%8D%95%E6%96%B0%E5%BB%BAmarkdown%E6%96%87%E6%A1%A3/"/>
    <url>/2024/04/23/windows%E5%8F%B3%E9%94%AE%E8%8F%9C%E5%8D%95%E6%96%B0%E5%BB%BAmarkdown%E6%96%87%E6%A1%A3/</url>
    
    <content type="html"><![CDATA[<p>typoraçš„å®˜ç½‘ä¸Šæœ‰ç›¸åº”çš„æ•™ç¨‹<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Add New â€œMarkdownâ€ Item in Context Menu - Typora Support](https://support.typora.io/New-File-in-Context/)">[1]</span></a></sup>ï¼Œå°±æ˜¯æ›´æ”¹windowsçš„æ³¨å†Œè¡¨ï¼Œè¿™æ ·å¯ä»¥ç›´æ¥å³é”®æ–°å»ºmarkdownæ–‡ä»¶ï¼Œå°±ä¸ç”¨æœ´ç´ åœ°æ–°å»ºtxtæ–‡ä»¶ç„¶åå†æ”¹åç¼€äº†ï¼Œtyporaç»™å‡ºçš„æ³¨å†Œè¡¨æ˜¯ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs csharp">Windows Registry Editor Version <span class="hljs-number">5.00</span><br><br>[<span class="hljs-meta">HKEY_CLASSES_ROOT\.md</span>]<br>@=<span class="hljs-string">&quot;markdown&quot;</span><br><br>[<span class="hljs-meta">HKEY_CLASSES_ROOT\.md\ShellNew</span>]<br><span class="hljs-string">&quot;NullFile&quot;</span>=<span class="hljs-string">&quot;&quot;</span><br><br>[<span class="hljs-meta">HKEY_CLASSES_ROOT\markdown</span>]<br>@=<span class="hljs-string">&quot;Blank Markdown file&quot;</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥å…ˆæ–°å»ºtxtï¼Œç„¶åå¤åˆ¶è¿›å»ï¼Œå†æ”¹åç¼€ä¸ºregï¼Œç„¶ååŒå‡»è¿è¡Œï¼Œè¿™æ ·å³é”®çš„æ–°å»ºèœå•ä¼šæœ‰â€Blank Markdown fileâ€é€‰é¡¹ï¼ˆä¸ªäººæ„Ÿè§‰æŠŠBlankç›´æ¥å»æ‰æ›´ä¼˜é›…ï¼‰</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://support.typora.io/New-File-in-Context/">Add New â€œMarkdownâ€ Item in Context Menu - Typora Support</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>mix</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®°AndroidæŸAPPé€†å‘</title>
    <link href="/2024/04/16/%E8%AE%B0Android%E6%9F%90APP%E9%80%86%E5%90%91/"/>
    <url>/2024/04/16/%E8%AE%B0Android%E6%9F%90APP%E9%80%86%E5%90%91/</url>
    
    <content type="html"><![CDATA[<p>è®°å½•ä¸€ä¸‹è‡ªå·±æ¢ç´¢å®‰å“é€†å‘çš„è¿‡ç¨‹ï¼Œçº¯æ–°æ‰‹è„šæœ¬å°å­ï¼Œå¦‚æœ‰è°¬è¯¯æ³è¯·å„ä½æ–§æ­£ã€‚</p><h2 id="root"><a href="#root" class="headerlink" title="root"></a>root</h2><p>é¦–å…ˆæ˜¯è·å–æ‰‹æœºçš„rootæƒé™ï¼Œæ¯”è¾ƒç®€å•çš„æ–¹æ³•æ˜¯æ¨¡æ‹Ÿå™¨ï¼Œä¸€èˆ¬éƒ½ä¼šç›´æ¥å¼€æ”¾rootï¼Œä½†æ˜¯æœ‰äº›appå¯èƒ½ä¼šæœ‰è™šæ‹Ÿæœºæ£€æµ‹ï¼Œæ²¡æœ‰çš„è¯æœ€å¥½ï¼Œæœ‰çš„è¯å¯èƒ½éœ€è¦èŠ±å¿ƒæ€è€ƒè™‘ç»•è¿‡ï¼Œæˆ–è€…ä½¿ç”¨çœŸæœºã€‚</p><p>ä½¿ç”¨çœŸæœºä¸€èˆ¬ä¼šå¥½å¾ˆå¤šã€‚çœŸæœºrootä¸€èˆ¬ä¼šç”¨åˆ°magisk<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[topjohnwu/Magisk: The Magic Mask for Android (github.com)](https://github.com/topjohnwu/Magisk)">[1]</span></a></sup>ï¼Œç„¶åä¹Ÿéœ€è¦å¯¹åº”æ‰‹æœºå‹å·çš„é•œåƒæ–‡ä»¶ï¼ˆæ‰€ä»¥ä¸€èˆ¬éœ€è¦å‚å•†æ”¯æŒrootï¼Œæ¯”å¦‚å°ç±³çš„æ‰‹æœºå’Œgoogleçš„pixelï¼‰ï¼Œè¿™ç¯‡blogå°±å…ˆä¸è®²æ€ä¹ˆrootçš„äº†ï¼Œæ•™ç¨‹å…¶å®å¾ˆå¤šã€‚</p><h2 id="Frida"><a href="#Frida" class="headerlink" title="Frida"></a>Frida</h2><p>ç„¶åæ˜¯Frida<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[frida/frida: Clone this repo to build Frida (github.com)](https://github.com/frida/frida)">[2]</span></a></sup>ï¼ŒFridaæ˜¯ä¸€ä¸ªpython + jsçš„hookæ¡†æ¶<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Frida åŸç†åŠç®€å•ä½¿ç”¨ - Only-xiaoxiao - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/Only-xiaoxiao/p/17294561.html)">[3]</span></a></sup>ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ç§åŠ¨æ€æ’æ¡©å·¥å…·ã€‚ä½¿ç”¨çš„æ—¶å€™ï¼Œåœ¨éœ€è¦hookçš„åœ°æ–¹ï¼Œæ¯”å¦‚Androidæ‰‹æœºä¸Šä»¥rootæƒé™è¿è¡Œå¯¹åº”æ¶æ„ï¼ˆx86æˆ–è€…armï¼Œè™šæ‹Ÿæœºä¸€èˆ¬x86ï¼ŒçœŸæœºä¸€èˆ¬armï¼‰çš„frida-serverï¼Œç„¶ååœ¨è¿›è¡Œhookçš„åœ°æ–¹è¿è¡Œfridaæˆ–è€…frida-toolså·¥å…·ï¼Œfridaå’Œfrida-toolså¹¶ä¸æ˜¯åŒä¸€ä¸ªä¸œè¥¿ï¼Œæˆ‘æš‚æ—¶æ²¡æœ‰ä¸“é—¨å»ææ¸…æ¥šè¿™ä¸¤è€…çš„è”ç³»ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ä¸¤è€…éœ€è¦ç‰ˆæœ¬å…¼å®¹<sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Frida server å’Œ python clientä¸‹è½½ ç‰ˆæœ¬å¯¹åº”å…³ç³» - æ‚Ÿé€ - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/wutou/p/17884865.html)">[4]</span></a></sup>ã€‚ä¸€èˆ¬ç›´æ¥å®‰è£…æœ€æ–°ç‰ˆåº”è¯¥å°±å¯ä»¥ï¼š</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cmd">pip install frida<br>pip install frida-tools<br></code></pre></td></tr></table></figure><h2 id="jadx"><a href="#jadx" class="headerlink" title="jadx"></a>jadx</h2><p>jadx<sup id="fnref:5" class="footnote-ref"><a href="#fn:5" rel="footnote"><span class="hint--top hint--rounded" aria-label="[skylot/jadx: Dex to Java decompiler (github.com)](https://github.com/skylot/jadx)">[5]</span></a></sup>æ˜¯ä¸€ä¸ªå¼€æºå®‰å“é€†å‘å·¥å…·ï¼Œä¸»è¦ç”¨äºé€†å‘åˆ†æapkï¼Œåç¼–è¯‘ä¸ºjavaæºä»£ç ï¼ˆå½“ç„¶ä¸€èˆ¬ä¸å¯èƒ½å®Œç¾åç¼–è¯‘ï¼Œé‡åˆ°è¿‡ä¸€äº›æŠ¥é”™çš„åœ°æ–¹ï¼‰</p><p>å¦‚æœapkæ²¡æœ‰åŠ å£³çš„è¯ï¼Œç›´æ¥æŠŠapkæ‹–åˆ°jadxé‡Œå°±è¡Œï¼Œjadxä¼šè‡ªåŠ¨å®Œæˆåˆ†æï¼Œæ¯”å¦‚è¿™æ ·ï¼š</p><p><img src="https://s2.loli.net/2024/04/23/MxLacvCR19o6myg.png" alt="image-20240423095710623"></p><p>å¦‚æœä»£ç æ˜¯æ··æ·†è¿‡çš„ï¼Œé‚£å¯èƒ½ä¼šæ¯”è¾ƒéš¾è¿‡ï¼Œåªèƒ½æ…¢æ…¢çœ‹äº†ï¼Œæˆ–è®¸ç¨‹åºåˆ†æé¢†åŸŸä¼šæœ‰é’ˆå¯¹åæ··æ·†çš„ç ”ç©¶ï¼Œä½†æ˜¯ä¸ªäººæ„Ÿè§‰å¯èƒ½éƒ½æ˜¯æ¯”è¾ƒad-hocçš„ï¼Œè€Œä¸”å…¶å®æ··æ·†ä¸æ˜¯å¾ˆä¸¥é‡çš„è¯ï¼Œæ ¹æ®logæˆ–è€…ä¸€äº›å­—ç¬¦ä¸²æ¥è¿›è¡Œæ¨æµ‹ï¼Œåº”è¯¥ä¹Ÿæ˜¯èƒ½åˆ†æçš„ï¼Œæˆ‘ç›®å‰è¿˜æ²¡æœ‰ç”¨ä»€ä¹ˆåæ··æ·†çš„å·¥å…·ï¼Œjadxè‡ªå¸¦åæ··æ·†å·¥å…·ï¼Œä½†ä¹Ÿåªæ˜¯æŠŠä¸€äº›å‡½æ•°åæˆ–è€…ç±»åä¸­çš„ä¸å¸¸è§çš„å­—ç¬¦ç»™å»æ‰ï¼Œæ¢æˆä¸€äº›å¸¸è§å­—ç¬¦åŠ ä¸Šæ•°å­—ç¼–å·ã€‚</p><h2 id="hook"><a href="#hook" class="headerlink" title="hook"></a>hook</h2><p>hooké€šä¿—ç‚¹å°±æ˜¯é’©å­ï¼ˆ<del>æ²Ÿå­</del>ï¼‰ï¼ˆ<del>åï¼Œæ²Ÿå­æ–‡å­¦é€æ¸æ±¡æŸ“äº’è”ç½‘</del>ï¼‰ï¼ŒæŠŠæ­£å¸¸çš„å®ç°æ›¿æ¢ä¸ºè‡ªå·±æƒ³è¦çš„å®ç°ï¼Œæ¯”å¦‚appä¸­æŸä¸ªå‡½æ•°æƒ³è¦æ£€æµ‹ç¯å¢ƒç„¶åè¿”å›trueæˆ–è€…falseï¼Œç„¶åä½ å¸Œæœ›å®ƒæ°¸è¿œè¿”å›trueï¼Œå°±å¯ä»¥åˆ©ç”¨hook</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> java_class = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.app.classname&quot;</span>);<br>    <br>    java_class.<span class="hljs-property">function_name</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&quot;para list&quot;</span>).<span class="hljs-property">implemeation</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-string">&quot;para list&quot;</span></span>)&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;;<br>&#125;);<br></code></pre></td></tr></table></figure><p>ç„¶åä½¿ç”¨fridaçš„å‘½ä»¤è¡Œå·¥å…·å°†ä»£ç æ³¨å…¥åˆ°å¯¹åº”çš„appè¿›ç¨‹å°±å¯ä»¥äº†<sup id="fnref:6" class="footnote-ref"><a href="#fn:6" rel="footnote"><span class="hint--top hint--rounded" aria-label="[fridaçš„ç”¨æ³•--Hook Javaä»£ç ç¯‡ - luoyesiqiu - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/luoyesiqiu/p/10718997.html)">[6]</span></a></sup></p><h2 id="example"><a href="#example" class="headerlink" title="example"></a>example</h2><p>ä»¥è¿åŠ¨å¥åº·appä¸ºä¾‹ï¼Œæ¯”å¦‚å¸Œæœ›çŸ¥é“å®ƒæ‰€æœ‰çš„åŠ å¯†æ“ä½œï¼ˆä»£ç å¿˜è®°ä»å“ªå¤åˆ¶æ¥çš„äº†ï¼Œå¦‚æœ‰é—®é¢˜è¯·è”ç³»æˆ‘ï¼‰ï¼š</p>    <div class="fold">      <div class="fold-title fold-default collapsed" data-toggle="collapse" href="#collapse-e064c6af" role="button" aria-expanded="false" aria-controls="collapse-e064c6af">        <div class="fold-arrow">â–¶</div>js code      </div>      <div class="fold-collapse collapse" id="collapse-e064c6af">        <div class="fold-content">          <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">showStacks</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title function_">send</span>(<span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;android.util.Log&quot;</span>).<span class="hljs-title function_">getStackTraceString</span>(<span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;java.lang.Exception&quot;</span>).$new()));<br>    &#125;);<br>&#125;; <span class="hljs-comment">// print stack info</span><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">bytesToHex</span>(<span class="hljs-params">arr</span>) &#123;<br>    <span class="hljs-keyword">var</span> str = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; arr.<span class="hljs-property">length</span>; i++) &#123;<br>        <span class="hljs-keyword">var</span> tmp = arr[i];<br>        <span class="hljs-keyword">if</span> (tmp &lt; <span class="hljs-number">0</span>) &#123;<br>            tmp = (<span class="hljs-number">255</span> + tmp + <span class="hljs-number">1</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            tmp = tmp.<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>);<br>        &#125;<br>        <span class="hljs-keyword">if</span> (tmp.<span class="hljs-property">length</span> == <span class="hljs-number">1</span>) &#123;<br>            tmp = <span class="hljs-string">&quot;0&quot;</span> + tmp;<br>        &#125;<br>        str += tmp;<br>    &#125;<br>    <span class="hljs-keyword">return</span> str;<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">bytesToBase64</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">var</span> base64EncodeChars = <span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span>;<br>    <span class="hljs-keyword">var</span> r, a, c, h, o, t;<br>    <span class="hljs-keyword">for</span> (c = e.<span class="hljs-property">length</span>, a = <span class="hljs-number">0</span>, r = <span class="hljs-string">&#x27;&#x27;</span>; a &lt; c;) &#123;<br>        <span class="hljs-keyword">if</span> (h = <span class="hljs-number">255</span> &amp; e[a++], a == c) &#123;<br>            r += base64EncodeChars.<span class="hljs-title function_">charAt</span>(h &gt;&gt; <span class="hljs-number">2</span>),<br>            r += base64EncodeChars.<span class="hljs-title function_">charAt</span>((<span class="hljs-number">3</span> &amp; h) &lt;&lt; <span class="hljs-number">4</span>),<br>            r += <span class="hljs-string">&#x27;==&#x27;</span>;<br>            <span class="hljs-keyword">break</span><br>        &#125;<br>        <span class="hljs-keyword">if</span> (o = e[a++], a == c) &#123;<br>            r += base64EncodeChars.<span class="hljs-title function_">charAt</span>(h &gt;&gt; <span class="hljs-number">2</span>),<br>            r += base64EncodeChars.<span class="hljs-title function_">charAt</span>((<span class="hljs-number">3</span> &amp; h) &lt;&lt; <span class="hljs-number">4</span> | (<span class="hljs-number">240</span> &amp; o) &gt;&gt; <span class="hljs-number">4</span>),<br>            r += base64EncodeChars.<span class="hljs-title function_">charAt</span>((<span class="hljs-number">15</span> &amp; o) &lt;&lt; <span class="hljs-number">2</span>),<br>            r += <span class="hljs-string">&#x27;=&#x27;</span>;<br>            <span class="hljs-keyword">break</span><br>        &#125;<br>        t = e[a++],<br>        r += base64EncodeChars.<span class="hljs-title function_">charAt</span>(h &gt;&gt; <span class="hljs-number">2</span>),<br>        r += base64EncodeChars.<span class="hljs-title function_">charAt</span>((<span class="hljs-number">3</span> &amp; h) &lt;&lt; <span class="hljs-number">4</span> | (<span class="hljs-number">240</span> &amp; o) &gt;&gt; <span class="hljs-number">4</span>),<br>        r += base64EncodeChars.<span class="hljs-title function_">charAt</span>((<span class="hljs-number">15</span> &amp; o) &lt;&lt; <span class="hljs-number">2</span> | (<span class="hljs-number">192</span> &amp; t) &gt;&gt; <span class="hljs-number">6</span>),<br>        r += base64EncodeChars.<span class="hljs-title function_">charAt</span>(<span class="hljs-number">63</span> &amp; t)<br>    &#125;<br>    <span class="hljs-keyword">return</span> r<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">bytesToString</span>(<span class="hljs-params">arr</span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> arr === <span class="hljs-string">&#x27;string&#x27;</span>) &#123;<br>        <span class="hljs-keyword">return</span> arr;<br>    &#125;<br>    <span class="hljs-keyword">var</span> str = <span class="hljs-string">&#x27;&#x27;</span>,<br>    _arr = arr;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; _arr.<span class="hljs-property">length</span>; i++) &#123;<br>        <span class="hljs-keyword">var</span> one = _arr[i].<span class="hljs-title function_">toString</span>(<span class="hljs-number">2</span>),<br>        v = one.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/^1+?(?=0)/</span>);<br>        <span class="hljs-keyword">if</span> (v &amp;&amp; one.<span class="hljs-property">length</span> == <span class="hljs-number">8</span>) &#123;<br>            <span class="hljs-keyword">var</span> bytesLength = v[<span class="hljs-number">0</span>].<span class="hljs-property">length</span>;<br>            <span class="hljs-keyword">var</span> store = _arr[i].<span class="hljs-title function_">toString</span>(<span class="hljs-number">2</span>).<span class="hljs-title function_">slice</span>(<span class="hljs-number">7</span> - bytesLength);<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> st = <span class="hljs-number">1</span>; st &lt; bytesLength; st++) &#123;<br>                store += _arr[st + i].<span class="hljs-title function_">toString</span>(<span class="hljs-number">2</span>).<span class="hljs-title function_">slice</span>(<span class="hljs-number">2</span>);<br>            &#125;<br>            str += <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(<span class="hljs-built_in">parseInt</span>(store, <span class="hljs-number">2</span>));<br>            i += bytesLength - <span class="hljs-number">1</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            str += <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(_arr[i]);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> str;<br>&#125;<br><br><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> secretKeySpec = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;javax.crypto.spec.SecretKeySpec&#x27;</span>);<br>    secretKeySpec.<span class="hljs-property">$init</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;[B&#x27;</span>,<span class="hljs-string">&#x27;java.lang.String&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a,b</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.$init(a, b);<br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== javax.crypto.spec.SecretKeySpec.$init(byte[], String)</span><br><span class="hljs-string">ç®—æ³•å                  : <span class="hljs-subst">$&#123; b &#125;</span></span><br><span class="hljs-string">Decå¯†é’¥(String)         : <span class="hljs-subst">$&#123; bytesToString(a) &#125;</span></span><br><span class="hljs-string">Decç§˜é’¥(Hex)            : <span class="hljs-subst">$&#123; bytesToHex(a) &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;;<br><br>    <span class="hljs-keyword">var</span> mac = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;javax.crypto.Mac&#x27;</span>);<br>    mac.<span class="hljs-property">getInstance</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;java.lang.String&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getInstance</span>(a);<br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== javax.crypto.Mac.getInstance(String)</span><br><span class="hljs-string">ç®—æ³•å                  : <span class="hljs-subst">$&#123; a &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;;<br>    mac.<span class="hljs-property">update</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;[B&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== javax.crypto.Mac.update(byte[])</span><br><span class="hljs-string">Mac update(string)      : <span class="hljs-subst">$&#123; bytesToString(a) &#125;</span></span><br><span class="hljs-string">Mac update(hex)         : <span class="hljs-subst">$&#123; bytesToHex(a) &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">update</span>(a);<br>    &#125;;<br>    mac.<span class="hljs-property">update</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;[B&#x27;</span>,<span class="hljs-string">&#x27;int&#x27;</span>,<span class="hljs-string">&#x27;int&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a,b,c</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== javax.crypto.Mac.update(byte[], int, int)</span><br><span class="hljs-string">Mac update(string)      : <span class="hljs-subst">$&#123; bytesToString(a) &#125;</span> | <span class="hljs-subst">$&#123; b &#125;</span> | <span class="hljs-subst">$&#123; c &#125;</span></span><br><span class="hljs-string">Mac update(hex)         : <span class="hljs-subst">$&#123; bytesToHex(a) &#125;</span> | <span class="hljs-subst">$&#123; b &#125;</span> | <span class="hljs-subst">$&#123; c &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">update</span>(a, b, c)<br>    &#125;;<br>    mac.<span class="hljs-property">doFinal</span>.<span class="hljs-title function_">overload</span>().<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">doFinal</span>();<br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== javax.crypto.Mac.doFinal()</span><br><span class="hljs-string">doFinalç»“æœ(hex)        : <span class="hljs-subst">$&#123; bytesToHex(result) &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;;<br>    mac.<span class="hljs-property">doFinal</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;[B&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">doFinal</span>(a);<br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== javax.crypto.Mac.doFinal(byte[])</span><br><span class="hljs-string">doFinalå‚æ•°(string)     : <span class="hljs-subst">$&#123; bytesToString(a) &#125;</span></span><br><span class="hljs-string">doFinalå‚æ•°(hex)        : <span class="hljs-subst">$&#123; bytesToHex(a) &#125;</span></span><br><span class="hljs-string">---</span><br><span class="hljs-string">doFinalç»“æœ(hex)        : <span class="hljs-subst">$&#123; bytesToHex(result) &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;;<br><br>    <span class="hljs-keyword">var</span> md = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;java.security.MessageDigest&#x27;</span>);<br>    md.<span class="hljs-property">getInstance</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;java.lang.String&#x27;</span>,<span class="hljs-string">&#x27;java.lang.String&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a,b</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== java.security.MessageDigest.getInstance(String, String)</span><br><span class="hljs-string">ç®—æ³•å                  ï¼š<span class="hljs-subst">$&#123; a &#125;</span></span><br><span class="hljs-string">å‚æ•°2                   ï¼š<span class="hljs-subst">$&#123; b &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getInstance</span>(a, b);<br>    &#125;;<br>    md.<span class="hljs-property">getInstance</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;java.lang.String&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== java.security.MessageDigest.getInstance(String)</span><br><span class="hljs-string">ç®—æ³•å                  ï¼š<span class="hljs-subst">$&#123; a &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getInstance</span>(a);<br>    &#125;;<br>    md.<span class="hljs-property">update</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;[B&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== java.security.MessageDigest.update(byte[])</span><br><span class="hljs-string">MessageDigest update(string)    : <span class="hljs-subst">$&#123; bytesToString(a) &#125;</span></span><br><span class="hljs-string">MessageDigest update(hex)       : <span class="hljs-subst">$&#123; bytesToHex(a) &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">update</span>(a);<br>    &#125;;<br>    md.<span class="hljs-property">update</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;[B&#x27;</span>,<span class="hljs-string">&#x27;int&#x27;</span>,<span class="hljs-string">&#x27;int&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a,b,c</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== java.security.MessageDigest.update(byte[], int, int)</span><br><span class="hljs-string">MessageDigest update(string)    : <span class="hljs-subst">$&#123; bytesToString(a) &#125;</span> | <span class="hljs-subst">$&#123; b &#125;</span> | <span class="hljs-subst">$&#123; c &#125;</span></span><br><span class="hljs-string">MessageDigest update(hex)       : <span class="hljs-subst">$&#123; bytesToHex(a) &#125;</span> | <span class="hljs-subst">$&#123; b &#125;</span> | <span class="hljs-subst">$&#123; c &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">update</span>(a,b,c);<br>    &#125;;<br>    md.<span class="hljs-property">digest</span>.<span class="hljs-title function_">overload</span>().<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">digest</span>();<br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== java.security.MessageDigest.digest()</span><br><span class="hljs-string">digestç»“æœ(string)      : <span class="hljs-subst">$&#123; bytesToString(result) &#125;</span></span><br><span class="hljs-string">digestç»“æœ(hex)         : <span class="hljs-subst">$&#123; bytesToHex(result) &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;;<br>    md.<span class="hljs-property">digest</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;[B&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">digest</span>(a);<br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== java.security.MessageDigest.digest(byte[])</span><br><span class="hljs-string">digestå‚æ•°(string)      : <span class="hljs-subst">$&#123; bytesToString(a) &#125;</span></span><br><span class="hljs-string">digestå‚æ•°(hex   )      : <span class="hljs-subst">$&#123; bytesToHex(a) &#125;</span></span><br><span class="hljs-string">---</span><br><span class="hljs-string">digestç»“æœ(string)      : <span class="hljs-subst">$&#123; bytesToString(result) &#125;</span></span><br><span class="hljs-string">digestç»“æœ(hex)         : <span class="hljs-subst">$&#123; bytesToHex(result) &#125;</span></span><br><span class="hljs-string">digestç»“æœ(base64)      : <span class="hljs-subst">$&#123; bytesToBase64(result) &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;;<br><br>    <span class="hljs-keyword">var</span> ivParameterSpec = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;javax.crypto.spec.IvParameterSpec&#x27;</span>);<br>    ivParameterSpec.<span class="hljs-property">$init</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;[B&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) &#123;<br>       <span class="hljs-comment">// showStacks();</span><br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== javax.crypto.spec.IvParameterSpec.$init(byte[])</span><br><span class="hljs-string">ivå‘é‡(string)          : <span class="hljs-subst">$&#123; bytesToString(a) &#125;</span></span><br><span class="hljs-string">ivå‘é‡(hex)             : <span class="hljs-subst">$&#123; bytesToHex(a) &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.$init(a);<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;;<br><br>    <span class="hljs-keyword">var</span> cipher = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;javax.crypto.Cipher&#x27;</span>);<br>    cipher.<span class="hljs-property">getInstance</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;java.lang.String&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getInstance</span>(a);<br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== javax.crypto.Cipher.getInstance(String)</span><br><span class="hljs-string">æ¨¡å¼å¡«å……                : <span class="hljs-subst">$&#123; a &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;;<br>    cipher.<span class="hljs-property">update</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;[B&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== javax.crypto.Cipher.update(byte[])\n&quot; +</span><br><span class="hljs-string">Cipher update(string)   : <span class="hljs-subst">$&#123; bytesToString(a) &#125;</span></span><br><span class="hljs-string">Cipher update(hex)      : <span class="hljs-subst">$&#123; bytesToHex(a) &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">update</span>(a);<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;;<br>    cipher.<span class="hljs-property">update</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;[B&#x27;</span>,<span class="hljs-string">&#x27;int&#x27;</span>,<span class="hljs-string">&#x27;int&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a,b,c</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== javax.crypto.Cipher.update(byte[], int, int)</span><br><span class="hljs-string">Cipher update(string)   : <span class="hljs-subst">$&#123; bytesToString(a) &#125;</span> | <span class="hljs-subst">$&#123; b &#125;</span> | <span class="hljs-subst">$&#123; c &#125;</span></span><br><span class="hljs-string">Cipher update(hex)      : <span class="hljs-subst">$&#123; bytesToHex(a) &#125;</span> | <span class="hljs-subst">$&#123; b &#125;</span> | <span class="hljs-subst">$&#123; c &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">update</span>(a,b,c);<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;;<br>    cipher.<span class="hljs-property">doFinal</span>.<span class="hljs-title function_">overload</span>().<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">doFinal</span>();<br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== javax.crypto.Cipher.doFinal()</span><br><span class="hljs-string">doFinalç»“æœ(string)     : <span class="hljs-subst">$&#123; bytesToString(result) &#125;</span></span><br><span class="hljs-string">doFinalç»“æœ(hex)        : <span class="hljs-subst">$&#123; bytesToHex(result) &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;;<br>    cipher.<span class="hljs-property">doFinal</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;[B&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">doFinal</span>(a);<br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== javax.crypto.Cipher.doFinal(byte[])</span><br><span class="hljs-string">doFinalå‚æ•°(string)     : <span class="hljs-subst">$&#123; bytesToString(a) &#125;</span></span><br><span class="hljs-string">doFinalå‚æ•°(hex)        : <span class="hljs-subst">$&#123; bytesToHex(a) &#125;</span></span><br><span class="hljs-string">---</span><br><span class="hljs-string">doFinalç»“æœ(string)     : <span class="hljs-subst">$&#123; bytesToString(result) &#125;</span></span><br><span class="hljs-string">doFinalç»“æœ(hex)        : <span class="hljs-subst">$&#123; bytesToHex(result) &#125;</span></span><br><span class="hljs-string">Stack:</span><br><span class="hljs-string"><span class="hljs-subst">$&#123; Java.use(<span class="hljs-string">&quot;android.util.Log&quot;</span>).getStackTraceString(Java.use(<span class="hljs-string">&quot;java.lang.Exception&quot;</span>).$new()) &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;;<br><br>    <span class="hljs-keyword">var</span> x509EncodedKeySpec = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;java.security.spec.X509EncodedKeySpec&#x27;</span>);<br>    x509EncodedKeySpec.<span class="hljs-property">$init</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;[B&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.$init(a);<br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== java.security.spec.X509EncodedKeySpec.$init(byte[])</span><br><span class="hljs-string">RSAå¯†é’¥(string)         : <span class="hljs-subst">$&#123; bytesToString(a) &#125;</span></span><br><span class="hljs-string">RSAå¯†é’¥(hex)            : <span class="hljs-subst">$&#123; bytesToHex(a) &#125;</span></span><br><span class="hljs-string">RSAå¯†é’¥(base64)         : <span class="hljs-subst">$&#123; bytesToBase64(a) &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;;<br><br>    <span class="hljs-keyword">var</span> rSAPublicKeySpec = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;java.security.spec.RSAPublicKeySpec&#x27;</span>);<br>    rSAPublicKeySpec.<span class="hljs-property">$init</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;java.math.BigInteger&#x27;</span>,<span class="hljs-string">&#x27;java.math.BigInteger&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a,b</span>) &#123;<br>        <span class="hljs-comment">//showStacks();</span><br>        <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.$init(a,b);<br>        <span class="hljs-title function_">send</span>(<br>            <span class="hljs-string">`========== java.security.spec.RSAPublicKeySpec.$init(BigInteger, BigInteger)</span><br><span class="hljs-string">RSAå¯†é’¥N                : <span class="hljs-subst">$&#123; a.toString(<span class="hljs-number">16</span>) &#125;</span></span><br><span class="hljs-string">RSAå¯†é’¥E                : <span class="hljs-subst">$&#123; b.toString(<span class="hljs-number">16</span>) &#125;</span></span><br><span class="hljs-string">`</span><br>            );<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;;<br>&#125;);<br></code></pre></td></tr></table></figure>        </div>      </div>    </div><p>ä¸Šé¢æ˜¯jsçš„ä»£ç ï¼Œæ–¹ä¾¿èµ·è§å¯ä»¥ç”¨pythonè¾…åŠ©hookè¿‡ç¨‹ï¼Œä¸ç”¨æ¯æ¬¡éƒ½åœ¨å‘½ä»¤è¡Œæ•²è¿›ç¨‹åï¼Œå¹¶ä¸”<code>send</code>å‡½æ•°å‘é€çš„æ¶ˆæ¯ä¹Ÿéœ€è¦pythonä»£ç æ¥æ¥æ”¶ï¼ˆè¿™ä¸ªæˆ‘æ²¡æœ‰æ·±ç©¶ï¼Œä¹‹å‰æ‰¾åˆ°çš„æ•™ç¨‹æ˜¯è¿™ä¹ˆåšçš„æˆ‘å°±è¿™ä¹ˆåšäº†ï¼‰</p><p>pythonä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: UTF-8 -*-</span><br><span class="hljs-keyword">import</span> frida, sys<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime<br> <br>jsCode = <span class="hljs-literal">None</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(sys.argv[<span class="hljs-number">1</span>], <span class="hljs-string">&quot;r&quot;</span>, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>) <span class="hljs-keyword">as</span> r:<br>    jsCode = r.read()  <span class="hljs-comment"># load js code</span><br>    <span class="hljs-comment"># print(jsCode)</span><br> <br>fw = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;log/&quot;</span> + datetime.now().strftime(<span class="hljs-string">&#x27;%Y-%m-%d_%H_%M_%S&#x27;</span>) + sys.argv[<span class="hljs-number">1</span>].replace(<span class="hljs-string">&quot;.js&quot;</span>, <span class="hljs-string">&quot;&quot;</span>).replace(<span class="hljs-string">&quot;.\\&quot;</span>, <span class="hljs-string">&quot;&quot;</span>) + <span class="hljs-string">&quot;.log&quot;</span>,<span class="hljs-string">&#x27;w+&#x27;</span>,encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>)  <span class="hljs-comment"># file object to write log</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">message</span>(<span class="hljs-params">message, data</span>):<br>    <span class="hljs-keyword">if</span> message[<span class="hljs-string">&quot;type&quot;</span>] == <span class="hljs-string">&#x27;send&#x27;</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">u&quot;[*] &#123;0&#125;&quot;</span>.<span class="hljs-built_in">format</span>(message[<span class="hljs-string">&#x27;payload&#x27;</span>]))<br>        fw.write(<span class="hljs-string">u&quot;[*] &#123;0&#125;\n&quot;</span>.<span class="hljs-built_in">format</span>(message[<span class="hljs-string">&#x27;payload&#x27;</span>]))<br>        fw.flush()<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(message)<br><br><br>device = frida.get_usb_device()<br><span class="hljs-comment"># print(process)</span><br>pid = <span class="hljs-literal">None</span><br><span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> device.enumerate_applications():<br>    <span class="hljs-keyword">if</span> a.identifier == <span class="hljs-string">&quot;com.huawei.smarthome&quot;</span>:<br>        pid = a.pid  <span class="hljs-comment"># find the process by its&#x27; package name and get its&#x27; pid</span><br>        <span class="hljs-keyword">break</span><br>process = device.attach(pid)<br>script= process.create_script(jsCode)<br>script.on(<span class="hljs-string">&quot;message&quot;</span>, message)<br>script.load()<br>sys.stdin.read()<br></code></pre></td></tr></table></figure><p>hookä¹‹å‰éœ€è¦å…ˆadb<sup id="fnref:7" class="footnote-ref"><a href="#fn:7" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Android è°ƒè¯•æ¡¥ (adb)  | Android Studio  | Android Developers](https://developer.android.com/tools/adb?hl=zh-cn)">[7]</span></a></sup><sup id="fnref:8" class="footnote-ref"><a href="#fn:8" rel="footnote"><span class="hint--top hint--rounded" aria-label="[windows11å®‰è£…adbæ­¥éª¤ - æµ‹è¯•0 - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/momomolin/p/17347120.html)">[8]</span></a></sup>è¿›å…¥åˆ°è®¾å¤‡çš„shellé‡Œç„¶åå¯åŠ¨frida-server</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cmd">adb shell  # å…ˆè¿›å…¥è®¾å¤‡çš„shell<br><span class="hljs-function">oriole:/ $ <span class="hljs-title">su</span>  # åˆ‡æ¢åˆ°<span class="hljs-title">root</span></span><br><span class="hljs-function"><span class="hljs-title">oriole</span>:/ # /<span class="hljs-title">data</span>/<span class="hljs-title">local</span>/<span class="hljs-title">tmp</span>/<span class="hljs-title">frida</span>-<span class="hljs-title">server</span>-16.1.10-<span class="hljs-title">android</span>-<span class="hljs-title">arm64</span> &amp;  # åŠ ä¸Š&amp;ï¼Œä»¥åå°æ–¹å¼è¿è¡Œ<span class="hljs-title">frida</span>-<span class="hljs-title">server</span></span><br></code></pre></td></tr></table></figure><p>æ³¨æ„è¦æœ‰rootæƒé™ï¼Œå¹¶ä¸”frida-serverå¿…é¡»æ˜¯å¯¹åº”çš„æ¶æ„ï¼Œå’Œpcç«¯çš„fridaç‰ˆæœ¬æ˜¯å¦å¿…é¡»ä¿æŒä¸€è‡´æˆ‘æ²¡æœ‰ç¡®è®¤ï¼Œä½†æ˜¯ï¼Œif you can, why notã€‚</p><p>ç„¶åæ‰‹åŠ¨å¯åŠ¨åº”ç”¨ï¼Œå†å¯åŠ¨pythonè„šæœ¬æ–‡ä»¶å¼€å§‹hookå°±å¯ä»¥äº†</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cmd">conda activate hook<br>python .\hook.py .\javaCipherAIO.js<br></code></pre></td></tr></table></figure><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://github.com/topjohnwu/Magisk">topjohnwu&#x2F;Magisk: The Magic Mask for Android (github.com)</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://github.com/frida/frida">frida&#x2F;frida: Clone this repo to build Frida (github.com)</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://www.cnblogs.com/Only-xiaoxiao/p/17294561.html">Frida åŸç†åŠç®€å•ä½¿ç”¨ - Only-xiaoxiao - åšå®¢å›­ (cnblogs.com)</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://www.cnblogs.com/wutou/p/17884865.html">Frida server å’Œ python clientä¸‹è½½ ç‰ˆæœ¬å¯¹åº”å…³ç³» - æ‚Ÿé€ - åšå®¢å›­ (cnblogs.com)</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:5" class="footnote-text"><span><a href="https://github.com/skylot/jadx">skylot&#x2F;jadx: Dex to Java decompiler (github.com)</a><a href="#fnref:5" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:6" class="footnote-text"><span><a href="https://www.cnblogs.com/luoyesiqiu/p/10718997.html">fridaçš„ç”¨æ³•â€“Hook Javaä»£ç ç¯‡ - luoyesiqiu - åšå®¢å›­ (cnblogs.com)</a><a href="#fnref:6" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:7" class="footnote-text"><span><a href="https://developer.android.com/tools/adb?hl=zh-cn">Android è°ƒè¯•æ¡¥ (adb)  | Android Studio  | Android Developers</a><a href="#fnref:7" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:8" class="footnote-text"><span><a href="https://www.cnblogs.com/momomolin/p/17347120.html">windows11å®‰è£…adbæ­¥éª¤ - æµ‹è¯•0 - åšå®¢å›­ (cnblogs.com)</a><a href="#fnref:8" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>android</tag>
      
      <tag>reverse</tag>
      
      <tag>hook</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>dockerå®¹å™¨ä¸æ˜¾ç¤ºä¸­æ–‡</title>
    <link href="/2024/03/14/docker%E5%AE%B9%E5%99%A8%E4%B8%8D%E6%98%BE%E7%A4%BA%E4%B8%AD%E6%96%87/"/>
    <url>/2024/03/14/docker%E5%AE%B9%E5%99%A8%E4%B8%8D%E6%98%BE%E7%A4%BA%E4%B8%AD%E6%96%87/</url>
    
    <content type="html"><![CDATA[<p>æ‰“ç®—æ¬è¿è‡ªå·±çš„ç¬”è®°åˆ°ç»„é‡Œçš„æœåŠ¡å™¨ä¸Šï¼Œåˆå› ä¸ºæ˜¯æœåŠ¡å™¨ï¼Œå¯¹ç¯å¢ƒé™åˆ¶æ¯”è¾ƒå¤šï¼Œä¸ä¼šéšä¾¿å®‰è£…ä¸€äº›åŒ…å’Œlibåº“ï¼Œæ‰€ä»¥å¤§å®¶åŸºæœ¬ä¸Šéƒ½æ˜¯dockerå¼€è‡ªå·±çš„å®¹å™¨ç”¨ã€‚</p><p>ç„¶åï¼š</p><p><img src="https://s2.loli.net/2024/03/14/uPHk8FEq4SVAYpo.png" alt="image-20240314104511933"></p><p>ç»ˆç«¯æ— æ³•æ˜¾ç¤ºä¸­æ–‡ï¼Œå®é™…ä¸Š<code>zsh</code>çš„å‘½ä»¤è¡¥å…¨è¿˜æ˜¯èƒ½æ˜¾ç¤ºä¸­æ–‡çš„ï¼Œä½†æ˜¯ç»ˆç«¯å°±æ˜¯ä¸è¡Œ</p><p><img src="https://s2.loli.net/2024/03/14/JFkHUG1vmegfPhq.png" alt="image-20240314104637839"></p><p>æŒ‰ç…§æ‰¾åˆ°çš„æ•™ç¨‹ï¼Œ<code>locale</code>å’Œ<code>locale -a</code>æŸ¥çœ‹æœ¬åœ°æ­£åœ¨ä½¿ç”¨ä»¥åŠæ”¯æŒçš„å­—ç¬¦é›†ï¼š</p><p><img src="https://s2.loli.net/2024/03/14/iHQOxWjlLrwX5hJ.png" alt="image-20240314104823601"></p><p>è¿™é‡Œçœ‹åˆ°<code>LC_ALL=C</code>ï¼ŒæŒ‰ç…§æŸä¸ªæ•™ç¨‹é‡Œçš„è¯´æ³•ï¼Œ<code>C</code>å°±æ˜¯<code>POSIX</code>ï¼Œæ˜¯ä¸æ”¯æŒä¸­æ–‡æ˜¾ç¤ºçš„ï¼Œä¿®æ”¹ä¸º<code>zh_CN.utf8</code>æˆ–è€…<code>C.utf8</code>å°±å¯ä»¥äº†ï¼Œå®æµ‹éƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œä¼¼ä¹æ˜¯æ’åºä¸Šæœ‰ä¸€äº›ä¸åŒ</p><p><img src="https://s2.loli.net/2024/03/14/pf57C2rPzFxSuB6.png" alt="image-20240314105152076"></p><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>å…³äºå„ç§<code>LC_*</code>å˜é‡ä»¥åŠ<code>LANG</code>å˜é‡ï¼Œçœ‹åˆ°çš„è¯´æ³•æ˜¯<code>LC_ALL</code>æ˜¯æŒ‡å®šæ‰€æœ‰çš„å­—ç¬¦é›†è®¾ç½®<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[LOCALE\]å­—ç¬¦é›†è®¾ç½® - Linux Guide (zj-linux-guide.readthedocs.io)](https://zj-linux-guide.readthedocs.io/zh-cn/latest/tool-install-configure/[LOCALE]å­—ç¬¦é›†è®¾ç½®/)">[2]</span></a></sup>ï¼Œçœ‹åˆ°å¾ˆå¤šæ•™ç¨‹ä¸Šè¯´è®©ä¿®æ”¹<code>LANG</code>å˜é‡ï¼Œå®é™…ä¸Šè¯•äº†ä¸€ä¸‹æ˜¯æ²¡ç”¨çš„</p><p>æ¯”å¦‚<code>LANG=C.utf8</code>ä¸”<code>LC_ALL=C</code>ï¼Œå¯ä»¥çœ‹åˆ°è¿˜æ˜¯æ˜¾ç¤ºä¸äº†ä¸­æ–‡ï¼š</p><p><img src="https://s2.loli.net/2024/03/14/KlYbREoxAsJItif.png" alt="image-20240314105437274"></p><p>åŒ…æ‹¬æŠŠ<code>LANG</code>è®¾ç½®ä¸º<code>zh_CN.utf8</code>ä¹Ÿæ²¡æœ‰ç”¨ï¼š</p><p><img src="https://s2.loli.net/2024/03/14/xhdyP8tuzrWgfXA.png" alt="image-20240314105558850"></p><p>æ€»çš„æ¥è¯´å°±æ˜¯ï¼Œåªè¦<code>LC_ALL</code>æ˜¯ä¸æ”¯æŒä¸­æ–‡å­—ç¬¦çš„<code>C</code>ï¼Œä¿®æ”¹<code>LANG</code>å°±æ²¡æœ‰ç”¨ï¼Œä¸»è¦æ˜¯<code>LC_ALL</code>å˜é‡çš„è®¾ç½®ï¼Œå› ä¸ºè®¾ç½®äº†<code>LC_ALL</code>å˜é‡ï¼Œå…¶ä»–çš„<code>LC_*</code>å˜é‡ä¹Ÿéƒ½ä¿®æ”¹äº†ï¼Œä½†æ˜¯åªè®¾ç½®<code>LANG</code>å°±ä¼šåªä¿®æ”¹<code>LANG</code>ï¼Œå¦‚å›¾ä¿®æ”¹<code>LC_ALL</code>ï¼š</p><p><img src="https://s2.loli.net/2024/03/14/zPKLpY5FTif9q2S.png" alt="image-20240314105921600"></p><p>andï¼Œå¾ˆå¤šæ•™ç¨‹é‡Œæœ‰çš„åœ°æ–¹å†™çš„æ˜¯<code>zh_CN.UTF-8</code>ï¼Œæœ‰çš„æ˜¯<code>zh_CN.utf-8</code>ï¼Œæµ‹è¯•äº†ä¸€ä¸‹ï¼Œè®¾ç½®<code>LC_ALL=zh_CN.UTF-8</code>ä¹Ÿæ˜¯æœ‰æ•ˆçš„ï¼Œä½†æˆ‘è§‰å¾—è¿˜æ˜¯å’Œ<code>locale -a</code>çš„æŸä¸€è¡Œè¾“å‡ºï¼ˆfor example <code>zh_CN.utf8</code>ï¼‰é‡Œä¿æŒä¸€è‡´å¯èƒ½ä¼šå¥½ä¸€ç‚¹ï¼Œè¿™ä¸€ç‚¹å¯èƒ½éœ€è¦å»ç¿»ä¸€ç¿»æ–‡æ¡£å»ç¡®è®¤ä¸€ä¸‹æ€ä¹ˆè®¾ç½®æœ€è§„èŒƒï¼Œä½†æ˜¯æˆ‘æ²¡æœ‰å»ç¿»</p><p>å¦‚æœ<code>locale -a</code>è¾“å‡ºé‡Œæ²¡æœ‰è‡ªå·±éœ€è¦çš„å­—ç¬¦é›†ï¼Œå¯ä»¥é€šè¿‡<code>dpkg-reconfigure locales</code>å®‰è£…ï¼Œå¦‚æœæ˜¾ç¤ºæ²¡æœ‰<code>locales</code>ï¼Œéœ€è¦å®‰è£…<code>locales</code><sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[æ˜çœ¸å¦‚åˆ (zywvvd.com)](https://www.zywvvd.com/notes/system/linux/ubuntu-language-zh-cn/ubuntu-language-zh-cn/)">[1]</span></a></sup></p><h3 id="ååè®°"><a href="#ååè®°" class="headerlink" title="ååè®°"></a>ååè®°</h3><p>æ— è¯­ï¼Œå¿˜è®°æ˜¯ä»€ä¹ˆæ—¶å€™çš„äº‹ï¼Œ<code>.zshrc</code>é‡Œæˆ‘è‡ªå·±æ·»åŠ äº†å­—ç¬¦é›†çš„è®¾ç½®ï¼š</p><p><img src="https://s2.loli.net/2024/03/14/lBQZNAYcMexWpzU.png" alt="image-20240314111948828"></p><p>æˆ‘å°±è¯´ä¸ºä»€ä¹ˆè®¾ç½®äº†<code>/etc/environment</code>æ²¡æœ‰ç”¨ï¼Œæ€»ä¹‹ï¼Œä¸ç®¡æ˜¯<code>/etc/environment</code>è¿˜æ˜¯<code>.zshrc</code>ï¼Œèƒ½æŠŠ<code>LC_ALL</code>å˜é‡è®¾ç½®æˆ<code>zh_CN.utf8</code>è€Œä¸æ˜¯<code>C</code>å°±è¡Œ</p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://www.zywvvd.com/notes/system/linux/ubuntu-language-zh-cn/ubuntu-language-zh-cn/">æ˜çœ¸å¦‚åˆ (zywvvd.com)</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://zj-linux-guide.readthedocs.io/zh-cn/latest/tool-install-configure/[LOCALE]%E5%AD%97%E7%AC%A6%E9%9B%86%E8%AE%BE%E7%BD%AE/">LOCALE]å­—ç¬¦é›†è®¾ç½® - Linux Guide (zj-linux-guide.readthedocs.io)</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span>ï¼ˆæˆ‘è®¨åŒCSDNï¼Œä½†æ˜¯è¿˜æ˜¯è¦æ”¾ä¸ªå¼•ç”¨åœ¨è¿™é‡Œï¼‰<a href="https://blog.csdn.net/weixin_44455388/article/details/109092222">docker å®¹å™¨ä¸­ä¸æ”¯æŒä¸­æ–‡çš„è§£å†³æ–¹æ³•_docker locale-CSDNåšå®¢</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>linux</tag>
      
      <tag>docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ²å›­æ˜¥-é•¿æ²™</title>
    <link href="/2024/03/07/%E6%B2%81%E5%9B%AD%E6%98%A5-%E9%95%BF%E6%B2%99/"/>
    <url>/2024/03/07/%E6%B2%81%E5%9B%AD%E6%98%A5-%E9%95%BF%E6%B2%99/</url>
    
    <content type="html"><![CDATA[<p>ï¼ˆ1925ï¼‰æ¯›æ³½ä¸œ</p><hr><p>ç‹¬ç«‹å¯’ç§‹ï¼Œæ¹˜æ±ŸåŒ—å»ï¼Œæ©˜å­æ´²å¤´ã€‚çœ‹ä¸‡å±±çº¢éï¼Œå±‚æ—å°½æŸ“ï¼›æ¼«æ±Ÿç¢§é€ï¼Œç™¾èˆ¸äº‰æµã€‚é¹°å‡»é•¿ç©ºï¼Œé±¼ç¿”æµ…åº•ï¼Œä¸‡ç±»éœœå¤©ç«è‡ªç”±ã€‚æ€…å¯¥å»“ï¼Œé—®è‹èŒ«å¤§åœ°ï¼Œè°ä¸»æ²‰æµ®ï¼Ÿ</p><p>æºæ¥ç™¾ä¾£æ›¾æ¸¸ï¼Œå¿†å¾€æ˜”ã€å³¥åµ˜å²æœˆç¨ ã€‚æ°åŒå­¦å°‘å¹´ï¼Œé£åæ­£èŒ‚ï¼›ä¹¦ç”Ÿæ„æ°”ï¼ŒæŒ¥æ–¥æ–¹é’ã€‚æŒ‡ç‚¹æ±Ÿå±±ï¼Œæ¿€æ‰¬æ–‡å­—ï¼Œç²ªåœŸå½“å¹´ä¸‡æˆ·ä¾¯ã€‚æ›¾è®°å¦ï¼Œåˆ°ä¸­æµå‡»æ°´ï¼Œæµªéé£èˆŸï¼Ÿ</p><hr><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="http://www.ziyexing.com/maozedong/shici/mzd_shici_02.htm">http://www.ziyexing.com/maozedong/shici/mzd_shici_02.htm</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>éšç¬”</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å…«å…­å­-å€šå±äº­</title>
    <link href="/2024/03/07/%E5%85%AB%E5%85%AD%E5%AD%90-%E5%80%9A%E5%8D%B1%E4%BA%AD/"/>
    <url>/2024/03/07/%E5%85%AB%E5%85%AD%E5%AD%90-%E5%80%9A%E5%8D%B1%E4%BA%AD/</url>
    
    <content type="html"><![CDATA[<p>ï¼ˆå®‹ï¼‰ç§¦è§‚</p><hr><p>å€šå±äº­ï¼Œæ¨å¦‚èŠ³è‰ï¼Œ</p><p>è‹è‹åˆ¬å°½è¿˜ç”Ÿã€‚</p><p>å¿µæŸ³å¤–é’éª¢åˆ«åï¼Œæ°´è¾¹çº¢è¢‚åˆ†æ—¶ï¼Œ</p><p>æ€†ç„¶æš—æƒŠã€‚</p><p>æ— ç«¯å¤©ä¸å¨‰å©·ï¼Œå¤œæœˆä¸€å¸˜å¹½æ¢¦ï¼Œ</p><p>æ˜¥é£åé‡ŒæŸ”æƒ…ã€‚</p><p>æ€å¥ˆå‘ã€æ¬¢å¨±æ¸éšæµæ°´ï¼Œ</p><p>ç´ å¼¦å£°æ–­ï¼Œç¿ ç»¡é¦™å‡ï¼Œ</p><p>é‚£å ªç‰‡ç‰‡é£èŠ±å¼„æ™šï¼Œè’™è’™æ®‹é›¨ç¬¼æ™´ã€‚</p><p>æ­£é”€å‡ï¼Œé»„é¹‚åˆå•¼æ•°å£°ã€‚</p><hr><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="http://www.xinhuanet.com/politics/2017-03/02/c_129499433.htm">http://www.xinhuanet.com/politics/2017-03/02/c_129499433.htm</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>éšç¬”</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å”å¤šä»¤</title>
    <link href="/2024/03/07/%E5%94%90%E5%A4%9A%E4%BB%A4/"/>
    <url>/2024/03/07/%E5%94%90%E5%A4%9A%E4%BB%A4/</url>
    
    <content type="html"><![CDATA[<p>åˆ˜è¿‡</p><hr><p>å®‰è¿œæ¥¼å°é›†ï¼Œä¾‘è§æ­Œæ¿ä¹‹å§¬é»„å…¶å§“è€…ï¼Œä¹è¯äºé¾™æ´²é“äººï¼Œä¸ºèµ‹æ­¤ã€Šå”å¤šä»¤ã€‹ã€‚åŒæŸ³é˜œä¹‹ã€åˆ˜å»éã€çŸ³æ°‘ç»ã€å‘¨å˜‰ä»²ã€é™ˆå­Ÿå‚ã€å­Ÿå®¹ã€‚æ—¶å…«æœˆäº”æ—¥ä¹Ÿã€‚</p><p>èŠ¦å¶æ»¡æ±€æ´²ï¼Œå¯’æ²™å¸¦æµ…æµã€‚äºŒåå¹´é‡è¿‡å—æ¥¼ã€‚æŸ³ä¸‹ç³»èˆ¹çŠ¹æœªç¨³ï¼Œèƒ½å‡ æ—¥ï¼Œåˆä¸­ç§‹ã€‚</p><p>é»„é¹¤æ–­çŸ¶å¤´ï¼Œæ•…äººæ›¾åˆ°å¦ï¼Ÿæ—§æ±Ÿå±±æµ‘æ˜¯æ–°æ„ã€‚æ¬²ä¹°æ¡‚èŠ±åŒè½½é…’ï¼Œç»ˆä¸ä¼¼ï¼Œå°‘å¹´æ¸¸</p><hr><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://baike.baidu.com/item/%E5%94%90%E5%A4%9A%E4%BB%A4%C2%B7%E8%8A%A6%E5%8F%B6%E6%BB%A1%E6%B1%80%E6%B4%B2/8464037">å”å¤šä»¤Â·èŠ¦å¶æ»¡æ±€æ´²_ç™¾åº¦ç™¾ç§‘ (baidu.com)</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>éšç¬”</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
